

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Analysis of the Earth’s Radiation Budget using the CERES product &#8212; C3S Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ecv-notebooks/erb-ceres-climatology';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calculation of global climatology and relative anomalies of Surface Radiation Budget from EUMETSAT’s CM SAF CLARA-A3 dataset" href="srb-climatology-and-anomaly.html" />
    <link rel="prev" title="Calculation of global climatology of Earth Radiation Budget from EUMETSAT’s CM SAF CLARA-A3 dataset" href="erb-clara-climatology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Climate Data Store (CDS)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://cds.climate.copernicus.eu/user-guide">CDS user guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-temp-record.html">Climate Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-heatwave.html">Heatwave Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l1"><a class="reference internal" href="srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-column-water-vapour-combi.html">Total Column Water Vapour</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-ozone-columns.html">Total Column Ozone</a></li>
<li class="toctree-l1"><a class="reference internal" href="greenhouse-gases-level2-products.html">Greenhouse Gas Level 2 Products</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../projections-cmip6.html">Climate Projections (CMIP6)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projections-cordex.html">Climate Projections (CORDEX)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Indices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ci-windchill.html">Windchill Index Calculation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Bias Correction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ibicus.readthedocs.io/en/latest/getting_started/overview.html">Python library (ibicus) and tutorials on bias correction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials using EFFIS and GloFAS data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../visualising-fwi-for-esotc.html">Visualising Fire Weather Index (FWI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glofas-bangladesh-floods.html">Observing floods with GloFAS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Atmosphere Monitoring Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-cams/">Tutorials from the Copernicus Atmosphere Monitoring Service (CAMS)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?urlpath=tree/ecv-notebooks/erb-ceres-climatology.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s/issues/new?title=Issue%20on%20page%20%2Fecv-notebooks/erb-ceres-climatology.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ecv-notebooks/erb-ceres-climatology.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysis of the Earth’s Radiation Budget using the CERES product</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-description">Dataset description</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites-and-data-acquisition">Prerequisites and data acquisition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data-using-cds-api">Download data using CDS API</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-cds-api-credentials">Set up CDS API credentials</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-data">Search for data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-data">Inspect data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-earth-s-radiation-budget">Climatology of the Earth’s Radiation Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-incoming-solar-radiation">Climatology of the top-of-atmosphere incoming solar radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-tis">Time averaged global climatological distribution of TIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-tis">Time averaged seasonal climatological distribution of TIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-monthly-mean-climatology-of-tis">Zonally averaged monthly mean climatology of TIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-reflected-solar-flux">Climatology of the top-of-atmosphere reflected solar flux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-toa-rsf">Time averaged global climatological distribution of TOA RSF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-toa-rsf">Time averaged seasonal climatological distribution of TOA RSF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-montly-mean-climatology-of-toa-rsf">Zonally averaged montly mean climatology of TOA RSF</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-outgoing-longwave-radiation">Climatology of the top-of-atmosphere outgoing longwave radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-toa-olr">Time averaged global climatological distribution of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-toa-olr">Time averaged seasonal climatological distribution of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inter-annual-variability-of-toa-olr">Inter-annual variability of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-montly-mean-climatology-of-toa-olr">Zonally averaged montly mean climatology of TOA OLR</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-net-earth-s-radiation-budget">Climatology of the top-of-atmosphere net Earth’s radiation budget</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-toa-net-erb">Time averaged global climatological distribution of TOA net ERB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-toa-erb">Time averaged seasonal climatological distribution of TOA ERB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-montly-mean-climatology-of-toa-net-erb">Zonally averaged montly mean climatology of TOA net ERB</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-earth-s-radiation-budget">Time series and trend analysis of the Earth’s Radiation Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-aggregation">Spatial aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-incoming-solar-radiation">Time series and trend analysis of the top-of-atmosphere incoming solar radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-tis">Global time series of TIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-tis">Trend analysis and seasonal cycle of TIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-reflected-solar-flux">Time series and trend analysis of the top-of-atmosphere reflected solar flux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-toa-rsf">Global time series of TOA RSF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-toa-rsf">Trend analysis and seasonal cycle of TOA RSF</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-outgoing-longwave-radiation">Time series and trend analysis of the top-of-atmosphere outgoing longwave radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-toa-olr">Global time series of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-toa-olr">Trend analysis and seasonal cycle of TOA OLR</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-net-earth-s-radiation-budget">Time series and trend analysis of the top-of-atmosphere net Earth’s radiation budget</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-toa-net-erb">Global time series of TOA net ERB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-toa-net-erb">Trend analysis and seasonal cycle of TOA net ERB</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">Appendix</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="analysis-of-the-earth-s-radiation-budget-using-the-ceres-product">
<h1>Analysis of the Earth’s Radiation Budget using the CERES product<a class="headerlink" href="#analysis-of-the-earth-s-radiation-budget-using-the-ceres-product" title="Permalink to this heading">#</a></h1>
<p>This notebook-tutorial provides an introduction to the use of the
Cloud and Earth’s Radiant Energy System (CERES) Energy Balanced and Filled (EBAF) Earth’s Radiation Budget (<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-earth-radiation-budget?tab=overview">ERB</a>) data record
for climate studies.</p>
<p>The Earth’s Radiation Budget (ERB) Essential Climate Variable (ECV) and the CERES EBAF product are described in the introduction. Then, a first use case provides an analysis of the time averaged global and seasonal climatological distributions of the Earth’s radiation budget as well as the monthly mean climatology. The second use case presents the time series and trend analysis of ERB. Step-by-step instructions are provided on data preparation, the use cases are extensively documented and each line of code is explained.</p>
<p>The three figures below show some results from the use cases and illustrate the successful run of the code.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The Earth’s Radiation Budget (ERB) represents the overall balance between incoming and outgoing radiant energy at the Earth’s top-of-the-atmosphere (TOA). This Essential Climate Variable (ECV) is the primary forcing of the climate system and is therefore a fundamental quantity to be monitored to understand the Earth’s climate and its variability. The ERB comprises the quantification of the incoming radiation from the sun and the outgoing reflected shortwave and emitted longwave radiations. The Earth is in a state of dynamic radiative balance; energy arriving from the sun is balanced by outgoing radiation from the top-of-the-atmosphere. Changes in the Earth’s surface and atmosphere (including cloud amount and properties, and concentrations of greenhouse gases) will alter the radiative forcing of the Earth system and change the balance and distribution of outgoing thermal radiation and reflected solar radiation.</p>
<p>In the Copernicus Climate Data Store (CDS), a dataset of ERB has been “brokered” from the Clouds and Earth’s Radiant Energy System (CERES) Energy Balanced And Filled (EBAF) edition 4.2. CERES EBAF provides a state-of-the-art Climate Data Record (CDR) of monthly mean top of atmosphere (TOA) radiative fluxes. This widely used CDR is produced by the CERES team at the NASA/Langley center from the CERES instruments onboard the Terra and Aqua satellites. The CERES EBAF data is suitable for analysis of variability at the intra-seasonal, inter-annual, and longer time scales.</p>
<p>In this Jupyter notebook tutorial, we present examples, based on monthly mean ERB products, to illustrate the philosophy on the usage, visualisation, and analysis of the ERB dataset. Produced images and processed data can be saved to personal devices for later use.</p>
<section id="dataset-description">
<h3>Dataset description<a class="headerlink" href="#dataset-description" title="Permalink to this heading">#</a></h3>
<p>You will find further information about the dataset as well as the data in the Climate Data Store catalogue entry Earth’s Radiation Budget, sections “Overview”, “Download data” and “Documentation”:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-earth-radiation-budget?tab=overview">Earth’s radiation budget from 1979 to present derived from satellite observations</a></p></li>
</ul>
</section>
</section>
<section id="prerequisites-and-data-acquisition">
<h2>Prerequisites and data acquisition<a class="headerlink" href="#prerequisites-and-data-acquisition" title="Permalink to this heading">#</a></h2>
<p>This tutorial is in the form of a Jupyter notebook. It can be run on a cloud environment, or on your own computer. You will not need to install any software for the training as there are a number of free cloud-based services to create, edit, run and export Jupyter notebooks such as this. Here are some suggestions (simply click on one of the links below to run the notebook):</p>
<style>
td, th {
   border: 1px solid white;
   border-collapse: collapse;
}
</style>
<table align="left">
  <tr>
    <th>Run the tutorial via free cloud platforms: </th>
    <th><a href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-projects/copernicus-training-c3s/blob/main/ecv-notebooks/erb-ceres-climatology.ipynb">
        <img src = "https://kaggle.com/static/images/open-in-kaggle.svg" alt = "Kaggle"></th>
    <th><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?labpath=ecv-notebooks/erb-ceres-climatology.ipynb">
        <img src = "https://mybinder.org/badge.svg" alt = "Binder"></th>
    <th><a href="https://colab.research.google.com/github/ecmwf-projects/copernicus-training-c3s/blob/main/ecv-notebooks/erb-ceres-climatology.ipynb">
        <img src = "https://colab.research.google.com/assets/colab-badge.svg" alt = "Colab"></th>
  </tr>
</table>
<p><br><br></p>
<p>We are using <code class="docutils literal notranslate"><span class="pre">cdsapi</span></code> to download the data. This package is not yet included by default on most cloud platforms. You can use <code class="docutils literal notranslate"><span class="pre">pip</span></code> to install it. We use an exclamation mark to pass the command to the shell (not to the Python interpreter).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install -q cdsapi
</pre></div>
</div>
</div>
</div>
<section id="import-libraries">
<h3>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this heading">#</a></h3>
<p>The data have been stored in files written in NetCDF format. To best handle these, we will import the library <a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray</a> which is specifically designed for manipulating multidimensional arrays in the field of geosciences. The libraries <a class="reference external" href="https://matplotlib.org/stable/index.html">Matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">Cartopy</a> will also be imported for plotting and visualising the analysed data. We will also import the libraries <a class="reference external" href="https://docs.python.org/3/library/zipfile.html">zipfile</a> to work with zip-archives, <a class="reference external" href="https://docs.python.org/3/library/os.html">OS</a> to use OS-functions and pattern expansion, and <a class="reference external" href="https://urllib3.readthedocs.io/en/stable/">urllib3</a> for disabling warnings for data download via CDS API.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Libraries to work with zip-archives, OS functions and pattern expansion</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Disable warnings for data download via API</span>
<span class="kn">import</span> <span class="nn">urllib3</span>
<span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="c1"># CDS API library</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="c1"># Libraries for working with multidimensional arrays</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># Import a sublibrary method for the seasonal decomposition of the time series</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="c1"># Libraries for plotting and visualising the data</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-data-using-cds-api">
<h3>Download data using CDS API<a class="headerlink" href="#download-data-using-cds-api" title="Permalink to this heading">#</a></h3>
<p>This section is provides all necessary settings and input data to successfully run the use cases, and produce the figures.</p>
<section id="set-up-cds-api-credentials">
<h4>Set up CDS API credentials<a class="headerlink" href="#set-up-cds-api-credentials" title="Permalink to this heading">#</a></h4>
<p>We will request data from the <a class="reference external" href="https://cds.climate.copernicus.eu/">Climate Data Store (CDS)</a>. In case you don’t have an account yet, please click on “Login/register” at the right top and select “Create new account”. With the process finished you are able to login to the CDS and can search for your preferred data.</p>
<p>We will request data from the CDS programmatically with the help of the CDS API.
First, we need to manually set the CDS API credentials.
To do so, we need to define two variables: URL and KEY.
To obtain these, first login to the CDS, then visit <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a> and copy the string of characters listed after “key:”. Replace the <code class="docutils literal notranslate"><span class="pre">#########</span></code> below with this string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://cds.climate.copernicus.eu/api&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;############&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Here we specify a data directory in which we will download our data and all output files that we will generate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data directory for downloading the data</span>
<span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
<span class="c1"># Filename for the zip file downloaded from the CDS</span>
<span class="n">download_zip_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="s1">&#39;ceres-erb-monthly.zip&#39;</span><span class="p">)</span>
<span class="c1"># Filename for the netCDF file which contain the merged contents of the monthly files.</span>
<span class="n">merged_netcdf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="s1">&#39;ceres-erb-monthly.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="search-for-data">
<h3>Search for data<a class="headerlink" href="#search-for-data" title="Permalink to this heading">#</a></h3>
<p>To search for data, visit the <a class="reference external" href="https://cds.climate.copernicus.eu">CDS website</a>.
Here you can search for CERES EBAF data using the search bar. The data we need for this use case is the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-earth-radiation-budget?tab=overview">Earth’s radiation budget from 1979 to present derived from satellite observations</a>.
This catalogue entry provides data from various sources: NASA CERES EBAF, NOAA/NCEI HIRS OLR, ESA Cloud-CCI, EUMETSAT’s CM SAF CLARA-A3, C3S CCI and C3S RMIB TSI.</p>
<p>After selecting the correct catalogue entry, we will specify the product family, the origin, the sensor on satellite (for CCI product family only), the type of variable, the type of climate data record, the time aggregation, the temporal and geographical coverage we are interested in.
These can all be selected in the <strong>“Download data”</strong> tab. In this tab a form appears in which we will select the following parameters to download:</p>
<ul class="simple">
<li><p>Product family: <code class="docutils literal notranslate"><span class="pre">CERES</span> <span class="pre">EBAF</span> <span class="pre">(Clouds</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">Earth's</span> <span class="pre">Radiant</span> <span class="pre">Energy</span> <span class="pre">System</span> <span class="pre">(CERES)</span> <span class="pre">Energy</span> <span class="pre">Balanced</span> <span class="pre">And</span> <span class="pre">Filled</span> <span class="pre">(EBAF))</span></code></p></li>
<li><p>Origin: <code class="docutils literal notranslate"><span class="pre">NASA</span> <span class="pre">(National</span> <span class="pre">Aeronautics</span> <span class="pre">and</span> <span class="pre">Space</span> <span class="pre">Administration)</span></code></p></li>
<li><p>Variable: <code class="docutils literal notranslate"><span class="pre">all</span></code> (use <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">all</span></code> button)</p></li>
<li><p>Climate data record type: <code class="docutils literal notranslate"><span class="pre">Thematic</span> <span class="pre">Climate</span> <span class="pre">Data</span> <span class="pre">Record</span> <span class="pre">(TCDR)</span></code></p></li>
<li><p>Time aggregation: <code class="docutils literal notranslate"><span class="pre">Monthly</span> <span class="pre">mean</span></code></p></li>
<li><p>Year: <code class="docutils literal notranslate"><span class="pre">all</span></code> (use <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">all</span></code> button)</p></li>
<li><p>Month: <code class="docutils literal notranslate"><span class="pre">all</span></code> (use <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">all</span></code> button)</p></li>
<li><p>Geographical area: <code class="docutils literal notranslate"><span class="pre">Whole</span> <span class="pre">available</span> <span class="pre">region</span></code></p></li>
</ul>
<p>If you have not already done so, you will need to accept the <strong>“terms &amp; conditions”</strong> of the data before you can download it.</p>
<p>At the end of the download form, select <strong>“Show API request”</strong>. This will reveal a block of code, which you can simply copy and paste into a cell of your Jupyter Notebook (see cell below) …</p>
</section>
<section id="download-data">
<h3>Download data<a class="headerlink" href="#download-data" title="Permalink to this heading">#</a></h3>
<p>… Having copied the API request into the cell below, running this will retrieve and download the data you requested into your local directory. However, before you run the cell below, the terms and conditions of this particular dataset need to have been accepted in the CDS. The option to view and accept these conditions is given at the end of the download form, just above the <strong>“Show API request”</strong> option.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;satellite-earth-radiation-budget&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;product_family&#39;</span><span class="p">:</span> <span class="s1">&#39;ceres_ebaf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;origin&#39;</span><span class="p">:</span> <span class="s1">&#39;nasa&#39;</span><span class="p">,</span>
    <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;incoming_shortwave_radiation&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;outgoing_longwave_radiation&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;outgoing_shortwave_radiation&#39;</span>
                <span class="p">],</span>
    <span class="s1">&#39;climate_data_record_type&#39;</span><span class="p">:</span> <span class="s1">&#39;thematic_climate_data_record&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time_aggregation&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_mean&#39;</span><span class="p">,</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%04d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2023</span><span class="p">)],</span>
    <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">month</span><span class="p">)</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>
<span class="p">}</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">download_zip_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-17 09:17:37,089 INFO [2024-09-28T00:00:00] **Welcome to the New Climate Data Store (CDS)!** This new system is in its early days of full operations and still undergoing enhancements and fine tuning. Some disruptions are to be expected. Your 
[feedback](https://jira.ecmwf.int/plugins/servlet/desk/portal/1/create/202) is key to improve the user experience on the new CDS for the benefit of everyone. Thank you.
2024-12-17 09:17:37,090 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2024-12-17 09:17:37,091 INFO [2024-09-16T00:00:00] Remember that you need to have an ECMWF account to use the new CDS. **Your old CDS credentials will not work in new CDS!**
2024-12-17 09:17:37,092 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2024-12-17 09:17:38,597 INFO [2024-01-09T00:00:00] NOAA/NCEI HIRS OLR was reprocessed from 2007 till 2023. Please see the Known issues section under the Documentation tab for more details.
2024-12-17 09:17:38,597 INFO Request ID is ef31d4c5-1693-4428-a206-1cb731123097
2024-12-17 09:17:38,753 INFO status has been updated to accepted
2024-12-17 09:17:43,826 INFO status has been updated to running
2024-12-17 09:17:52,400 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dd8a2ac429eb43a3a19412728f45c19c", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./ceres-erb-monthly.zip&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect-data">
<h3>Inspect data<a class="headerlink" href="#inspect-data" title="Permalink to this heading">#</a></h3>
<p>The data have been downloaded. We can now unzip the archive and merge all files into one NetCDF file to inspect them. NetCDF is a commonly used format for array-oriented scientifc data. To read and process these data, we will make use of the <a class="reference external" href="https://docs.xarray.dev/en/stable/index.html">Xarray</a> library. Xarray is an open source project and Python package that makes working with labelled multi-dimensional arrays simple and efficient.</p>
<p>We extract all our netCDF files from the zip archive and open them as a single <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html">Xarray Dataset</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unzip the data. The dataset is splitted in monthly files.</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">download_zip_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
    <span class="n">filelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">namelist</span><span class="p">()]</span>
    <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">)</span>
<span class="c1"># Ensure the filelist is in the correct order</span>
<span class="n">filelist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open all the files as a single Xarray dataset</span>
<span class="n">ds_ceres</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">filelist</span><span class="p">)</span>

<span class="n">ds_ceres</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 213MB
Dimensions:         (time: 274, lat: 180, lon: 360)
Coordinates:
  * time            (time) datetime64[ns] 2kB 2000-03-15 ... 2022-12-15
  * lat             (lat) float32 720B -89.5 -88.5 -87.5 ... 87.5 88.5 89.5
  * lon             (lon) float32 1kB 0.5 1.5 2.5 3.5 ... 357.5 358.5 359.5
Data variables:
    solar_mon       (time, lat, lon) float32 71MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
    toa_lw_all_mon  (time, lat, lon) float32 71MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
    toa_sw_all_mon  (time, lat, lon) float32 71MB dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;
Attributes:
    title:                           CERES EBAF (Energy Balanced and Filled) ...
    institution:                     NASA/LaRC (Langley Research Center) Hamp...
    Conventions:                     CF-1.4
    comment:                         Climatology from 07/2005 to 06/2015
    version:                         Edition 4.2; Release Date December 9, 2022
    DOI:                             10.5067/TERRA-AQUA-NOAA20/CERES/EBAF-TOA...
    Fill_Value:                      Fill Value is -999.0
    DODS_EXTRA.Unlimited_Dimension:  time
    history:                         2023-03-05 19:21:10 GMT Hyrax-1.16.2 htt...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7f95746e-c761-4f06-8283-286438891cec' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7f95746e-c761-4f06-8283-286438891cec' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 274</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b79bec30-eef0-4454-9a46-fb28763fb009' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b79bec30-eef0-4454-9a46-fb28763fb009' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2000-03-15 ... 2022-12-15</div><input id='attrs-da44ea3e-5c1e-4970-8596-52963571c52f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-da44ea3e-5c1e-4970-8596-52963571c52f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8bc357e0-a902-412a-b558-996d9c027043' class='xr-var-data-in' type='checkbox'><label for='data-8bc357e0-a902-412a-b558-996d9c027043' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2000-03-15T00:00:00.000000000&#x27;, &#x27;2000-04-15T00:00:00.000000000&#x27;,
       &#x27;2000-05-15T00:00:00.000000000&#x27;, ..., &#x27;2022-10-15T00:00:00.000000000&#x27;,
       &#x27;2022-11-15T00:00:00.000000000&#x27;, &#x27;2022-12-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-dffcb81b-a136-4a1c-9b94-a85e8b30e3f0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dffcb81b-a136-4a1c-9b94-a85e8b30e3f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cfe320a-2afc-4541-a0fa-528a26e5a98e' class='xr-var-data-in' type='checkbox'><label for='data-7cfe320a-2afc-4541-a0fa-528a26e5a98e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-d1b5579a-a2e8-4c33-928b-2b097afc778a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1b5579a-a2e8-4c33-928b-2b097afc778a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bdf3a8ca-ece2-4185-b6ba-eb190b645de3' class='xr-var-data-in' type='checkbox'><label for='data-bdf3a8ca-ece2-4185-b6ba-eb190b645de3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_range :</span></dt><dd>[  0. 360.]</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2624c167-7adf-4be3-ae41-560f63e44a66' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2624c167-7adf-4be3-ae41-560f63e44a66' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>solar_mon</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</div><input id='attrs-1359ae29-3cd1-4414-9ae9-3ef4a76e2364' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1359ae29-3cd1-4414-9ae9-3ef4a76e2364' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cca0c766-4566-4ada-9a32-cb90dfb63eda' class='xr-var-data-in' type='checkbox'><label for='data-cca0c766-4566-4ada-9a32-cb90dfb63eda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Incoming Solar Flux, Monthly Means</dd><dt><span>standard_name :</span></dt><dd>Incoming Solar Flux</dd><dt><span>CF_name :</span></dt><dd>toa_incoming_shortwave_flux</dd><dt><span>comment :</span></dt><dd>none</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>800.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.73 MiB </td>
                        <td> 253.12 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (274, 180, 360) </td>
                        <td> (1, 180, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 274 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="233" height="163" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="10" y1="60" x2="63" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="15" y1="5" x2="15" y2="65" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="26" y1="16" x2="26" y2="76" />
  <line x1="29" y1="19" x2="29" y2="79" />
  <line x1="32" y1="22" x2="32" y2="82" />
  <line x1="35" y1="25" x2="35" y2="85" />
  <line x1="38" y1="28" x2="38" y2="88" />
  <line x1="40" y1="30" x2="40" y2="90" />
  <line x1="43" y1="33" x2="43" y2="93" />
  <line x1="46" y1="36" x2="46" y2="96" />
  <line x1="49" y1="39" x2="49" y2="99" />
  <line x1="52" y1="42" x2="52" y2="102" />
  <line x1="55" y1="45" x2="55" y2="105" />
  <line x1="58" y1="48" x2="58" y2="108" />
  <line x1="60" y1="50" x2="60" y2="110" />
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 63.72549019607844,53.72549019607844 63.72549019607844,113.72549019607844 10.0,60.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="24" y1="14" x2="144" y2="14" />
  <line x1="26" y1="16" x2="146" y2="16" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="32" y1="22" x2="152" y2="22" />
  <line x1="35" y1="25" x2="155" y2="25" />
  <line x1="38" y1="28" x2="158" y2="28" />
  <line x1="40" y1="30" x2="160" y2="30" />
  <line x1="43" y1="33" x2="163" y2="33" />
  <line x1="46" y1="36" x2="166" y2="36" />
  <line x1="49" y1="39" x2="169" y2="39" />
  <line x1="52" y1="42" x2="172" y2="42" />
  <line x1="55" y1="45" x2="175" y2="45" />
  <line x1="58" y1="48" x2="178" y2="48" />
  <line x1="60" y1="50" x2="180" y2="50" />
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="130" y1="0" x2="183" y2="53" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 183.72549019607845,53.72549019607844 63.72549019607844,53.72549019607844" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />
  <line x1="63" y1="113" x2="183" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />
  <line x1="183" y1="53" x2="183" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="63.72549019607844,53.72549019607844 183.72549019607845,53.72549019607844 183.72549019607845,113.72549019607844 63.72549019607844,113.72549019607844" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="123.725490" y="133.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="203.725490" y="83.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,203.725490,83.725490)">180</text>
  <text x="26.862745" y="106.862745" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,26.862745,106.862745)">274</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>toa_lw_all_mon</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</div><input id='attrs-c0dac012-68e0-4f9c-8943-d27aed32f4af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0dac012-68e0-4f9c-8943-d27aed32f4af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc5fe641-db45-4862-8707-62237c5d9584' class='xr-var-data-in' type='checkbox'><label for='data-bc5fe641-db45-4862-8707-62237c5d9584' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Top of The Atmosphere Longwave Flux, All-Sky conditions, Monthly Means</dd><dt><span>standard_name :</span></dt><dd>TOA Longwave Flux - All-Sky</dd><dt><span>CF_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>comment :</span></dt><dd>none</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>400.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.73 MiB </td>
                        <td> 253.12 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (274, 180, 360) </td>
                        <td> (1, 180, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 274 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="233" height="163" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="10" y1="60" x2="63" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="15" y1="5" x2="15" y2="65" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="26" y1="16" x2="26" y2="76" />
  <line x1="29" y1="19" x2="29" y2="79" />
  <line x1="32" y1="22" x2="32" y2="82" />
  <line x1="35" y1="25" x2="35" y2="85" />
  <line x1="38" y1="28" x2="38" y2="88" />
  <line x1="40" y1="30" x2="40" y2="90" />
  <line x1="43" y1="33" x2="43" y2="93" />
  <line x1="46" y1="36" x2="46" y2="96" />
  <line x1="49" y1="39" x2="49" y2="99" />
  <line x1="52" y1="42" x2="52" y2="102" />
  <line x1="55" y1="45" x2="55" y2="105" />
  <line x1="58" y1="48" x2="58" y2="108" />
  <line x1="60" y1="50" x2="60" y2="110" />
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 63.72549019607844,53.72549019607844 63.72549019607844,113.72549019607844 10.0,60.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="24" y1="14" x2="144" y2="14" />
  <line x1="26" y1="16" x2="146" y2="16" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="32" y1="22" x2="152" y2="22" />
  <line x1="35" y1="25" x2="155" y2="25" />
  <line x1="38" y1="28" x2="158" y2="28" />
  <line x1="40" y1="30" x2="160" y2="30" />
  <line x1="43" y1="33" x2="163" y2="33" />
  <line x1="46" y1="36" x2="166" y2="36" />
  <line x1="49" y1="39" x2="169" y2="39" />
  <line x1="52" y1="42" x2="172" y2="42" />
  <line x1="55" y1="45" x2="175" y2="45" />
  <line x1="58" y1="48" x2="178" y2="48" />
  <line x1="60" y1="50" x2="180" y2="50" />
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="130" y1="0" x2="183" y2="53" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 183.72549019607845,53.72549019607844 63.72549019607844,53.72549019607844" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />
  <line x1="63" y1="113" x2="183" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />
  <line x1="183" y1="53" x2="183" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="63.72549019607844,53.72549019607844 183.72549019607845,53.72549019607844 183.72549019607845,113.72549019607844 63.72549019607844,113.72549019607844" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="123.725490" y="133.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="203.725490" y="83.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,203.725490,83.725490)">180</text>
  <text x="26.862745" y="106.862745" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,26.862745,106.862745)">274</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>toa_sw_all_mon</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</div><input id='attrs-29e285d8-0758-4ced-a793-6173cd841e8f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-29e285d8-0758-4ced-a793-6173cd841e8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c317356-7a90-47b0-825b-81d71db693bb' class='xr-var-data-in' type='checkbox'><label for='data-5c317356-7a90-47b0-825b-81d71db693bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Top of The Atmosphere Shortwave Flux, All-Sky conditions, Monthly Means</dd><dt><span>standard_name :</span></dt><dd>TOA Shortwave Flux - All-Sky</dd><dt><span>CF_name :</span></dt><dd>toa_outgoing_shortwave_flux</dd><dt><span>comment :</span></dt><dd>none</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>600.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.73 MiB </td>
                        <td> 253.12 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (274, 180, 360) </td>
                        <td> (1, 180, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 274 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="233" height="163" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="10" y1="60" x2="63" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="15" y1="5" x2="15" y2="65" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="26" y1="16" x2="26" y2="76" />
  <line x1="29" y1="19" x2="29" y2="79" />
  <line x1="32" y1="22" x2="32" y2="82" />
  <line x1="35" y1="25" x2="35" y2="85" />
  <line x1="38" y1="28" x2="38" y2="88" />
  <line x1="40" y1="30" x2="40" y2="90" />
  <line x1="43" y1="33" x2="43" y2="93" />
  <line x1="46" y1="36" x2="46" y2="96" />
  <line x1="49" y1="39" x2="49" y2="99" />
  <line x1="52" y1="42" x2="52" y2="102" />
  <line x1="55" y1="45" x2="55" y2="105" />
  <line x1="58" y1="48" x2="58" y2="108" />
  <line x1="60" y1="50" x2="60" y2="110" />
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 63.72549019607844,53.72549019607844 63.72549019607844,113.72549019607844 10.0,60.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="24" y1="14" x2="144" y2="14" />
  <line x1="26" y1="16" x2="146" y2="16" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="32" y1="22" x2="152" y2="22" />
  <line x1="35" y1="25" x2="155" y2="25" />
  <line x1="38" y1="28" x2="158" y2="28" />
  <line x1="40" y1="30" x2="160" y2="30" />
  <line x1="43" y1="33" x2="163" y2="33" />
  <line x1="46" y1="36" x2="166" y2="36" />
  <line x1="49" y1="39" x2="169" y2="39" />
  <line x1="52" y1="42" x2="172" y2="42" />
  <line x1="55" y1="45" x2="175" y2="45" />
  <line x1="58" y1="48" x2="178" y2="48" />
  <line x1="60" y1="50" x2="180" y2="50" />
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="130" y1="0" x2="183" y2="53" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 183.72549019607845,53.72549019607844 63.72549019607844,53.72549019607844" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />
  <line x1="63" y1="113" x2="183" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />
  <line x1="183" y1="53" x2="183" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="63.72549019607844,53.72549019607844 183.72549019607845,53.72549019607844 183.72549019607845,113.72549019607844 63.72549019607844,113.72549019607844" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="123.725490" y="133.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="203.725490" y="83.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,203.725490,83.725490)">180</text>
  <text x="26.862745" y="106.862745" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,26.862745,106.862745)">274</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-954354f3-8450-46b2-a34b-c436f744ef41' class='xr-section-summary-in' type='checkbox'  ><label for='section-954354f3-8450-46b2-a34b-c436f744ef41' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-faac0647-6983-4e71-af57-7ad571bf75f9' class='xr-index-data-in' type='checkbox'/><label for='index-faac0647-6983-4e71-af57-7ad571bf75f9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2000-03-15&#x27;, &#x27;2000-04-15&#x27;, &#x27;2000-05-15&#x27;, &#x27;2000-06-15&#x27;,
               &#x27;2000-07-15&#x27;, &#x27;2000-08-15&#x27;, &#x27;2000-09-15&#x27;, &#x27;2000-10-15&#x27;,
               &#x27;2000-11-15&#x27;, &#x27;2000-12-15&#x27;,
               ...
               &#x27;2022-03-15&#x27;, &#x27;2022-04-15&#x27;, &#x27;2022-05-15&#x27;, &#x27;2022-06-15&#x27;,
               &#x27;2022-07-15&#x27;, &#x27;2022-08-15&#x27;, &#x27;2022-09-15&#x27;, &#x27;2022-10-15&#x27;,
               &#x27;2022-11-15&#x27;, &#x27;2022-12-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=274, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-26f00f64-7d83-4e52-82af-48586aca7dad' class='xr-index-data-in' type='checkbox'/><label for='index-26f00f64-7d83-4e52-82af-48586aca7dad' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f2bdb028-050c-40f4-8f50-9b869236a1f2' class='xr-index-data-in' type='checkbox'/><label for='index-f2bdb028-050c-40f4-8f50-9b869236a1f2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
       ...
       350.5, 351.5, 352.5, 353.5, 354.5, 355.5, 356.5, 357.5, 358.5, 359.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=360))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7d390a3b-3e4f-45b1-a9b5-93d4e9a65e71' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7d390a3b-3e4f-45b1-a9b5-93d4e9a65e71' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>CERES EBAF (Energy Balanced and Filled) TOA Fluxes. Monthly Averages and 07/2005 to 06/2015 Climatology.</dd><dt><span>institution :</span></dt><dd>NASA/LaRC (Langley Research Center) Hampton, Va</dd><dt><span>Conventions :</span></dt><dd>CF-1.4</dd><dt><span>comment :</span></dt><dd>Climatology from 07/2005 to 06/2015</dd><dt><span>version :</span></dt><dd>Edition 4.2; Release Date December 9, 2022</dd><dt><span>DOI :</span></dt><dd>10.5067/TERRA-AQUA-NOAA20/CERES/EBAF-TOA_L3B004.2</dd><dt><span>Fill_Value :</span></dt><dd>Fill Value is -999.0</dd><dt><span>DODS_EXTRA.Unlimited_Dimension :</span></dt><dd>time</dd><dt><span>history :</span></dt><dd>2023-03-05 19:21:10 GMT Hyrax-1.16.2 https://opendap.larc.nasa.gov/opendap/CERES/EBAF/TOA_Edition4.2/CERES_EBAF-TOA_Edition4.2_200003-202211.nc.nc?solar_mon%5B0%5D%5B0:179%5D%5B0:359%5D</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We see that the dataset has three variables <strong>solar_mon</strong>, <strong>toa_lw_all_mon</strong> and <strong>toa_sw_all_mon</strong> which stand for the incoming solar flux, the top of atmosphere (TOA) longwave (LW) and shortwave (SW) fluxes respectively, as well as three dimension coordinates of <strong>lon</strong>, <strong>lat</strong> and <strong>time</strong>.</p>
<p>While an Xarray <strong>dataset</strong> may contain multiple variables, an Xarray <strong>data array</strong> holds a single multi-dimensional variable and its coordinates. To make the processing of the <strong>solar_mon</strong>, <strong>toa_lw_all_mon</strong> and <strong>toa_sw_all_mon</strong> data easier, we convert them into three distinct Xarray data arrays. We can also define a new data array <strong>da_toa_erb</strong> that corresponds to the TOA net Earth’s radative budget and is defined as the difference between the incoming solar flux and the sum of the outgoing (LW, SW) fluxes at the top the atmosphere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Outgoing longwave radiation data array</span>
<span class="n">da_toa_lw</span> <span class="o">=</span> <span class="n">ds_ceres</span><span class="p">[</span><span class="s1">&#39;toa_lw_all_mon&#39;</span><span class="p">]</span>

<span class="c1"># Incoming shortwave radiation data array</span>
<span class="n">da_solar</span> <span class="o">=</span> <span class="n">ds_ceres</span><span class="p">[</span><span class="s1">&#39;solar_mon&#39;</span><span class="p">]</span>

<span class="c1"># Outgoing shortwave radiation data array</span>
<span class="n">da_toa_sw</span> <span class="o">=</span> <span class="n">ds_ceres</span><span class="p">[</span><span class="s1">&#39;toa_sw_all_mon&#39;</span><span class="p">]</span>

<span class="c1"># Creation of the net radiative flux data array</span>
<span class="n">da_toa_erb</span> <span class="o">=</span> <span class="n">da_solar</span> <span class="o">-</span> <span class="n">da_toa_sw</span> <span class="o">-</span> <span class="n">da_toa_lw</span>
<span class="c1"># Name of the data array</span>
<span class="n">da_toa_erb</span> <span class="o">=</span> <span class="n">da_toa_erb</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;toa_erb_all_mon&#39;</span><span class="p">)</span>
<span class="c1"># Add some attributes to the new data array</span>
<span class="n">da_toa_erb</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s2">&quot;Top of The Atmosphere Net Earth&#39;s Radiative Flux&quot;</span><span class="p">,</span>
    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s2">&quot;TOA Net Flux&quot;</span><span class="p">,</span><span class="s1">&#39;CF_name&#39;</span><span class="p">:</span> <span class="s2">&quot;toa_net_radiative_flux&quot;</span><span class="p">,</span>
    <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s2">&quot;W.m$^{-2}$&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Let us view these data, e.g. the <strong>toa_erb_all_mon</strong> data from our newly created <strong>da_toa_erb</strong> data array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_toa_erb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;toa_erb_all_mon&#x27; (time: 274, lat: 180, lon: 360)&gt; Size: 71MB
dask.array&lt;sub, shape=(274, 180, 360), dtype=float32, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;
Coordinates:
  * time     (time) datetime64[ns] 2kB 2000-03-15 2000-04-15 ... 2022-12-15
  * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
  * lon      (lon) float32 1kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5
Attributes:
    long_name:      Top of The Atmosphere Net Earth&#x27;s Radiative Flux
    standard_name:  TOA Net Flux
    CF_name:        toa_net_radiative_flux
    comment:        none
    units:          W.m$^{-2}$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'toa_erb_all_mon'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 274</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-4713d626-c8e4-4b19-885f-8b4c4e80f335' class='xr-array-in' type='checkbox' checked><label for='section-4713d626-c8e4-4b19-885f-8b4c4e80f335' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 67.73 MiB </td>
                        <td> 253.12 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (274, 180, 360) </td>
                        <td> (1, 180, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 274 chunks in 1649 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="233" height="163" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="10" y1="60" x2="63" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="15" y1="5" x2="15" y2="65" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="26" y1="16" x2="26" y2="76" />
  <line x1="29" y1="19" x2="29" y2="79" />
  <line x1="32" y1="22" x2="32" y2="82" />
  <line x1="35" y1="25" x2="35" y2="85" />
  <line x1="38" y1="28" x2="38" y2="88" />
  <line x1="40" y1="30" x2="40" y2="90" />
  <line x1="43" y1="33" x2="43" y2="93" />
  <line x1="46" y1="36" x2="46" y2="96" />
  <line x1="49" y1="39" x2="49" y2="99" />
  <line x1="52" y1="42" x2="52" y2="102" />
  <line x1="55" y1="45" x2="55" y2="105" />
  <line x1="58" y1="48" x2="58" y2="108" />
  <line x1="60" y1="50" x2="60" y2="110" />
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 63.72549019607844,53.72549019607844 63.72549019607844,113.72549019607844 10.0,60.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="24" y1="14" x2="144" y2="14" />
  <line x1="26" y1="16" x2="146" y2="16" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="32" y1="22" x2="152" y2="22" />
  <line x1="35" y1="25" x2="155" y2="25" />
  <line x1="38" y1="28" x2="158" y2="28" />
  <line x1="40" y1="30" x2="160" y2="30" />
  <line x1="43" y1="33" x2="163" y2="33" />
  <line x1="46" y1="36" x2="166" y2="36" />
  <line x1="49" y1="39" x2="169" y2="39" />
  <line x1="52" y1="42" x2="172" y2="42" />
  <line x1="55" y1="45" x2="175" y2="45" />
  <line x1="58" y1="48" x2="178" y2="48" />
  <line x1="60" y1="50" x2="180" y2="50" />
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="63" y2="53" style="stroke-width:2" />
  <line x1="130" y1="0" x2="183" y2="53" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 183.72549019607845,53.72549019607844 63.72549019607844,53.72549019607844" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="63" y1="53" x2="183" y2="53" style="stroke-width:2" />
  <line x1="63" y1="113" x2="183" y2="113" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="63" y1="53" x2="63" y2="113" style="stroke-width:2" />
  <line x1="183" y1="53" x2="183" y2="113" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="63.72549019607844,53.72549019607844 183.72549019607845,53.72549019607844 183.72549019607845,113.72549019607844 63.72549019607844,113.72549019607844" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="123.725490" y="133.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="203.725490" y="83.725490" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,203.725490,83.725490)">180</text>
  <text x="26.862745" y="106.862745" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,26.862745,106.862745)">274</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-7dd1ae34-bec6-411c-883d-f405f492fb4d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7dd1ae34-bec6-411c-883d-f405f492fb4d' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2000-03-15 ... 2022-12-15</div><input id='attrs-56f9fac3-cdb0-4b01-85ee-86ede6694e16' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-56f9fac3-cdb0-4b01-85ee-86ede6694e16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-728fa37f-33dd-4157-8e39-dcbf4da475a8' class='xr-var-data-in' type='checkbox'><label for='data-728fa37f-33dd-4157-8e39-dcbf4da475a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2000-03-15T00:00:00.000000000&#x27;, &#x27;2000-04-15T00:00:00.000000000&#x27;,
       &#x27;2000-05-15T00:00:00.000000000&#x27;, ..., &#x27;2022-10-15T00:00:00.000000000&#x27;,
       &#x27;2022-11-15T00:00:00.000000000&#x27;, &#x27;2022-12-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-22524de7-f662-4372-b2be-5e101257219c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-22524de7-f662-4372-b2be-5e101257219c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88c3658c-7368-4f26-9195-f60123e621a1' class='xr-var-data-in' type='checkbox'><label for='data-88c3658c-7368-4f26-9195-f60123e621a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-339c2ec0-f1f9-4205-acde-b0bd297d08a7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-339c2ec0-f1f9-4205-acde-b0bd297d08a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3776e087-3832-4047-a95c-df01a1daa731' class='xr-var-data-in' type='checkbox'><label for='data-3776e087-3832-4047-a95c-df01a1daa731' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_range :</span></dt><dd>[  0. 360.]</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-89f2ee56-a9f0-459c-a87d-7d25ef1bd8e0' class='xr-section-summary-in' type='checkbox'  ><label for='section-89f2ee56-a9f0-459c-a87d-7d25ef1bd8e0' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-61cb1d52-4772-4961-a8c2-e2c07c5a48d0' class='xr-index-data-in' type='checkbox'/><label for='index-61cb1d52-4772-4961-a8c2-e2c07c5a48d0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2000-03-15&#x27;, &#x27;2000-04-15&#x27;, &#x27;2000-05-15&#x27;, &#x27;2000-06-15&#x27;,
               &#x27;2000-07-15&#x27;, &#x27;2000-08-15&#x27;, &#x27;2000-09-15&#x27;, &#x27;2000-10-15&#x27;,
               &#x27;2000-11-15&#x27;, &#x27;2000-12-15&#x27;,
               ...
               &#x27;2022-03-15&#x27;, &#x27;2022-04-15&#x27;, &#x27;2022-05-15&#x27;, &#x27;2022-06-15&#x27;,
               &#x27;2022-07-15&#x27;, &#x27;2022-08-15&#x27;, &#x27;2022-09-15&#x27;, &#x27;2022-10-15&#x27;,
               &#x27;2022-11-15&#x27;, &#x27;2022-12-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=274, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9e40e81e-a791-4a24-8321-ad917df665a5' class='xr-index-data-in' type='checkbox'/><label for='index-9e40e81e-a791-4a24-8321-ad917df665a5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4051d60f-eafb-4363-9c71-2940621f28a8' class='xr-index-data-in' type='checkbox'/><label for='index-4051d60f-eafb-4363-9c71-2940621f28a8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
       ...
       350.5, 351.5, 352.5, 353.5, 354.5, 355.5, 356.5, 357.5, 358.5, 359.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=360))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-444c499d-4f03-4794-96af-f7e3833716fa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-444c499d-4f03-4794-96af-f7e3833716fa' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Top of The Atmosphere Net Earth&#x27;s Radiative Flux</dd><dt><span>standard_name :</span></dt><dd>TOA Net Flux</dd><dt><span>CF_name :</span></dt><dd>toa_net_radiative_flux</dd><dt><span>comment :</span></dt><dd>none</dd><dt><span>units :</span></dt><dd>W.m$^{-2}$</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="plot-data">
<h3>Plot data<a class="headerlink" href="#plot-data" title="Permalink to this heading">#</a></h3>
<p>We can visualize one time step to figure out what the data look like. Xarray offers built-in matplotlib functions that allow you to plot a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>. With the function <code class="docutils literal notranslate"><span class="pre">plot()</span></code>, you can easily plot e.g. the first time step of the loaded array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_toa_erb</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x30c1a4f50&gt;
</pre></div>
</div>
<img alt="../_images/45f0cbd3f7be135ba5d313393540ebfc99a01c7c59c498785edc0a4827f298b7.png" src="../_images/45f0cbd3f7be135ba5d313393540ebfc99a01c7c59c498785edc0a4827f298b7.png" />
</div>
</div>
<p><strong>Figure 1</strong> shows the Top of the Atmosphere Net Earth’s Radiative Flux for March 2000.</p>
<p>An alternative to the built-in Xarray plotting functions is to make use of a combination of the plotting libraries <a class="reference external" href="https://matplotlib.org/">matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">Cartopy</a>. One of Cartopy’s key features is its ability to transform array data into different geographic projections. In combination with matplotlib, it is a very powerful way to create high-quality visualisations and animations. In later plots, we will make use of these libraries to produce more customised visualisations.</p>
</section>
</section>
<section id="climatology-of-the-earth-s-radiation-budget">
<h2>Climatology of the Earth’s Radiation Budget<a class="headerlink" href="#climatology-of-the-earth-s-radiation-budget" title="Permalink to this heading">#</a></h2>
<p>In this section we will study the Earth’s radiation budget by analysing separately the averaged global and seasonal climatological distributions of the incoming radiation from the sun, of the outgoing reflected shortwave and emitted longwave radiations, and of the net radiation at the top of the atmosphere.</p>
<section id="climatology-of-the-top-of-atmosphere-incoming-solar-radiation">
<h3>Climatology of the top-of-atmosphere incoming solar radiation<a class="headerlink" href="#climatology-of-the-top-of-atmosphere-incoming-solar-radiation" title="Permalink to this heading">#</a></h3>
<p>In this section we will analyse the time averaged global and seasonal climatological distributions of the TOA incoming solar radiation (TIS).</p>
<section id="time-averaged-global-climatological-distribution-of-tis">
<h4>Time averaged global climatological distribution of TIS<a class="headerlink" href="#time-averaged-global-climatological-distribution-of-tis" title="Permalink to this heading">#</a></h4>
<p>To calculate the mean climatology of the top of the atmosphere incoming solar radiation for the time period January 2001 to December 2021, we have to select the specific time range using the Xarray method <code class="docutils literal notranslate"><span class="pre">sel()</span></code> that indexes the data and dimensions by the appropriate indexers. We can then use the method <code class="docutils literal notranslate"><span class="pre">mean()</span></code> to calculate the mean along the time dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the TOA incoming solar radiation data for the whole time period</span>
<span class="n">solar</span> <span class="o">=</span> <span class="n">da_solar</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Calculate the mean along the time dimension</span>
<span class="n">solar_mean</span> <span class="o">=</span> <span class="n">solar</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now visualize the time averaged global climatological distribution of the incoming solar radiation for the period January 2001 - December 2021. This time, we will make use of a combination of the plotting libraries <a class="reference external" href="https://matplotlib.org/stable/index.html">Matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">Cartopy</a> to create a more customised figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
<span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">solar_mean</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">solar_mean</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">solar_mean</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Climatology of TIS from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># Add coastlines</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Define gridlines and ticks</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="c1"># Gridlines</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_solar_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d7cd6f622e3c612c4aedf4cfdfcf7c2fc50d36fb2831a77e3c87c9ae7ba40f14.png" src="../_images/d7cd6f622e3c612c4aedf4cfdfcf7c2fc50d36fb2831a77e3c87c9ae7ba40f14.png" />
</div>
</div>
<p><strong>Figure 2</strong> shows the regular latitude dependent climatological distribution of the incoming solar radiation at the top of the atmosphere, with values decreasing from the tropics to the high latitudes.</p>
</section>
<section id="time-averaged-seasonal-climatological-distribution-of-tis">
<h4>Time averaged seasonal climatological distribution of TIS<a class="headerlink" href="#time-averaged-seasonal-climatological-distribution-of-tis" title="Permalink to this heading">#</a></h4>
<p>The TOA incoming solar radiation data can also be splitted according to the seasons by using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method, with <code class="docutils literal notranslate"><span class="pre">'time.season'</span></code> as an argument, and then averaged over the years.
Seasons are defined as follows, using the Northern Hemisphere (NH) as reference:</p>
<ul class="simple">
<li><p>NH spring: March, April, May</p></li>
<li><p>NH summer: June, July, August</p></li>
<li><p>NH autumn: September, October, November</p></li>
<li><p>NH winter: December, January, February</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split data array solar by season</span>
<span class="n">solar_seasonal_climatology</span> <span class="o">=</span> <span class="n">solar</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">solar_seasonal_climatology</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;solar_mon&#x27; (season: 4, lat: 180, lon: 360)&gt; Size: 1MB
dask.array&lt;stack, shape=(4, 180, 360), dtype=float32, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
  * lon      (lon) float32 1kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5
  * season   (season) object 32B &#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;
Attributes:
    long_name:      Incoming Solar Flux, Monthly Means
    standard_name:  Incoming Solar Flux
    CF_name:        toa_incoming_shortwave_flux
    comment:        none
    units:          W m-2
    valid_min:      0.0
    valid_max:      800.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'solar_mon'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>season</span>: 4</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-368d334b-e121-489a-a398-3fc7e2d8cc72' class='xr-array-in' type='checkbox' checked><label for='section-368d334b-e121-489a-a398-3fc7e2d8cc72' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 0.99 MiB </td>
                        <td> 253.12 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (4, 180, 360) </td>
                        <td> (1, 180, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 571 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="60" x2="25" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="25" y1="15" x2="25" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.24950591292101,15.249505912921009 25.24950591292101,75.24950591292101 10.0,60.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.249505912921,15.249505912921009 25.24950591292101,15.249505912921009" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="75" x2="145" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="75" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.24950591292101,15.249505912921009 145.249505912921,15.249505912921009 145.249505912921,75.24950591292101 25.24950591292101,75.24950591292101" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.249506" y="95.249506" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="165.249506" y="45.249506" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.249506,45.249506)">180</text>
  <text x="7.624753" y="87.624753" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.624753,87.624753)">4</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-441b5cf5-14fc-46d0-b166-c2f338d3eada' class='xr-section-summary-in' type='checkbox'  checked><label for='section-441b5cf5-14fc-46d0-b166-c2f338d3eada' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-df04472c-911c-4894-86d0-56bafcbe79e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-df04472c-911c-4894-86d0-56bafcbe79e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a488c82c-ba5a-4902-a218-8c3584b97a41' class='xr-var-data-in' type='checkbox'><label for='data-a488c82c-ba5a-4902-a218-8c3584b97a41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-ac2c2afb-3eea-412d-8a44-9a0f7ffed160' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ac2c2afb-3eea-412d-8a44-9a0f7ffed160' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08755144-d803-4ab6-8d5c-e1b0be999235' class='xr-var-data-in' type='checkbox'><label for='data-08755144-d803-4ab6-8d5c-e1b0be999235' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_range :</span></dt><dd>[  0. 360.]</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>season</span></div><div class='xr-var-dims'>(season)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;</div><input id='attrs-f0bb1359-c737-45f5-94e8-cc47f5b87b99' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f0bb1359-c737-45f5-94e8-cc47f5b87b99' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63afe506-5c09-4403-a779-2e51105db212' class='xr-var-data-in' type='checkbox'><label for='data-63afe506-5c09-4403-a779-2e51105db212' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;DJF&#x27;, &#x27;JJA&#x27;, &#x27;MAM&#x27;, &#x27;SON&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-75a0faaa-c0be-471b-b8de-9279b7bd11c0' class='xr-section-summary-in' type='checkbox'  ><label for='section-75a0faaa-c0be-471b-b8de-9279b7bd11c0' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-44651905-8c03-4942-938e-cab808fdde72' class='xr-index-data-in' type='checkbox'/><label for='index-44651905-8c03-4942-938e-cab808fdde72' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bfcc3493-15db-4fca-b551-6d222a1f8c12' class='xr-index-data-in' type='checkbox'/><label for='index-bfcc3493-15db-4fca-b551-6d222a1f8c12' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
       ...
       350.5, 351.5, 352.5, 353.5, 354.5, 355.5, 356.5, 357.5, 358.5, 359.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>season</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e30fbb83-7fc8-4062-bf09-d15d3fe2c5d5' class='xr-index-data-in' type='checkbox'/><label for='index-e30fbb83-7fc8-4062-bf09-d15d3fe2c5d5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;DJF&#x27;, &#x27;JJA&#x27;, &#x27;MAM&#x27;, &#x27;SON&#x27;], dtype=&#x27;object&#x27;, name=&#x27;season&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4b8a15a2-0430-4666-9ff5-839d2a28e652' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4b8a15a2-0430-4666-9ff5-839d2a28e652' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Incoming Solar Flux, Monthly Means</dd><dt><span>standard_name :</span></dt><dd>Incoming Solar Flux</dd><dt><span>CF_name :</span></dt><dd>toa_incoming_shortwave_flux</dd><dt><span>comment :</span></dt><dd>none</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>800.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The xarray <strong>solar_seasonal_climatology</strong> has four entries in the time dimension (one for each season). The climatology of the incident solar flux distribution can now be plotted for each season.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of the seasons such as defined in the dataset solar_seasonal_climatology:</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAM&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">]</span>

<span class="c1"># We use the &quot;subplots&quot; to place multiple plots according to our needs. </span>
<span class="c1"># In this case, we want 4 plots in a 2x2 format.</span>
<span class="c1"># For this &quot;nrows&quot; = 2 and &quot;ncols&quot; = 2, the projection and size are defined as well</span>
<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Define a dictionary of subtitles, each one corresponding to a season</span>
<span class="n">subtitles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span> <span class="s1">&#39;NH spring&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">:</span> <span class="s1">&#39;NH summer&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">:</span> <span class="s1">&#39;NH autumn&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">:</span> <span class="s1">&#39;NH winter&#39;</span><span class="p">}</span>

<span class="c1"># Configure the axes and subplot titles</span>
<span class="k">for</span> <span class="n">i_season</span><span class="p">,</span> <span class="n">c_season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seasons</span><span class="p">):</span>
    <span class="c1"># convert i_season index into (row, col) index</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="c1"># Plot data (coordinates and data) and define colormap</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax3</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">solar_seasonal_climatology</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span>
                                  <span class="n">solar_seasonal_climatology</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                                  <span class="n">solar_seasonal_climatology</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">c_season</span><span class="p">),</span>
                                  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>
    <span class="c1"># Set title and size</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TIS - &#39;</span> <span class="o">+</span> <span class="n">subtitles</span><span class="p">[</span><span class="n">c_season</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Add coastlines</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="c1"># Define grid lines and ticks (e.g. from -180 to 180 in an interval of 60)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
    <span class="c1"># Gridline</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax3</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig3</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig3</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TIS from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
              <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_solar_seasonal_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2029c0937a1613482d95d4a026f0bdf515d5f293c6c7ab040a07883720dbcdf0.png" src="../_images/2029c0937a1613482d95d4a026f0bdf515d5f293c6c7ab040a07883720dbcdf0.png" />
</div>
</div>
<p><strong>Figure 3</strong> shows the seasonal mean climatology of the top of the atmosphere incoming solar radiation from spring to winter (top left to bottom right panels) derived from CERES EBAF.</p>
<div style="text-align: justify"> The seasonal and latitudinal variability of the incoming solar radiation is remarkable, with the values decreasing progressively from the summer hemisphere to the winter hemisphere and increasing from the winter hemisphere to the summer hemisphere. </div></section>
<section id="zonally-averaged-monthly-mean-climatology-of-tis">
<h4>Zonally averaged monthly mean climatology of TIS<a class="headerlink" href="#zonally-averaged-monthly-mean-climatology-of-tis" title="Permalink to this heading">#</a></h4>
<p>We will now calculate the monthly mean climatology of the top-of-atmosphere incoming solar radiation over the time period January 2001 - December 2021 by first applying the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method to group the data array by month and then calculating the average for each monthly group. The resulting data array is the monthly climatology for the top of atmosphere incident solar radiation based on reference January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solar_clim_month</span> <span class="o">=</span> <span class="n">solar</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">solar_clim_month</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;solar_mon&#x27; (month: 12, lat: 180, lon: 360)&gt; Size: 3MB
dask.array&lt;stack, shape=(12, 180, 360), dtype=float32, chunksize=(1, 180, 360), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
  * lon      (lon) float32 1kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Attributes:
    long_name:      Incoming Solar Flux, Monthly Means
    standard_name:  Incoming Solar Flux
    CF_name:        toa_incoming_shortwave_flux
    comment:        none
    units:          W m-2
    valid_min:      0.0
    valid_max:      800.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'solar_mon'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>month</span>: 12</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>lon</span>: 360</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e0e0dd28-87cf-4436-9255-7ba3c5ff140a' class='xr-array-in' type='checkbox' checked><label for='section-e0e0dd28-87cf-4436-9255-7ba3c5ff140a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 180, 360), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.97 MiB </td>
                        <td> 253.12 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 180, 360) </td>
                        <td> (1, 180, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 611 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="128" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="60" x2="28" y2="78" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="64" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="19" y1="9" x2="19" y2="69" />
  <line x1="20" y1="10" x2="20" y2="70" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="25" y1="15" x2="25" y2="75" />
  <line x1="27" y1="17" x2="27" y2="77" />
  <line x1="28" y1="18" x2="28" y2="78" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.83785440829468,18.83785440829468 28.83785440829468,78.83785440829467 10.0,60.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="24" y1="14" x2="144" y2="14" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.83785440829467,18.83785440829468 28.83785440829468,18.83785440829468" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="78" x2="148" y2="78" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="78" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="78" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.83785440829468,18.83785440829468 148.83785440829467,18.83785440829468 148.83785440829467,78.83785440829467 28.83785440829468,78.83785440829467" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.837854" y="98.837854" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="168.837854" y="48.837854" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.837854,48.837854)">180</text>
  <text x="9.418927" y="89.418927" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.418927,89.418927)">12</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-4ed74b2d-5c11-4700-9b04-05af35501b75' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4ed74b2d-5c11-4700-9b04-05af35501b75' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-9ba65eea-2a81-4c39-adf9-2979dd621c03' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9ba65eea-2a81-4c39-adf9-2979dd621c03' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2904907-3327-4ba0-8dae-92762f9f0e97' class='xr-var-data-in' type='checkbox'><label for='data-f2904907-3327-4ba0-8dae-92762f9f0e97' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 1.5 2.5 ... 357.5 358.5 359.5</div><input id='attrs-ddd8ab58-d2e3-4d03-8fac-03a2af60cfef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ddd8ab58-d2e3-4d03-8fac-03a2af60cfef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98f35656-ad62-4d70-bbfe-dad3154ba62a' class='xr-var-data-in' type='checkbox'><label for='data-98f35656-ad62-4d70-bbfe-dad3154ba62a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_range :</span></dt><dd>[  0. 360.]</dd></dl></div><div class='xr-var-data'><pre>array([  0.5,   1.5,   2.5, ..., 357.5, 358.5, 359.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-5d6e2fd5-f478-4721-91f8-414f661b1378' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5d6e2fd5-f478-4721-91f8-414f661b1378' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-671553dd-d82f-4d7a-95be-c8e2715177e9' class='xr-var-data-in' type='checkbox'><label for='data-671553dd-d82f-4d7a-95be-c8e2715177e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2db69933-75b2-412d-a6ae-74e1c2e314ab' class='xr-section-summary-in' type='checkbox'  ><label for='section-2db69933-75b2-412d-a6ae-74e1c2e314ab' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a11e7232-734d-4d47-9dda-fc6e757d70a0' class='xr-index-data-in' type='checkbox'/><label for='index-a11e7232-734d-4d47-9dda-fc6e757d70a0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3e9004e0-78f9-455a-a6d3-f38a0fd209e1' class='xr-index-data-in' type='checkbox'/><label for='index-3e9004e0-78f9-455a-a6d3-f38a0fd209e1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
       ...
       350.5, 351.5, 352.5, 353.5, 354.5, 355.5, 356.5, 357.5, 358.5, 359.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2b079075-8cf6-47ac-a391-20267a3086a7' class='xr-index-data-in' type='checkbox'/><label for='index-2b079075-8cf6-47ac-a391-20267a3086a7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-45e7e148-8334-4e4b-8444-2a7d2a1ccb17' class='xr-section-summary-in' type='checkbox'  checked><label for='section-45e7e148-8334-4e4b-8444-2a7d2a1ccb17' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Incoming Solar Flux, Monthly Means</dd><dt><span>standard_name :</span></dt><dd>Incoming Solar Flux</dd><dt><span>CF_name :</span></dt><dd>toa_incoming_shortwave_flux</dd><dt><span>comment :</span></dt><dd>none</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>800.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Let us view the zonal monthly climatology of the TOA incoming solar radiation. To do this, we will average across the longitude bands with the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> method, align the <strong>time</strong> dimension coordinate with the x axis and the <strong>lat</strong> dimension coordinate along the y axis using the method <code class="docutils literal notranslate"><span class="pre">transpose()</span></code>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solar_zonal_clim_month</span> <span class="o">=</span> <span class="n">solar_clim_month</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">solar_zonal_clim_month</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;solar_mon&#x27; (lat: 180, month: 12)&gt; Size: 9kB
dask.array&lt;transpose, shape=(180, 12), dtype=float32, chunksize=(180, 1), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat      (lat) float32 720B -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'solar_mon'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>month</span>: 12</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-911e65b8-d9ed-41bd-8186-a1705d1f5a6a' class='xr-array-in' type='checkbox' checked><label for='section-911e65b8-d9ed-41bd-8186-a1705d1f5a6a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(180, 1), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 8.44 kiB </td>
                        <td> 720 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (180, 12) </td>
                        <td> (180, 1) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 614 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="86" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="36" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="36" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="3" y1="0" x2="3" y2="120" />
  <line x1="6" y1="0" x2="6" y2="120" />
  <line x1="9" y1="0" x2="9" y2="120" />
  <line x1="12" y1="0" x2="12" y2="120" />
  <line x1="15" y1="0" x2="15" y2="120" />
  <line x1="18" y1="0" x2="18" y2="120" />
  <line x1="21" y1="0" x2="21" y2="120" />
  <line x1="24" y1="0" x2="24" y2="120" />
  <line x1="27" y1="0" x2="27" y2="120" />
  <line x1="30" y1="0" x2="30" y2="120" />
  <line x1="33" y1="0" x2="33" y2="120" />
  <line x1="36" y1="0" x2="36" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 36.24782989210401,0.0 36.24782989210401,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.123915" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="56.247830" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,56.247830,60.000000)">180</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-c68c0c2f-67ac-40be-adbf-d5a614a89ad1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c68c0c2f-67ac-40be-adbf-d5a614a89ad1' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-f54ff828-ae8a-4d31-baf9-ff75ed5bd330' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f54ff828-ae8a-4d31-baf9-ff75ed5bd330' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-795c9223-16fd-4e08-ba1d-c5b50a520438' class='xr-var-data-in' type='checkbox'><label for='data-795c9223-16fd-4e08-ba1d-c5b50a520438' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-d97bc80e-0462-434a-b0dd-f9eee9c0df41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d97bc80e-0462-434a-b0dd-f9eee9c0df41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-901601fa-c2db-47cd-b719-5ae6346cb658' class='xr-var-data-in' type='checkbox'><label for='data-901601fa-c2db-47cd-b719-5ae6346cb658' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a82a2b48-a95e-4fdd-9c14-3abf3c0d7871' class='xr-section-summary-in' type='checkbox'  ><label for='section-a82a2b48-a95e-4fdd-9c14-3abf3c0d7871' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bfc19680-39bb-451c-a845-63877166b114' class='xr-index-data-in' type='checkbox'/><label for='index-bfc19680-39bb-451c-a845-63877166b114' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cc13308b-539d-473a-b082-381b20099d6c' class='xr-index-data-in' type='checkbox'/><label for='index-cc13308b-539d-473a-b082-381b20099d6c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6c8e5a4f-a0c4-42ea-9db7-c5fa03ed17aa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6c8e5a4f-a0c4-42ea-9db7-c5fa03ed17aa' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Now we can plot our data. Before we do this however, we define the min, max and step of contours that we will use in a contour plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define contour parameters (min, max and step)</span>
<span class="n">vdiv</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">clevs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">vdiv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude [ $^o$ ]&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Zonally averaged monthly climatology of TIS (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># As the months (12) are much less than the latitudes (180),</span>
<span class="c1"># we need to ensure the plot fits into the size of the figure.</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Plot the data as a contour plot</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
    <span class="n">solar_zonal_clim_month</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
    <span class="n">solar_zonal_clim_month</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
    <span class="n">solar_zonal_clim_month</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="n">clevs</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span>
    <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig4</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_solar_monthly_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/36c09f0f27161d6f0840929870d5b90fa3632f9e58b069f69efed904fae7c581.png" src="../_images/36c09f0f27161d6f0840929870d5b90fa3632f9e58b069f69efed904fae7c581.png" />
</div>
</div>
<p><strong>Figure 4</strong> is a Hovmöller diagram that describes the annual variability of the incoming solar radiation at the top of the atmosphere with latitude over the time period January 2001 to December 2021. It is used in meteorology and for climate studies to show how a variable varies with latitude over time.</p>
<div style="text-align: justify"> The main features discussed in the seasonal climatological distribution of the incoming solar flux are present in this plot. Moreover, we observe the influence of the changes in the sun-Earth's distance and geometry (e.g. solar zenith angle) on the (slightly non-symmetric) distribution of the incoming solar radiation. </div></section>
</section>
<section id="climatology-of-the-top-of-atmosphere-reflected-solar-flux">
<h3>Climatology of the top-of-atmosphere reflected solar flux<a class="headerlink" href="#climatology-of-the-top-of-atmosphere-reflected-solar-flux" title="Permalink to this heading">#</a></h3>
<p>In this section we will analyse the time averaged global and seasonal climatological distributions of the top of the atmosphere (TOA) reflected solar flux (RSF).</p>
<section id="time-averaged-global-climatological-distribution-of-toa-rsf">
<h4>Time averaged global climatological distribution of TOA RSF<a class="headerlink" href="#time-averaged-global-climatological-distribution-of-toa-rsf" title="Permalink to this heading">#</a></h4>
<p>To calculate the mean climatology of the top of the atmosphere reflected solar flux for the time period January 2001 to December 2021, we have to select the specific time range using the Xarray method <code class="docutils literal notranslate"><span class="pre">sel()</span></code> that indexes the data and dimensions by the appropriate indexers. We can then use the method <code class="docutils literal notranslate"><span class="pre">mean()</span></code> to calculate the mean along the time dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the TOA RSF data for the whole time period</span>
<span class="n">toa_sw</span> <span class="o">=</span> <span class="n">da_toa_sw</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Calculate the mean along the time dimension</span>
<span class="n">toa_sw_mean</span> <span class="o">=</span> <span class="n">toa_sw</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now make use of a combination of the plotting libraries <a class="reference external" href="https://matplotlib.org/stable/index.html">Matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">Cartopy</a> to create a customised figure and visualise the time averaged global climatological distribution of the TOA reflected solar flux for the period January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig5</span><span class="p">,</span> <span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_sw_mean</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">toa_sw_mean</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">toa_sw_mean</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Climatology of TOA RSF from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># Add coastlines</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Define gridlines and ticks</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="c1"># Gridlines</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax5</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig5</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_sw_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/243784aebe2572b787e63df57b31b8edd73b94cc3a3eef5d7060994eccd6837d.png" src="../_images/243784aebe2572b787e63df57b31b8edd73b94cc3a3eef5d7060994eccd6837d.png" />
</div>
</div>
<p><strong>Figure 5</strong> shows the global climatology of the top of the atmospohere reflected solar radiation for the time period of January 2001 - December 2021.</p>
<div style="text-align: justify"> The RSF values are the lowest over cloud free ocean areas. The maximum values correspond to high albedo surfaces, such as snow or deserts. Some regions which experience intense convective activity appear as bright areas (central South America, Congo basin and Indonesia). Persistent cloud areas are also clearly visible in this climatology (i.e. the Intertropical Convergence Zone, ITCZ, near the equator, persistent marine stratocumulus clouds around the coast of Namibia and the coast of Peru, for instance). </div></section>
<section id="time-averaged-seasonal-climatological-distribution-of-toa-rsf">
<h4>Time averaged seasonal climatological distribution of TOA RSF<a class="headerlink" href="#time-averaged-seasonal-climatological-distribution-of-toa-rsf" title="Permalink to this heading">#</a></h4>
<p>We now split the TOA RSF data according to the seasons by using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method, with <code class="docutils literal notranslate"><span class="pre">'time.season'</span></code> as an argument, and then average them over the years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split data array toa_sw by season</span>
<span class="n">toa_sw_seasonal_climatology</span> <span class="o">=</span> <span class="n">toa_sw</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of the seasons such as defined in the dataset toa_sw_seasonal_climatology:</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAM&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">]</span>

<span class="c1"># We use the &quot;subplots&quot; to place multiple plots according to our needs. </span>
<span class="c1"># In this case, we want 4 plots in a 2x2 format.</span>
<span class="c1"># For this &quot;nrows&quot; = 2 and &quot;ncols&quot; = 2, the projection and size are defined as well</span>
<span class="n">fig6</span><span class="p">,</span> <span class="n">ax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Define a dictionary of subtitles, each one corresponding to a season</span>
<span class="n">subtitles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span> <span class="s1">&#39;NH spring&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">:</span> <span class="s1">&#39;NH summer&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">:</span> <span class="s1">&#39;NH autumn&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">:</span> <span class="s1">&#39;NH winter&#39;</span><span class="p">}</span>

<span class="c1"># Configure the axes and subplot titles</span>
<span class="k">for</span> <span class="n">i_season</span><span class="p">,</span> <span class="n">c_season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seasons</span><span class="p">):</span>
    <span class="c1"># convert i_season index into (row, col) index</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="c1"># Plot data (coordinates and data) and define colormap</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax6</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_sw_seasonal_climatology</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span>
                                  <span class="n">toa_sw_seasonal_climatology</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                                  <span class="n">toa_sw_seasonal_climatology</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">c_season</span><span class="p">),</span>
                                  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>
    <span class="c1"># Set title and size</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TOA RSF - &#39;</span> <span class="o">+</span> <span class="n">subtitles</span><span class="p">[</span><span class="n">c_season</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Add coastlines</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="c1"># Define grid lines and ticks (e.g. from -180 to 180 in an interval of 60)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
    <span class="c1"># Gridline</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax6</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig6</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig6</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig6</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">fig6</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TOA RSF from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
              <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig6</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">erb_toa_sw_seasonal_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b3bd24818063d60d5bb82ff86ff611a0558e2307a686152f0c192f3bee96c6c9.png" src="../_images/b3bd24818063d60d5bb82ff86ff611a0558e2307a686152f0c192f3bee96c6c9.png" />
</div>
</div>
<p><strong>Figure 6</strong> shows the seasonal mean climatology of the top of the atmosphere reflected solar flux from spring to winter (top left to bottom right panels) derived from CERES EBAF.</p>
<p>The influence of the albedo surfaces on the outgoing shorwave radiation observed in <strong>Figure 6</strong> is confirmed by the seasonal climatology, with much higher values of TOA RSF over snow and ice in the summer Arctic and Antarctic regions.</p>
</section>
<section id="zonally-averaged-montly-mean-climatology-of-toa-rsf">
<h4>Zonally averaged montly mean climatology of TOA RSF<a class="headerlink" href="#zonally-averaged-montly-mean-climatology-of-toa-rsf" title="Permalink to this heading">#</a></h4>
<p>We will now calculate the monthly mean climatology of the outgoing shortwave radiation over the time period January 2001 - December 2021 by first applying the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method to group the data array by month and then calculating the average for each monthly group. The resulting data array is the monthly climatology for the TOA reflected solar radiation based on reference January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toa_sw_clim_month</span> <span class="o">=</span> <span class="n">toa_sw</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Before viewing the zonal monthly climatology of the TOA RSF, we must average across the longitude bands with the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> method, align the <strong>time</strong> dimension coordinate with the x axis and the <strong>lat</strong> dimension coordinate along the y axis using the method <code class="docutils literal notranslate"><span class="pre">transpose()</span></code>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toa_sw_zonal_clim_month</span> <span class="o">=</span> <span class="n">toa_sw_clim_month</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can plot our data. Before we do this however, we define the min, max and step of contours that we will use in a contour plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define contour parameters (min, max and step)</span>
<span class="n">vdiv</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">355</span>
<span class="n">clevs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">vdiv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig7</span><span class="p">,</span> <span class="n">ax7</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude [ $^o$ ]&#39;</span><span class="p">)</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Zonally averaged monthly climatology of TOA RSF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># As the months (12) are much less than the latitudes (180),</span>
<span class="c1"># we need to ensure the plot fits into the size of the figure.</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Plot the data as a contour plot</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax7</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">toa_sw_zonal_clim_month</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                       <span class="n">toa_sw_zonal_clim_month</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                       <span class="n">toa_sw_zonal_clim_month</span><span class="p">,</span>
                       <span class="n">levels</span><span class="o">=</span><span class="n">clevs</span><span class="p">,</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span>
                       <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax7</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig7</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_sw_monthly_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8ae296378e2644631fc729d8c976889e472adacab7e993ae9303831158b4cc81.png" src="../_images/8ae296378e2644631fc729d8c976889e472adacab7e993ae9303831158b4cc81.png" />
</div>
</div>
<p><strong>Figure 7</strong> shows the seasonal variation of the top the atmosphere shortwave flux.</p>
<p>The extreme values are observed over the high latitudes. During the Arctic or Antarctic summer, the highest values of TOA reflected solar flux are observed in these regions because a lot of solar radiation is reflected by high albedo surfaces (snow or ice). During the Arctic or Antarctic winter, the lack of solar radiation induces low TOA SWF values.</p>
</section>
</section>
<section id="climatology-of-the-top-of-atmosphere-outgoing-longwave-radiation">
<h3>Climatology of the top-of-atmosphere outgoing longwave radiation<a class="headerlink" href="#climatology-of-the-top-of-atmosphere-outgoing-longwave-radiation" title="Permalink to this heading">#</a></h3>
<p>In this section we will analyse the time averaged global and seasonal climatological distributions of the top of atmosphere longwave flux, also called outgoing longwave radiation (OLR).</p>
<section id="time-averaged-global-climatological-distribution-of-toa-olr">
<h4>Time averaged global climatological distribution of TOA OLR<a class="headerlink" href="#time-averaged-global-climatological-distribution-of-toa-olr" title="Permalink to this heading">#</a></h4>
<p>To calculate the mean climatology of the TOA outgoing longwave radiation for the period January 2001 to December 2021, we select the specific time range using the Xarray method <code class="docutils literal notranslate"><span class="pre">sel()</span></code> that indexes the data and dimensions by the appropriate indexers. We then use the method <code class="docutils literal notranslate"><span class="pre">mean()</span></code> to calculate the mean along the time dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the OLR data for the whole time period</span>
<span class="n">toa_lw</span> <span class="o">=</span> <span class="n">da_toa_lw</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Calculate the mean along the time dimension</span>
<span class="n">toa_lw_mean</span> <span class="o">=</span> <span class="n">toa_lw</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now make use of a combination of the plotting libraries <a class="reference external" href="https://matplotlib.org/stable/index.html">Matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">Cartopy</a> to visualise the time averaged global climatological distribution of the TOA longwave radiation for the period January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig8</span><span class="p">,</span> <span class="n">ax8</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_lw_mean</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">toa_lw_mean</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">toa_lw_mean</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Climatology of OLR from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># Add coastlines</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Define gridlines and ticks</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">ax8</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="c1"># Gridlines</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax8</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig8</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_lw_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d2fe7cd861b4577513c86d6d839feab564d55c4ca24ab31d4163998f515e1791.png" src="../_images/d2fe7cd861b4577513c86d6d839feab564d55c4ca24ab31d4163998f515e1791.png" />
</div>
</div>
<p><strong>Figure 8</strong> shows the global climatology of the top of the atmosphere outgoing longwave radiation for the time period of January 2001 - December 2021.</p>
<div style="text-align: justify"> The outgoing longwave radiation values are the highest in the tropics and decrease toward the poles. The relative minimum near the equator, in yellow colour, corresponds to the intertropical convergence zone (ITCZ) and the convection areas, where persistent and relatively high cloud cover reduces the LW radiation at the top of the atmosphere. Antarctica is cooler than the corresponding northern latitudes. </div></section>
<section id="time-averaged-seasonal-climatological-distribution-of-toa-olr">
<h4>Time averaged seasonal climatological distribution of TOA OLR<a class="headerlink" href="#time-averaged-seasonal-climatological-distribution-of-toa-olr" title="Permalink to this heading">#</a></h4>
<p>We now split the TOA outgoing longwave radiation data according to the seasons by using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method, with <code class="docutils literal notranslate"><span class="pre">'time.season'</span></code> as an argument; the new data are then averaged over the years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split data array toa_lw by season</span>
<span class="n">toa_lw_seasonal_climatology</span> <span class="o">=</span> <span class="n">toa_lw</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of the seasons such as defined in the dataset toa_lw_seasonal_climatology:</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAM&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">]</span>

<span class="c1"># We use the &quot;subplots&quot; to place multiple plots according to our needs. </span>
<span class="c1"># In this case, we want 4 plots in a 2x2 format.</span>
<span class="c1"># For this &quot;nrows&quot; = 2 and &quot;ncols&quot; = 2, the projection and size are defined as well</span>
<span class="n">fig9</span><span class="p">,</span> <span class="n">ax9</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Define a dictionary of subtitles, each one corresponding to a season</span>
<span class="n">subtitles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span> <span class="s1">&#39;NH spring&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">:</span> <span class="s1">&#39;NH summer&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">:</span> <span class="s1">&#39;NH autumn&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">:</span> <span class="s1">&#39;NH winter&#39;</span><span class="p">}</span>

<span class="c1"># Configure the axes and subplot titles</span>
<span class="k">for</span> <span class="n">i_season</span><span class="p">,</span> <span class="n">c_season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seasons</span><span class="p">):</span>
    <span class="c1"># convert i_season index into (row, col) index</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="c1"># Plot data (coordinates and data) and define colormap</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax9</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_lw_seasonal_climatology</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span>
                                  <span class="n">toa_lw_seasonal_climatology</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                                  <span class="n">toa_lw_seasonal_climatology</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">c_season</span><span class="p">),</span>
                                  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>
    <span class="c1"># Set title and size</span>
    <span class="n">ax9</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TOA LWF - &#39;</span> <span class="o">+</span> <span class="n">subtitles</span><span class="p">[</span><span class="n">c_season</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Add coastlines</span>
    <span class="n">ax9</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="c1"># Define grid lines and ticks (e.g. from -180 to 180 in an interval of 60)</span>
    <span class="n">ax9</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
    <span class="n">ax9</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
    <span class="c1"># Gridline</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax9</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig9</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig9</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig9</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">fig9</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of OLR from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
              <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig9</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_lw_seasonal_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/010c232c38fa9422ff77f71b320c82a87b40fbcdc0635291f6ac6c5a00cb57df.png" src="../_images/010c232c38fa9422ff77f71b320c82a87b40fbcdc0635291f6ac6c5a00cb57df.png" />
</div>
</div>
<p><strong>Figure 9</strong> shows the seasonal mean climatology of the outgoing longwave flux from spring to winter (top left to bottom right panels) derived from CERES EBAF.</p>
<p>The general pattern is overall the same as in <strong>Figure 8</strong> with higher values of outgoing longwave flux in the tropics and lower values in the high latitude, especially during winter. The relatively low values of OLR corresponding to high convection areas are also very well observed in the tropical summer.</p>
</section>
<section id="inter-annual-variability-of-toa-olr">
<h4>Inter-annual variability of TOA OLR<a class="headerlink" href="#inter-annual-variability-of-toa-olr" title="Permalink to this heading">#</a></h4>
<p>We can now analyse the inter-annual variability of the outgoing longwave radiation at the top of the atmopshere. It is defined as the root mean square of the inter-annual anomaly in the TOA OLR.</p>
<p>First, we apply the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method to group the data array by year and calculate the time-averaged TOA OLR for each year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the global time-averaged distribution of TOA OLR for each year</span>
<span class="n">toa_lw_clim_year</span> <span class="o">=</span> <span class="n">toa_lw</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we compute the inter-annual anomaly by subtracting the global mean climatology from the the group of 21 years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the inter-annual anomaly of TOA OLR</span>
<span class="n">toa_lw_anomaly</span> <span class="o">=</span> <span class="n">toa_lw_clim_year</span> <span class="o">-</span> <span class="n">toa_lw_mean</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, the inter-annual variability of TOA OLR is obtained by computing the standard deviation of the anomaly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the inter-annual variability of TOA OLR</span>
<span class="n">toa_lw_interannual_variability</span> <span class="o">=</span> <span class="n">toa_lw_anomaly</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig10</span><span class="p">,</span> <span class="n">ax10</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_lw_interannual_variability</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span>
                    <span class="n">toa_lw_interannual_variability</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                    <span class="n">toa_lw_interannual_variability</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">)</span>

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Interannual variability of TOA OLR from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># Add coastlines</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Define gridlines and ticks</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">ax10</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="c1"># Gridlines</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax10</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig10</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_lw_interannual_variability.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/81a70a02bcb44511be7b93e3389bb6a3304f8f36470a8a5a228091757787cc3e.png" src="../_images/81a70a02bcb44511be7b93e3389bb6a3304f8f36470a8a5a228091757787cc3e.png" />
</div>
</div>
<p><strong>Figure 10</strong> shows that the main variability occurs in the convective regions, in particular, in the Monsoon regions and along the Pacific Basin, following “El Niño” and “La Niña” oscillations.</p>
</section>
<section id="zonally-averaged-montly-mean-climatology-of-toa-olr">
<h4>Zonally averaged montly mean climatology of TOA OLR<a class="headerlink" href="#zonally-averaged-montly-mean-climatology-of-toa-olr" title="Permalink to this heading">#</a></h4>
<p>We will now calculate the monthly mean climatology of the outgoing longwave radiation over the time period January 2001 - December 2021 by first applying the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method to group the data array by month and then calculating the average for each monthly group. The resulting data array is the monthly climatology for the total column water vapour based on reference January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toa_lw_clim_month</span> <span class="o">=</span> <span class="n">toa_lw</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Before viewing the zonal monthly climatology of the OLR, let us average across the longitude bands with the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> method, align the <strong>time</strong> dimension coordinate with the x axis and the <strong>lat</strong> dimension coordinate along the y axis by using the method <code class="docutils literal notranslate"><span class="pre">transpose()</span></code>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toa_lw_zonal_clim_month</span> <span class="o">=</span> <span class="n">toa_lw_clim_month</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can plot our data. Before we do this however, we define the min, max and step of contours that we will use in a contour plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define contour parameters (min, max and step)</span>
<span class="n">vdiv</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">clevs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">vdiv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig11</span><span class="p">,</span> <span class="n">ax11</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude [ $^o$ ]&#39;</span><span class="p">)</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Zonally averaged monthly climatology of OLR (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># As the months (12) are much less than the latitudes (180),</span>
<span class="c1"># we need to ensure the plot fits into the size of the figure.</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Plot the data as a contour plot</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax11</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">toa_lw_zonal_clim_month</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                        <span class="n">toa_lw_zonal_clim_month</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                        <span class="n">toa_lw_zonal_clim_month</span><span class="p">,</span>
                        <span class="n">levels</span><span class="o">=</span><span class="n">clevs</span><span class="p">,</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span>
                        <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax11</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$]&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig11</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_lw_monthly_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cb4a18eb8b519516e89db4b873f337622670c5bc8325f046fa15bf3ec68c6ab9.png" src="../_images/cb4a18eb8b519516e89db4b873f337622670c5bc8325f046fa15bf3ec68c6ab9.png" />
</div>
</div>
<p><strong>Figure 11</strong> shows the seasonal variation of the top of the atmosphere longwave flux.</p>
<p>The lowest values of the outgoing longwave flux are observed over the coldest surfaces corresponding to the high latitude winter. Two bands of high values over the tropics separated by relatively low values near the equator (corresponding to the ITCZ) oscillate and reach a maximum near the equator in the winter hemisphere, confirming the influence of (relatively) low convection and incoming solar radiation (high surface temperatures) on the OLF.</p>
</section>
</section>
<section id="climatology-of-the-top-of-atmosphere-net-earth-s-radiation-budget">
<h3>Climatology of the top-of-atmosphere net Earth’s radiation budget<a class="headerlink" href="#climatology-of-the-top-of-atmosphere-net-earth-s-radiation-budget" title="Permalink to this heading">#</a></h3>
<p>In this section we will analyse the time averaged global and seasonal climatological distributions of the net Earth’s radiative budget (or net radiative flux). It is defined as the balance between the incoming (solar) and outgoing (solar reflelcted and Earth emitted) energy at the top of the atmospohere.</p>
<section id="time-averaged-global-climatological-distribution-of-toa-net-erb">
<h4>Time averaged global climatological distribution of TOA net ERB<a class="headerlink" href="#time-averaged-global-climatological-distribution-of-toa-net-erb" title="Permalink to this heading">#</a></h4>
<p>To calculate the mean climatology of the net radiative flux at the the top of the atmosphere, we just have to compute the difference between the time averaged incoming solar flux and the sum of shortwave (solar reflected) and longwave (Earth emitted) fluxes at the top of the atmposphere for the period January 2001 to December 2021. All the variables have been computed in the previous sections.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean climatology of the net radiation at the top of the atmosphere</span>
<span class="n">toa_erb_mean</span> <span class="o">=</span> <span class="n">solar_mean</span> <span class="o">-</span> <span class="n">toa_sw_mean</span> <span class="o">-</span> <span class="n">toa_lw_mean</span>
</pre></div>
</div>
</div>
</div>
<p>We now make use of a combination of the plotting libraries <a class="reference external" href="https://matplotlib.org/stable/index.html">Matplotlib</a> and <a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">Cartopy</a> to visualize the time averaged global climatological distribution of the TOA net radiative flux for the period January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig12</span><span class="p">,</span> <span class="n">ax12</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_erb_mean</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">toa_erb_mean</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">toa_erb_mean</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Climatology of TOA net ERB from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># Add coastlines</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Define gridlines and ticks</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">ax12</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="c1"># Gridlines</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax12</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig12</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_erb_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d1fcdd8fc8c4f4a6107c80137cb80a3057528dbf76c012be04a8a52b60230de9.png" src="../_images/d1fcdd8fc8c4f4a6107c80137cb80a3057528dbf76c012be04a8a52b60230de9.png" />
</div>
</div>
<p><strong>Figure 12</strong> shows the global climatology of the (net) Earth’s radiation budget at the top of the atmosphere for the time period of January 2001 - December 2021.</p>
<p>In general, the net radiation is positive (energy surplus) in the tropical areas (shown in red) and negative (energy deficit) in high latitudes (in blue). However, in some of the desert regions the TOA net ERB becomes negative due to the combined high values of albedo and OLR (Sahara desert or Arabic peninsula for instance). Areas in which incoming radiation balances the outgoing are in white.</p>
</section>
<section id="time-averaged-seasonal-climatological-distribution-of-toa-erb">
<h4>Time averaged seasonal climatological distribution of TOA ERB<a class="headerlink" href="#time-averaged-seasonal-climatological-distribution-of-toa-erb" title="Permalink to this heading">#</a></h4>
<p>To compute the time averaged seasonal climatological distribution of TOA net ERB, the data are splitted according to the seasons by using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method, with <code class="docutils literal notranslate"><span class="pre">'time.season'</span></code> as an argument, and then averaged over the years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the TOA ERB data for the whole time period</span>
<span class="n">toa_erb</span> <span class="o">=</span> <span class="n">da_toa_erb</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Split data array TOA ERB by season</span>
<span class="n">toa_erb_seasonal_climatology</span> <span class="o">=</span> <span class="n">toa_erb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of the seasons such as defined in the dataset toa_erb_seasonal_climatology:</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAM&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">]</span>

<span class="c1"># We use the &quot;subplots&quot; to place multiple plots according to our needs. </span>
<span class="c1"># In this case, we want 4 plots in a 2x2 format.</span>
<span class="c1"># For this &quot;nrows&quot; = 2 and &quot;ncols&quot; = 2, the projection and size are defined as well</span>
<span class="n">fig13</span><span class="p">,</span> <span class="n">ax13</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                           <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Define a dictionary of subtitles, each one corresponding to a season</span>
<span class="n">subtitles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span> <span class="s1">&#39;NH spring&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">:</span> <span class="s1">&#39;NH summer&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">:</span> <span class="s1">&#39;NH autumn&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">:</span> <span class="s1">&#39;NH winter&#39;</span><span class="p">}</span>

<span class="c1"># Configure the axes and subplot titles</span>
<span class="k">for</span> <span class="n">i_season</span><span class="p">,</span> <span class="n">c_season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seasons</span><span class="p">):</span>
    <span class="c1"># convert i_season index into (row, col) index</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">i_season</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="c1"># Plot data (coordinates and data) and define colormap</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax13</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">toa_erb_seasonal_climatology</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span>
                                   <span class="n">toa_erb_seasonal_climatology</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                                   <span class="n">toa_erb_seasonal_climatology</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">c_season</span><span class="p">),</span>
                                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
    <span class="c1"># Set title and size</span>
    <span class="n">ax13</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TOA ERB - &#39;</span> <span class="o">+</span> <span class="n">subtitles</span><span class="p">[</span><span class="n">c_season</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="c1"># Add coastlines</span>
    <span class="n">ax13</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="c1"># Define grid lines and ticks (e.g. from -180 to 180 in an interval of 60)</span>
    <span class="n">ax13</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
    <span class="n">ax13</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
    <span class="c1"># Gridline</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax13</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig13</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig13</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig13</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">fig13</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Seasonal climatology of TOA net ERB from CERES EBAF (January 2001 - December 2021)&#39;</span><span class="p">,</span>
               <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig13</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_erb_seasonal_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/124ab78e68dce8cb64ea782e89a67f0d60c8edf6b87f3fea1b153a3f36d25041.png" src="../_images/124ab78e68dce8cb64ea782e89a67f0d60c8edf6b87f3fea1b153a3f36d25041.png" />
</div>
</div>
<p><strong>Figure 13</strong> shows the seasonal mean climatology of the TOA net radiation from spring to winter (top left to bottom right panels) derived from CERES EBAF.</p>
<p>The general pattern exhibits negative values of TOA net ERB in the high latitudes and a band of positive values that oscillates (between 60° N/S) around the equator, reaching a maximum in the summer hemisphere (except for high albedo regions such as Sahara desert and the Arabic Peninsula). It confirms the dominant effect of solar radiation on the net Earth’s radiation budget. In the high latitudes of the summer hemisphere, because of the high surface (snow, ice) albedo, the reflected solar radiation compensates the incident solar radiation.</p>
</section>
<section id="zonally-averaged-montly-mean-climatology-of-toa-net-erb">
<h4>Zonally averaged montly mean climatology of TOA net ERB<a class="headerlink" href="#zonally-averaged-montly-mean-climatology-of-toa-net-erb" title="Permalink to this heading">#</a></h4>
<p>We will now calculate the monthly mean climatology of TOA net radiative flux over the period January 2001 - December 2021 by first applying the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method to group the data array by month and then calculating the average for each monthly group. The resulting data array is the monthly climatology for the TOA ERB based on reference January 2001 - December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toa_erb_clim_month</span> <span class="o">=</span> <span class="n">toa_erb</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Before viewing the zonal monthly climatology of the TOA ERB, we average across the longitude bands with the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> method and align the <strong>time</strong> dimension coordinate with the x axis and the <strong>lat</strong> dimension coordinate along the y axis using the method <code class="docutils literal notranslate"><span class="pre">transpose()</span></code>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toa_erb_zonal_clim_month</span> <span class="o">=</span> <span class="n">toa_erb_clim_month</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can plot our data. Before we do this however, we define the min, max and step of contours that we will use in a contour plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define contour parameters (min, max and step)</span>
<span class="n">vdiv</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">clevs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">vdiv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig14</span><span class="p">,</span> <span class="n">ax14</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax14</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">ax14</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude [ $^o$ ]&#39;</span><span class="p">)</span>
<span class="n">ax14</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;Zonally averaged monthly climatology of TOA net ERB (January 2001 - December 2021)&#39;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># As the months (12) are much less than the latitudes (180),</span>
<span class="c1"># we need to ensure the plot fits into the size of the figure.</span>
<span class="n">ax14</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Plot the data as a contour plot</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax14</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">toa_erb_zonal_clim_month</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                        <span class="n">toa_erb_zonal_clim_month</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                        <span class="n">toa_erb_zonal_clim_month</span><span class="p">,</span>
                        <span class="n">levels</span><span class="o">=</span><span class="n">clevs</span><span class="p">,</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
                        <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax14</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax14</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="c1"># Specify the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig14</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_erb_monthly_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3eedddf9cc82efbe452034827919780a816255f6065d461a2dd67a7fd6359740.png" src="../_images/3eedddf9cc82efbe452034827919780a816255f6065d461a2dd67a7fd6359740.png" />
</div>
</div>
<p><strong>Figure 14</strong> shows the seasonal variation of the top of atmosphere net Earth’s radiation budget.</p>
<p>The general pattern of the Hovmöller diagram is overall the same as the seasonal climatological distribution (<strong>Figure 13</strong>), exhibiting the oscillation of the band of positive values of TOA net ERB around the equator that reaches a maximum in the summer tropics. This confirms the dominant effect of the solar radiation and the equator-versus-pole energy imbalance which is the main driver of atmospheric and oceanic circulations.</p>
<p>Modifications in the globally averaged net radiation flux are a good indicator of climate change since if this average is not close to zero it will imply an increase or decrease of the average temperature of the globe. In the next use case, we will therefore analyse the temporal evolution of the Earth’s radiation budget and its annual seasonal variation.</p>
</section>
</section>
</section>
<section id="time-series-and-trend-analysis-of-the-earth-s-radiation-budget">
<h2>Time series and trend analysis of the Earth’s Radiation Budget<a class="headerlink" href="#time-series-and-trend-analysis-of-the-earth-s-radiation-budget" title="Permalink to this heading">#</a></h2>
<p>After looking at the time averaged global distribution of the Earth’s radiation budget, we further investigate the dataset. The CERES-EBAF product spans over 20 years of satellite observations, and another useful way of analysing and visualizing the temporal evolution of total column water vapour is using the time series. We will calculate global time series, plot it, and discuss most important features.</p>
<p>We first create a temporal subset for the time period January 2001 to December 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select time period for the incoming shortwave radiation data array</span>
<span class="n">ceres_solar</span> <span class="o">=</span> <span class="n">da_solar</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Select time period for the outgoing shortwave radiation data array</span>
<span class="n">ceres_toa_sw</span> <span class="o">=</span> <span class="n">da_toa_sw</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Select time period for the outgoing longwave radiation data array</span>
<span class="n">ceres_toa_lw</span> <span class="o">=</span> <span class="n">da_toa_lw</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>

<span class="c1"># Compute the net radiative flux for the selected time period</span>
<span class="n">ceres_toa_erb</span> <span class="o">=</span> <span class="n">ceres_solar</span> <span class="o">-</span> <span class="n">ceres_toa_sw</span> <span class="o">-</span> <span class="n">ceres_toa_lw</span>
</pre></div>
</div>
</div>
</div>
<section id="spatial-aggregation">
<h3>Spatial aggregation<a class="headerlink" href="#spatial-aggregation" title="Permalink to this heading">#</a></h3>
<p>We would like to visualise these data, not in maps but as one dimensional time series of global average values. To do this, we will first need to aggregate the data spatially to create a single global average at each time step. In order to aggregate over the latitudinal dimension, we need to take into account the variation in area as a function of latitude. We will do this by using the cosine of the latitude as a proxy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define weights as the cosine of latitudes</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ceres_solar</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>

<span class="c1"># Spatial aggregation of CERES-EBAF incident solar flux</span>
<span class="n">ceres_solar_weighted</span> <span class="o">=</span> <span class="n">ceres_solar</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># Spatial aggregation of CERES-EBAF reflected solar flux</span>
<span class="n">ceres_toa_sw_weighted</span> <span class="o">=</span> <span class="n">ceres_toa_sw</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># Spatial aggregation of CERES-EBAF Earth emitted longwave flux</span>
<span class="n">ceres_toa_lw_weighted</span> <span class="o">=</span> <span class="n">ceres_toa_lw</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># Spatial agregation of CERES-EBAF net radiative flux</span>
<span class="n">ceres_toa_erb_weighted</span> <span class="o">=</span> <span class="n">ceres_toa_erb</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The next step is to compute the mean across the latitude and longitude dimensions of the weighted data array with the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Weighted mean of CERES-EBAF incident solar flux</span>
<span class="n">ceres_solar_wmean</span> <span class="o">=</span> <span class="n">ceres_solar_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>

<span class="c1"># Weighted mean of CERES-EBAF reflected solar flux</span>
<span class="n">ceres_toa_sw_wmean</span> <span class="o">=</span> <span class="n">ceres_toa_sw_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>

<span class="c1"># Weighted mean of CERES-EBAF Earth emitted longwave flux</span>
<span class="n">ceres_toa_lw_wmean</span> <span class="o">=</span> <span class="n">ceres_toa_lw_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>

<span class="c1"># Weighted mean of CERES net radiative flux</span>
<span class="n">ceres_toa_erb_wmean</span> <span class="o">=</span> <span class="n">ceres_toa_erb_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-series-and-trend-analysis-of-the-top-of-atmosphere-incoming-solar-radiation">
<h3>Time series and trend analysis of the top-of-atmosphere incoming solar radiation<a class="headerlink" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-incoming-solar-radiation" title="Permalink to this heading">#</a></h3>
<section id="global-time-series-of-tis">
<h4>Global time series of TIS<a class="headerlink" href="#global-time-series-of-tis" title="Permalink to this heading">#</a></h4>
<p>Now we can plot the time series of globally averaged TIS data over time using the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig15</span><span class="p">,</span> <span class="n">ax15</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax15</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax15</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>
<span class="n">ax15</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax15</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Global time series of TIS from CERES EBAF&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">ax15</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ceres_solar_wmean</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ceres_solar_wmean</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig15</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_isf_global_timeseries.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d9a744da0fe186c460a2fb22916ff88bfde3d0dcffc7e06218d1043cd14619be.png" src="../_images/d9a744da0fe186c460a2fb22916ff88bfde3d0dcffc7e06218d1043cd14619be.png" />
</div>
</div>
<p><strong>Figure 15</strong> shows the time series of the incoming solar flux at the top of the atmosphere.</p>
<p>From the time series, we can infer a clear seasonal cycle with an amplitude of over 20 W/m<span class="math notranslate nohighlight">\(^{2}\)</span> in the global space and time averaged TSI, associated to the Earth’s orbit around the sun. Another very slight long-term seasonal trend is also noticeable, that corresponds to the sunspot cycle. The Earth and solar seasonal cycles will now be studied in more details by the seasonal decomposition of the incoming solar flux.</p>
</section>
<section id="trend-analysis-and-seasonal-cycle-of-tis">
<h4>Trend analysis and seasonal cycle of TIS<a class="headerlink" href="#trend-analysis-and-seasonal-cycle-of-tis" title="Permalink to this heading">#</a></h4>
<p>The time series can be further analysed by extracting the trend, or the running annual mean, and the seasonal cycle.</p>
<p>To this end, we will convert the Xarray Data Array into a time series with the <a class="reference external" href="https://pandas.pydata.org/">pandas</a> library before decomposing it into the trend, the seasonal cycle and the residuals by using the <code class="docutils literal notranslate"><span class="pre">seasonal_decompose()</span></code> method and visualizing the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the Xarray data array ceres_solar_wmean into a time series</span>
<span class="n">ceres_solar_wmean_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ceres_solar_wmean</span><span class="p">)</span>
<span class="c1"># Define the time dimension of ceres_solar_weighted_mean as the index of the time series</span>
<span class="n">ceres_solar_wmean_series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ceres_solar_wmean</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Decomposition of the time series into the trend, the seasonal cycle and the residuals</span>
<span class="n">ceres_solar_seasonal_decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ceres_solar_wmean_series</span><span class="p">,</span>
                                                        <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span>
                                                        <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot the resulting seasonal decomposition</span>
<span class="n">fig16</span> <span class="o">=</span> <span class="n">ceres_solar_seasonal_decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig16</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">fig16</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_solar_timeseries_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c3ad7fed5b186c32814121a4b70ae3b60e3a2621c1538be10828db3a92a8a99f.png" src="../_images/c3ad7fed5b186c32814121a4b70ae3b60e3a2621c1538be10828db3a92a8a99f.png" />
</div>
</div>
<p><strong>Figure 16</strong> shows the decomposition of the TIS time series into the trend corresponding to the sunspot cycle (2nd panel), and the seasonal cycle with the confirmed amplitude of 20 W.m⁻² (3rd panel), from which are derived the anomalies or de-trended and de-seasonalised time series that have the characteristics of an uncorrelated noise pattern (4th panel).</p>
</section>
</section>
<section id="time-series-and-trend-analysis-of-the-top-of-atmosphere-reflected-solar-flux">
<h3>Time series and trend analysis of the top-of-atmosphere reflected solar flux<a class="headerlink" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-reflected-solar-flux" title="Permalink to this heading">#</a></h3>
<section id="global-time-series-of-toa-rsf">
<h4>Global time series of TOA RSF<a class="headerlink" href="#global-time-series-of-toa-rsf" title="Permalink to this heading">#</a></h4>
<p>We will now plot the time series of globally averaged TOA RSF data over time using the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig17</span><span class="p">,</span> <span class="n">ax17</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax17</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax17</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>
<span class="n">ax17</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax17</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Global time series of TOA RSF from CERES EBAF&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">ax17</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ceres_toa_sw_wmean</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ceres_toa_sw_wmean</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig17</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_sw_global_timeseries.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bc029f731035433c6429307ba9a398a6cc301a31e8b790da034ef18dd1846d15.png" src="../_images/bc029f731035433c6429307ba9a398a6cc301a31e8b790da034ef18dd1846d15.png" />
</div>
</div>
<p><strong>Figure 17</strong> shows the time series of the reflected solar flux at the top of the atmosphere.</p>
<p>From the time series of the global space and time averaged RSF, we can infer a clear seasonal cycle associated to the Earth’s orbit around the sun and a long-term seasonal cycle corresponding to the sunspot cycle together with a negative trend. They will now be further examined through the seasonal decomposition of the incoming solar flux.</p>
</section>
<section id="trend-analysis-and-seasonal-cycle-of-toa-rsf">
<h4>Trend analysis and seasonal cycle of TOA RSF<a class="headerlink" href="#trend-analysis-and-seasonal-cycle-of-toa-rsf" title="Permalink to this heading">#</a></h4>
<p>The time series can be further analysed by extracting the trend, or the running annual mean, and the seasonal cycle.</p>
<p>To this end, we will convert the Xarray Data Array into a time series with the <a class="reference external" href="https://pandas.pydata.org/">pandas</a> library before decomposing it into the trend, the seasonal cycle and the residuals by using the <code class="docutils literal notranslate"><span class="pre">seasonal_decompose()</span></code> method and visualizing the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the Xarray data array ceres_toa_sw_wmean into a time series</span>
<span class="n">ceres_toa_sw_wmean_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ceres_toa_sw_wmean</span><span class="p">)</span>
<span class="c1"># Define the time dimension of ceres_toa_sw_wmean as the index of the time series</span>
<span class="n">ceres_toa_sw_wmean_series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ceres_toa_sw_wmean</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Decomposition of the time series into the trend, the seasonal cycle and the residuals</span>
<span class="n">ceres_toa_sw_seasonal_decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ceres_toa_sw_wmean_series</span><span class="p">,</span>
                                                         <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span>
                                                         <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot the resulting seasonal decomposition</span>
<span class="n">fig18</span> <span class="o">=</span> <span class="n">ceres_toa_sw_seasonal_decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig18</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">fig18</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_sw_timeseries_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/08d5c200ca39d1c77d6eb0d4a9b9d810223537345f54e75ccae964143061d046.png" src="../_images/08d5c200ca39d1c77d6eb0d4a9b9d810223537345f54e75ccae964143061d046.png" />
</div>
</div>
<p><strong>Figure 18</strong> shows the decomposition of the TOA RSF time series into a negative trend of ~-0.1 W.m⁻².year⁻¹ (2nd panel) and a seasonal cycle with an amplitude of ~15 W.m⁻² (3rd panel), from which are derived the anomalies that have the characteristics of an uncorrelated noise pattern (4th panel).</p>
<p>As explained earlier (see the climatologcal distribution of the TOA RSF), the minimum values of the reflected solar flux are found over cloud free ocean areas and the maximum values over high albedo surfaces, such as snow or deserts. The negative trend can thus be due to a loss of snow and ice, especially in the Arctic and Antarctic regions.</p>
</section>
</section>
<section id="time-series-and-trend-analysis-of-the-top-of-atmosphere-outgoing-longwave-radiation">
<h3>Time series and trend analysis of the top-of-atmosphere outgoing longwave radiation<a class="headerlink" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-outgoing-longwave-radiation" title="Permalink to this heading">#</a></h3>
<section id="global-time-series-of-toa-olr">
<h4>Global time series of TOA OLR<a class="headerlink" href="#global-time-series-of-toa-olr" title="Permalink to this heading">#</a></h4>
<p>We will now plot the time series of globally averaged outgoing longwave radiation data over time using the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig19</span><span class="p">,</span> <span class="n">ax19</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax19</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax19</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>
<span class="n">ax19</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax19</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Global time series of OLR from CERES EBAF&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">ax19</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ceres_toa_lw_wmean</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ceres_toa_lw_wmean</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig19</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_lw_global_timeseries.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f9548c5e68a52d3cfbc9f1fa3c0020a3745e82561c825eb8e20cc8da9ddf7f20.png" src="../_images/f9548c5e68a52d3cfbc9f1fa3c0020a3745e82561c825eb8e20cc8da9ddf7f20.png" />
</div>
</div>
<p><strong>Figure 19</strong> shows the time series of the outgoing longwave radiation at the top of the atmosphere. From the time series, we can infer a seasonal pattern along with a trend in the global space and time averaged TOA OLR.</p>
<p>We will now procede to the seasonal decomposition of the Earth-emitted longwave radiation at the top of the atmosphere and analyse more specifically the trend and seasonal cycle of CERES-EBAF OLR.</p>
</section>
<section id="trend-analysis-and-seasonal-cycle-of-toa-olr">
<h4>Trend analysis and seasonal cycle of TOA OLR<a class="headerlink" href="#trend-analysis-and-seasonal-cycle-of-toa-olr" title="Permalink to this heading">#</a></h4>
<p>The time series can be further analysed by extracting the trend, or the running annual mean, and the seasonal cycle.</p>
<p>To this end, we will convert the Xarray Data Array into a time series with the <a class="reference external" href="https://pandas.pydata.org/">pandas</a> library before decomposing it into the trend, the seasonal cycle and the residuals by using the <code class="docutils literal notranslate"><span class="pre">seasonal_decompose()</span></code> method and visualizing the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the Xarray data array ceres_toa_lw_wmean into a time series</span>
<span class="n">ceres_toa_lw_wmean_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ceres_toa_lw_wmean</span><span class="p">)</span>
<span class="c1"># Define the time dimension of ceres_toa_lw_wmean as the index of the time series</span>
<span class="n">ceres_toa_lw_wmean_series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ceres_toa_lw_wmean</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Decomposition of the time series into the trend, the seasonal cycle and the residuals</span>
<span class="n">ceres_toa_lw_seasonal_decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ceres_toa_lw_wmean_series</span><span class="p">,</span>
                                                         <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span>
                                                         <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot the resulting seasonal decomposition</span>
<span class="n">fig20</span> <span class="o">=</span> <span class="n">ceres_toa_lw_seasonal_decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig20</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">fig20</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_lw_timeseries_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04ed10e6fdbc91b211eca4fe5fde247f9a16481c9c94dd74a48d1fa8576d7ecc.png" src="../_images/04ed10e6fdbc91b211eca4fe5fde247f9a16481c9c94dd74a48d1fa8576d7ecc.png" />
</div>
</div>
<p><strong>Figure 20</strong> shows the decomposition of the outgoing lonwave radiation time series into a positive trend of ~0.05 W.m⁻².year⁻¹(2nd panel), and a seasonal cycle with an amplitude of ~8 W.m⁻² (3rd panel), from which are derived the anomalies that have the characteristics of uncorrelated noise pattern (4th panel).</p>
<p>The observed inter-annual variations in the 2nd panel of <strong>Figure 20</strong> suggest an influence of the “El Niño” or “La Niña” Southern Oscillation on the TOA OLR. The increase in this Earth-emitted longwave radiation is clearly related to the increase of surface temperatures.</p>
</section>
</section>
<section id="time-series-and-trend-analysis-of-the-top-of-atmosphere-net-earth-s-radiation-budget">
<h3>Time series and trend analysis of the top-of-atmosphere net Earth’s radiation budget<a class="headerlink" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-net-earth-s-radiation-budget" title="Permalink to this heading">#</a></h3>
<section id="global-time-series-of-toa-net-erb">
<h4>Global time series of TOA net ERB<a class="headerlink" href="#global-time-series-of-toa-net-erb" title="Permalink to this heading">#</a></h4>
<p>We will now plot the time series of the globally averaged TOA net Earth’s radiative flux over time using the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the figure and specify size</span>
<span class="n">fig21</span><span class="p">,</span> <span class="n">ax21</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Configure the axes and figure title</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W.m$^{-2}$&#39;</span><span class="p">)</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Global time series of TOA net ERB from CERES EBAF&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">ax21</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ceres_toa_erb_wmean</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ceres_toa_erb_wmean</span><span class="p">)</span>

<span class="c1"># Save the figure</span>
<span class="n">fig21</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_erb_global_timeseries.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c07288f9ec5ba618089e9c08dfd3145c0f939c865fdde4b4632d36b9420b6874.png" src="../_images/c07288f9ec5ba618089e9c08dfd3145c0f939c865fdde4b4632d36b9420b6874.png" />
</div>
</div>
<p><strong>Figure 21</strong> shows the time series of the net Earth’s radiation budget at the top of the atmosphere. From the time series, we can infer a seasonal pattern together with a slightly increasing trend in the global space and time averaged TOA net ERB.</p>
<div style="text-align: justify"> Since CERES EBAF is a stable and robust product which has been validated with other data, this trend can be assumed to be a real climatological variability in the net Earth's radiation flux at the top of the atmosphere. </div><div style="text-align: justify"> We will now procede to the seasonal decomposition of the net Earth's radiation budget and analyse more specifically the trend and seasonal cycle of the TOA net ERB. </div></section>
<section id="trend-analysis-and-seasonal-cycle-of-toa-net-erb">
<h4>Trend analysis and seasonal cycle of TOA net ERB<a class="headerlink" href="#trend-analysis-and-seasonal-cycle-of-toa-net-erb" title="Permalink to this heading">#</a></h4>
<br>
The time series can be further analysed by extracting the trend, or the running annual mean, and the seasonal cycle.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the Xarray data array ceres_toa_erb_wmean into a time series</span>
<span class="n">ceres_toa_erb_wmean_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ceres_toa_erb_wmean</span><span class="p">)</span>
<span class="c1"># Define the time dimension of ceres_toa_sw_wmean as the index of the time series</span>
<span class="n">ceres_toa_erb_wmean_series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ceres_toa_erb_wmean</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Decomposition of the time series into the trend, the seasonal cycle and the residuals</span>
<span class="n">ceres_toa_erb_seasonal_decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">ceres_toa_erb_wmean_series</span><span class="p">,</span>
                                                          <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span>
                                                          <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot the resulting seasonal decomposition</span>
<span class="n">fig22</span> <span class="o">=</span> <span class="n">ceres_toa_erb_seasonal_decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">fig22</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">fig22</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">ceres_toa_erb_timeseries_climatology.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6210893356fd51aece99550c0adfe17adeb86e6bbb16549d64beb8b96d505653.png" src="../_images/6210893356fd51aece99550c0adfe17adeb86e6bbb16549d64beb8b96d505653.png" />
</div>
</div>
<p><strong>Figure 22</strong> shows the decomposition of the CERES-EBAF TOA net ERB time series into a positive trend of ~0.05 W.m⁻².year⁻¹ (2nd panel), and a seasonal cycle with an amplitude of ~20 W.m⁻² (3rd panel), from which are derived the anomalies that have the characteristics of uncorrelated noise pattern (4th panel).</p>
<p>The trend analysis presents an oscilation around the year 2010 that can be related to a moderate “El Niño” event in this time period. The positive trend of the net Earth’s radiative flux confirms global warming.</p>
</section>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>In this notebook we have provided use cases, based on the Cloud and Earth’s Radiant Energy System (CERES) Energy Balanced And Filled (EBAF) Earth’s radiation budget (ERB) data record, to illustrate the way this dataset can be used to study, analyse and visualise this essential climate variable. The current dataset indicates a clear increase of the net Earth’s radiative flux between January 2001 and December 2021. Comparisons with other independent datasets can be made to further investigate the trends that can be attributed to global warming, El-Niño events and external solar cycle forcing.</p>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading">#</a></h2>
<p>Clean up your directory of the netCDF files you unzipped.</p>
<p>You can set the <code class="docutils literal notranslate"><span class="pre">save_merged_netcdf</span></code> flag to <code class="docutils literal notranslate"><span class="pre">True</span></code> (and choose a filename)
if you want to merge the data into a single netcdf before closing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Flag to save the merged netCDF file</span>
<span class="n">save_merged_netcdf</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># Filename for the netCDF file which contains the merged contents of the monthly files.</span>
<span class="n">merged_netcdf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATADIR</span><span class="p">,</span> <span class="s1">&#39;ceres-erb-monthly.nc&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">save_merged_netcdf</span><span class="p">:</span>
    <span class="n">ds_ceres</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">merged_netcdf_file</span><span class="p">)</span>

<span class="c1"># Recursively delete unpacked data</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filelist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ecv-notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="erb-clara-climatology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><a id='page-top'></a> Calculation of global climatology of Earth Radiation Budget from EUMETSAT’s CM SAF CLARA-A3 dataset</p>
      </div>
    </a>
    <a class="right-next"
       href="srb-climatology-and-anomaly.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Calculation of global climatology and relative anomalies of Surface Radiation Budget from EUMETSAT’s CM SAF CLARA-A3 dataset</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-description">Dataset description</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites-and-data-acquisition">Prerequisites and data acquisition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data-using-cds-api">Download data using CDS API</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-cds-api-credentials">Set up CDS API credentials</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-data">Search for data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-data">Inspect data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-earth-s-radiation-budget">Climatology of the Earth’s Radiation Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-incoming-solar-radiation">Climatology of the top-of-atmosphere incoming solar radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-tis">Time averaged global climatological distribution of TIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-tis">Time averaged seasonal climatological distribution of TIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-monthly-mean-climatology-of-tis">Zonally averaged monthly mean climatology of TIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-reflected-solar-flux">Climatology of the top-of-atmosphere reflected solar flux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-toa-rsf">Time averaged global climatological distribution of TOA RSF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-toa-rsf">Time averaged seasonal climatological distribution of TOA RSF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-montly-mean-climatology-of-toa-rsf">Zonally averaged montly mean climatology of TOA RSF</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-outgoing-longwave-radiation">Climatology of the top-of-atmosphere outgoing longwave radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-toa-olr">Time averaged global climatological distribution of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-toa-olr">Time averaged seasonal climatological distribution of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inter-annual-variability-of-toa-olr">Inter-annual variability of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-montly-mean-climatology-of-toa-olr">Zonally averaged montly mean climatology of TOA OLR</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climatology-of-the-top-of-atmosphere-net-earth-s-radiation-budget">Climatology of the top-of-atmosphere net Earth’s radiation budget</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-global-climatological-distribution-of-toa-net-erb">Time averaged global climatological distribution of TOA net ERB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-averaged-seasonal-climatological-distribution-of-toa-erb">Time averaged seasonal climatological distribution of TOA ERB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-montly-mean-climatology-of-toa-net-erb">Zonally averaged montly mean climatology of TOA net ERB</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-earth-s-radiation-budget">Time series and trend analysis of the Earth’s Radiation Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-aggregation">Spatial aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-incoming-solar-radiation">Time series and trend analysis of the top-of-atmosphere incoming solar radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-tis">Global time series of TIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-tis">Trend analysis and seasonal cycle of TIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-reflected-solar-flux">Time series and trend analysis of the top-of-atmosphere reflected solar flux</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-toa-rsf">Global time series of TOA RSF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-toa-rsf">Trend analysis and seasonal cycle of TOA RSF</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-outgoing-longwave-radiation">Time series and trend analysis of the top-of-atmosphere outgoing longwave radiation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-toa-olr">Global time series of TOA OLR</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-toa-olr">Trend analysis and seasonal cycle of TOA OLR</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-and-trend-analysis-of-the-top-of-atmosphere-net-earth-s-radiation-budget">Time series and trend analysis of the top-of-atmosphere net Earth’s radiation budget</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-time-series-of-toa-net-erb">Global time series of TOA net ERB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis-and-seasonal-cycle-of-toa-net-erb">Trend analysis and seasonal cycle of TOA net ERB</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">Appendix</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>