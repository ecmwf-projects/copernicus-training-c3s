

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tutorial on July 2023 record-breaking global surface temperatures using climate data from C3S &#8212; C3S Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reanalysis-temp-record';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analysis of September 2020 European Heatwave using ERA5 Climate Reanalysis Data from C3S" href="reanalysis-heatwave.html" />
    <link rel="prev" title="Tutorial on Climatologies using Climate Data from C3S" href="reanalysis-climatology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/C3S–POS–LINE.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Climate Data Store (CDS)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://cds-beta.climate.copernicus.eu/user-guide">CDS user guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Climate Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="reanalysis-heatwave.html">Heatwave Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ecv-notebooks/erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecv-notebooks/total-column-water-vapour-combi.html">Total Column Water Vapour</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecv-notebooks/total-ozone-columns.html">Total Column Ozone</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="projections-cmip6.html">Climate Projections (CMIP6)</a></li>
<li class="toctree-l1"><a class="reference internal" href="projections-cordex.html">Climate Projections (CORDEX)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Indices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ci-windchill.html">Windchill Index Calculation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Bias Correction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ibicus.readthedocs.io/en/latest/getting_started/overview.html">Python library (ibicus) and tutorials on bias correction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials using EFFIS and GloFAS data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="visualising-fwi-for-esotc.html">Visualising Fire Weather Index (FWI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="glofas-bangladesh-floods.html">Observing floods with GloFAS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Atmosphere Monitoring Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-cams/">Tutorials from the Copernicus Atmosphere Monitoring Service (CAMS)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?urlpath=tree/reanalysis-temp-record.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s/issues/new?title=Issue%20on%20page%20%2Freanalysis-temp-record.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/reanalysis-temp-record.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial on July 2023 record-breaking global surface temperatures using climate data from C3S</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about">About</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-download-and-view-data">1. Search, download and view data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure-introduction-installing-api-of-the-cds">Infrastructure introduction (installing API of the CDS)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-on-your-computer">Installation on your computer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-on-colab-or-kaggle">Running on Colab or Kaggle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-your-cds-api-key">Enter your CDS API key</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-data">Search for data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-data">Inspect data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-the-two-era5-experiments-1-and-5-expver-1-5">Merge the two ERA5 experiments (1 and 5, <code class="docutils literal notranslate"><span class="pre">expver</span> <span class="pre">=</span> <span class="pre">[1,5]</span></code>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-temperature-units-from-kelvin-to-celsius">Change temperature units from Kelvin to Celsius</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-to-be-used">Data to be used</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-one-timestep">Plotting one timestep</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-a-surface-temperature-climatology-reference-period-1991-2020">2. Calculate a surface temperature climatology: reference period 1991-2020</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-reference-periods-and-climatologies">Standard reference periods and climatologies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualise-surface-temperature-anomalies">3. Visualise surface temperature anomalies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-surface-temperature-trends">4. View time series and analyse surface temperature trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends">5. View time series and analyse North Atlantic sea surface temperature trends</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data">This is a new exercise. In this part of the tutorial we will be working with monthly sea surface temperature (SST) data.</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-on-july-2023-record-breaking-global-surface-temperatures-using-climate-data-from-c3s">
<h1>Tutorial on July 2023 record-breaking global surface temperatures using climate data from C3S<a class="headerlink" href="#tutorial-on-july-2023-record-breaking-global-surface-temperatures-using-climate-data-from-c3s" title="Permalink to this heading">#</a></h1>
<section id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this heading">#</a></h2>
<p>In this tutorial we will access data from the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S), and analyse air and sea surface temperatures comparing July 2023 record breaking values with climatologies. The tutorial comprises the following steps:</p>
<ol class="arabic simple">
<li><p>Search, download and view data</p></li>
<li><p>Calculate a global surface temperature climatology</p></li>
<li><p>Compute and visualise anomalies with respect to the climatology</p></li>
<li><p>View time series and rank global surface temperature records</p></li>
<li><p>Analyse North Atlantic sea surface temperature trends</p></li>
</ol>
<p><img alt="Example of work" src="_images/reanalysis-temp-record-000.png" /></p>
<style>
td, th {
   border: 1px solid white;
   border-collapse: collapse;
}
</style>
<table align="left">
  <tr>
    <td>Run the tutorial via free cloud platforms: </td>
    <td>
        <a target="_blank" href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?labpath=reanalysis-temp-record.ipynb">
            <img src="https://mybinder.org/badge.svg" alt="Binder"/>
        </a>
    </td>
    <td>
        <a target="_blank" href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-projects/copernicus-training-c3s/blob/main/reanalysis-temp-record.ipynb">
            <img src="https://kaggle.com/static/images/open-in-kaggle.svg" alt="Kaggle"/>
        </a>
    </td>
    <td>
        <a target="_blank" href="https://colab.research.google.com/github/ecmwf-projects/copernicus-training-c3s/blob/main/reanalysis-temp-record.ipynb">
            <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Colab"/>
        </a>
    </td>
  </tr>
</table><br/></section>
<section id="search-download-and-view-data">
<h2>1. Search, download and view data<a class="headerlink" href="#search-download-and-view-data" title="Permalink to this heading">#</a></h2>
<p>Before we begin we must prepare our environment. This includes installing the Application Programming Interface (API) of the CDS as well as other required libs, and importing the various python libraries that we will need.</p>
<section id="infrastructure-introduction-installing-api-of-the-cds">
<h3>Infrastructure introduction (installing API of the CDS)<a class="headerlink" href="#infrastructure-introduction-installing-api-of-the-cds" title="Permalink to this heading">#</a></h3>
<p>In this exercise we will mainly use <code class="docutils literal notranslate"><span class="pre">cdsapi</span></code>, <code class="docutils literal notranslate"><span class="pre">xarray</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> python libraries.</p>
<p>There are several options to run the code in this tutorial:</p>
<ul class="simple">
<li><p>Installing everything on your computer.</p></li>
<li><p>Running the code in free Jupyter services, such as Binder, Colab or Kaggle (see links above).</p></li>
</ul>
</section>
<section id="installation-on-your-computer">
<h3>Installation on your computer<a class="headerlink" href="#installation-on-your-computer" title="Permalink to this heading">#</a></h3>
<p>First of all, in order to run this notebook on your computer you need to install Python and the required libs.</p>
<p>The easiest way to install Python without interfering with other potential Python installations on your system is by using <a class="reference external" href="https://github.com/conda-forge/miniforge/blob/main/README.md">Miniconda, Miniforge or Mambaforge</a>. This will install a modern Python for your user and the <strong>Conda</strong>/<strong>Mamba</strong> package manager. <strong>Mamba</strong> is a performant drop-in replacement for <strong>Conda</strong>.</p>
<p>Once Python + <strong>Conda</strong>/<strong>Mamba</strong> are installed run the following from the command line to install the API of the CDS, <code class="docutils literal notranslate"><span class="pre">cdsapi</span></code>, and the rest of the requirements:</p>
<ul class="simple">
<li><p>With <strong>Conda</strong>:</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">notebook</span> <span class="pre">numpy</span> <span class="pre">matplotlib</span> <span class="pre">cartopy</span> <span class="pre">xarray</span> <span class="pre">netCDF4</span> <span class="pre">cdsapi</span> <span class="pre">-y</span></code></p>
<ul class="simple">
<li><p>With <strong>Mamba</strong>:</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">mamba</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">notebook</span> <span class="pre">numpy</span> <span class="pre">matplotlib</span> <span class="pre">cartopy</span> <span class="pre">xarray</span> <span class="pre">netCDF4</span> <span class="pre">cdsapi</span> <span class="pre">-y</span></code></p>
<p>If everything is installed correctly run the following from the command line:</p>
<p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/path/to/the/notebook</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code></p>
<p>And you will see the notebook interface open in your default webbrowser.</p>
</section>
<section id="running-on-colab-or-kaggle">
<h3>Running on Colab or Kaggle<a class="headerlink" href="#running-on-colab-or-kaggle" title="Permalink to this heading">#</a></h3>
<p>If you are on Colab or Kaggle just run the following line of code to install the API of the CDS and the rest of the dependencies before running the rest of the code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install numpy matplotlib cartopy xarray netCDF4 cdsapi
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-libraries">
<h3>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this heading">#</a></h3>
<p>We will start importing the required libraries. These libs should be already installed. If you have not installed the requirements, please go to the specific section above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib3</span>
<span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="enter-your-cds-api-key">
<h3>Enter your CDS API key<a class="headerlink" href="#enter-your-cds-api-key" title="Permalink to this heading">#</a></h3>
<p>We will request data from the CDS programmatically with the help of the CDS API. Let us make use of the option to manually set the CDS API credentials. First you have to define two variables: <code class="docutils literal notranslate"><span class="pre">URL</span></code> and <code class="docutils literal notranslate"><span class="pre">APIKEY</span></code> which build together your CDS API key. The string of characters that make up your APIKEY include your personal User ID and CDS API key. To obtain these, first register and login to the CDS (<a class="reference external" href="https://cds-beta.climate.copernicus.eu">https://cds-beta.climate.copernicus.eu</a>), then visit <a class="reference external" href="https://cds-beta.climate.copernicus.eu/how-to-api">https://cds-beta.climate.copernicus.eu/how-to-api</a> and copy the string of characters listed after “key:”. Replace the <code class="docutils literal notranslate"><span class="pre">Your-api-key</span></code> below with this string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;https://cds-beta.climate.copernicus.eu/api&quot;</span>
<span class="c1"># Here you shall use your UUID and api key replacing &quot;UUID:Your-api-key&quot; with the values in your user profile in CDS</span>
<span class="c1"># For instance &quot;1234:ecmwf123-4567-89ec-mwf1-23456789ecmf&quot; or something like that</span>
<span class="n">APIKEY</span> <span class="o">=</span> <span class="s2">&quot;Your-api-key&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Here we specify a data directory in which we will download our data and all output files that we will generate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="search-for-data">
<h3>Search for data<a class="headerlink" href="#search-for-data" title="Permalink to this heading">#</a></h3>
<p>To search for data, visit the CDS website: <a class="reference external" href="https://cds-beta.climate.copernicus.eu">https://cds-beta.climate.copernicus.eu</a>.
Here you can search for ERA5 data using the search bar. The data we need for this tutorial is the <a class="reference external" href="https://cds-beta.climate.copernicus.eu/datasets/reanalysis-era5-single-levels-monthly-means?tab=overview">ERA5 monthly averaged data on single levels from 1940 to present</a>. ERA5 is the 5th version of the ECMWF Reanalysis dataset. Reanalysis uses a state of the art forecast model and data assimilation system to create a consistent “map without gaps” of observed and modelled climate variables over the past decades.</p>
<p>Having selected the correct dataset, we now need to specify what product type, variables, temporal and geographic coverage we are interested in. These can all be selected in the <strong>“Download data”</strong> tab. In this tab a form appears in which we will select the following parameters to download:</p>
<ul class="simple">
<li><p>Product type: <code class="docutils literal notranslate"><span class="pre">Monthly</span> <span class="pre">averaged</span> <span class="pre">reanalysis</span></code></p></li>
<li><p>Variable: <code class="docutils literal notranslate"><span class="pre">2m</span> <span class="pre">temperature</span></code></p></li>
<li><p>Year: <code class="docutils literal notranslate"><span class="pre">1940</span> <span class="pre">to</span> <span class="pre">present</span> <span class="pre">year</span></code></p></li>
<li><p>Month: <code class="docutils literal notranslate"><span class="pre">july</span></code></p></li>
<li><p>Time: <code class="docutils literal notranslate"><span class="pre">00:00</span></code> (default)</p></li>
<li><p>Geographical area: <code class="docutils literal notranslate"><span class="pre">Sub-region</span> <span class="pre">extraction</span></code> and leave the default values, <code class="docutils literal notranslate"><span class="pre">'area':</span> <span class="pre">[90,</span> <span class="pre">-180,</span> <span class="pre">-90,</span> <span class="pre">180],</span> <span class="pre">#</span> <span class="pre">maxlat,</span> <span class="pre">minlon,</span> <span class="pre">minlat,</span> <span class="pre">maxlon</span></code> (this will be explained further below)</p></li>
<li><p>Format: <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code></p></li>
</ul>
<p>At the end of the download form, select <strong>“Show API request”</strong>. This will reveal a block of code, which you can simply copy and paste into a cell of your Jupyter Notebook (see cell below) …</p>
<center><img src="img/reanalysis-temp-record-001.png" /></center></section>
<section id="download-data">
<h3>Download data<a class="headerlink" href="#download-data" title="Permalink to this heading">#</a></h3>
<p>… having copied the API request into the cell below, running this will retrieve and download the data you requested into your local directory. However, before you run the cell below, the <strong>terms and conditions</strong> of this particular dataset need to have been accepted in the CDS. The option to view and accept these conditions is given at the end of the download form, just above the <strong>“Show API request”</strong> option.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">APIKEY</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;reanalysis-era5-single-levels-monthly-means&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;data_format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf_legacy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_averaged_reanalysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;2m_temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;1940&#39;</span><span class="p">,</span> <span class="s1">&#39;1941&#39;</span><span class="p">,</span> <span class="s1">&#39;1942&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1943&#39;</span><span class="p">,</span> <span class="s1">&#39;1944&#39;</span><span class="p">,</span> <span class="s1">&#39;1945&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1946&#39;</span><span class="p">,</span> <span class="s1">&#39;1947&#39;</span><span class="p">,</span> <span class="s1">&#39;1948&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1949&#39;</span><span class="p">,</span> <span class="s1">&#39;1950&#39;</span><span class="p">,</span> <span class="s1">&#39;1951&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1952&#39;</span><span class="p">,</span> <span class="s1">&#39;1953&#39;</span><span class="p">,</span> <span class="s1">&#39;1954&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1955&#39;</span><span class="p">,</span> <span class="s1">&#39;1956&#39;</span><span class="p">,</span> <span class="s1">&#39;1957&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1958&#39;</span><span class="p">,</span> <span class="s1">&#39;1959&#39;</span><span class="p">,</span> <span class="s1">&#39;1960&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1961&#39;</span><span class="p">,</span> <span class="s1">&#39;1962&#39;</span><span class="p">,</span> <span class="s1">&#39;1963&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1964&#39;</span><span class="p">,</span> <span class="s1">&#39;1965&#39;</span><span class="p">,</span> <span class="s1">&#39;1966&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1967&#39;</span><span class="p">,</span> <span class="s1">&#39;1968&#39;</span><span class="p">,</span> <span class="s1">&#39;1969&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1970&#39;</span><span class="p">,</span> <span class="s1">&#39;1971&#39;</span><span class="p">,</span> <span class="s1">&#39;1972&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1973&#39;</span><span class="p">,</span> <span class="s1">&#39;1974&#39;</span><span class="p">,</span> <span class="s1">&#39;1975&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1976&#39;</span><span class="p">,</span> <span class="s1">&#39;1977&#39;</span><span class="p">,</span> <span class="s1">&#39;1978&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1979&#39;</span><span class="p">,</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;1981&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1982&#39;</span><span class="p">,</span> <span class="s1">&#39;1983&#39;</span><span class="p">,</span> <span class="s1">&#39;1984&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1985&#39;</span><span class="p">,</span> <span class="s1">&#39;1986&#39;</span><span class="p">,</span> <span class="s1">&#39;1987&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1988&#39;</span><span class="p">,</span> <span class="s1">&#39;1989&#39;</span><span class="p">,</span> <span class="s1">&#39;1990&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1991&#39;</span><span class="p">,</span> <span class="s1">&#39;1992&#39;</span><span class="p">,</span> <span class="s1">&#39;1993&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1994&#39;</span><span class="p">,</span> <span class="s1">&#39;1995&#39;</span><span class="p">,</span> <span class="s1">&#39;1996&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1997&#39;</span><span class="p">,</span> <span class="s1">&#39;1998&#39;</span><span class="p">,</span> <span class="s1">&#39;1999&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2001&#39;</span><span class="p">,</span> <span class="s1">&#39;2002&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2003&#39;</span><span class="p">,</span> <span class="s1">&#39;2004&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2009&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2011&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2021&#39;</span><span class="p">,</span> <span class="s1">&#39;2022&#39;</span><span class="p">,</span> <span class="s1">&#39;2023&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="s1">&#39;07&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="c1"># maxlat, minlon, minlat, maxlon</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">t2m_global_july_1940-2023.nc&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-16 21:46:19,158 INFO Welcome to the CDS
2024-06-16 21:46:19,158 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels-monthly-means
2024-06-16 21:46:19,282 INFO Request is queued
2024-06-16 21:46:20,347 INFO Request is running
2024-06-16 21:46:40,413 INFO Request is completed
2024-06-16 21:46:40,413 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data5/adaptor.mars.internal-1718567197.247748-30483-9-b46e2bfe-4461-43da-a87b-bd7e7a603f2a.nc to ./DATA-2024-06-16/t2m_global_july_1940-2023.nc (166.4M)
2024-06-16 21:47:36,309 INFO Download rate 3M/s                                                                        
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result(content_length=174434368,content_type=application/x-netcdf,location=https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data5/adaptor.mars.internal-1718567197.247748-30483-9-b46e2bfe-4461-43da-a87b-bd7e7a603f2a.nc)
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect-data">
<h3>Inspect data<a class="headerlink" href="#inspect-data" title="Permalink to this heading">#</a></h3>
<p>Now that we have downloaded the data, we can inspect it. We have requested the data in NetCDF format. This is a commonly used format for array-oriented scientific data. To read and process this data we will make use of the <a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray</a> library. Xarray is an open source project and Python package that makes working with labelled multi-dimensional arrays simple and efficient. We will read the data from our NetCDF file into an <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.Dataset.html"><code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">t2m_global_july_1940-2023.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can query our newly created Xarray dataset… Let’s have a look at the <code class="docutils literal notranslate"><span class="pre">ds</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (longitude: 1440, latitude: 721, time: 84)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 1940-07-01 1941-07-01 ... 2023-07-01
Data variables:
    t2m        (time, latitude, longitude) float32 ...
Attributes:
    Conventions:  CF-1.6
    history:      2024-06-16 19:46:38 GMT by grib_to_netcdf-2.28.1: /opt/ecmw...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d85ecf81-f0ef-4784-b99c-085a151ff616' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d85ecf81-f0ef-4784-b99c-085a151ff616' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>longitude</span>: 1440</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>time</span>: 84</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9a2c6e1c-3f24-4f7a-b23c-d48fcc631613' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9a2c6e1c-3f24-4f7a-b23c-d48fcc631613' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-c5ce3f35-38b8-45a7-8a90-a89ec532fdcd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c5ce3f35-38b8-45a7-8a90-a89ec532fdcd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-970fedfa-43eb-4945-adf3-b721ac3f3896' class='xr-var-data-in' type='checkbox'><label for='data-970fedfa-43eb-4945-adf3-b721ac3f3896' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-a1ae4d59-6e65-426c-9028-cfbb8bb69141' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1ae4d59-6e65-426c-9028-cfbb8bb69141' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf17369d-986e-49ed-8c85-de7db57fadf0' class='xr-var-data-in' type='checkbox'><label for='data-cf17369d-986e-49ed-8c85-de7db57fadf0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-7382adea-7307-442c-a299-e70e772d801c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7382adea-7307-442c-a299-e70e772d801c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68769ba6-5fa4-4287-bf6e-d9de0eab0780' class='xr-var-data-in' type='checkbox'><label for='data-68769ba6-5fa4-4287-bf6e-d9de0eab0780' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-baed7e75-8517-445f-9afe-e36be2d1deac' class='xr-section-summary-in' type='checkbox'  checked><label for='section-baed7e75-8517-445f-9afe-e36be2d1deac' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>t2m</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-910dface-76fa-4c10-94d7-b6e043a80643' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-910dface-76fa-4c10-94d7-b6e043a80643' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4fc8bd19-1a4a-46a2-93ea-3d8875c743ee' class='xr-var-data-in' type='checkbox'><label for='data-4fc8bd19-1a4a-46a2-93ea-3d8875c743ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd></dl></div><div class='xr-var-data'><pre>[87212160 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b3a3bd4-9756-4467-af60-055829530ba2' class='xr-section-summary-in' type='checkbox'  ><label for='section-6b3a3bd4-9756-4467-af60-055829530ba2' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a1d3224f-a297-4805-8825-3659ea65cbfd' class='xr-index-data-in' type='checkbox'/><label for='index-a1d3224f-a297-4805-8825-3659ea65cbfd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2e549245-48f0-4922-8150-35bc1049cbf5' class='xr-index-data-in' type='checkbox'/><label for='index-2e549245-48f0-4922-8150-35bc1049cbf5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f8d9816c-8741-46e1-bfd1-2ad50cd97c12' class='xr-index-data-in' type='checkbox'/><label for='index-f8d9816c-8741-46e1-bfd1-2ad50cd97c12' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b9c73b74-7382-42da-9f93-5b611ddee9d3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b9c73b74-7382-42da-9f93-5b611ddee9d3' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>2024-06-16 19:46:38 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data5/adaptor.mars.internal-1718567197.247748-30483-9-b46e2bfe-4461-43da-a87b-bd7e7a603f2a.nc /cache/tmp/b46e2bfe-4461-43da-a87b-bd7e7a603f2a-adaptor.mars.internal-1718567179.4697785-30483-4-tmp.grib</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We see that the dataset has one variable called <code class="docutils literal notranslate"><span class="pre">t2m</span></code>, which stands for “2 metre temperature”, and three coordinates of <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<p>Before we have commented to choose the <code class="docutils literal notranslate"><span class="pre">sub-region</span> <span class="pre">extraction</span></code> option but selecting the whole region in the request to the CDSAPI, <code class="docutils literal notranslate"><span class="pre">'area':</span> <span class="pre">[90,</span> <span class="pre">-180,</span> <span class="pre">-90,</span> <span class="pre">180],</span> <span class="pre">#</span> <span class="pre">maxlat,</span> <span class="pre">minlon,</span> <span class="pre">minlat,</span> <span class="pre">maxlon</span></code>. If we had chosen the <code class="docutils literal notranslate"><span class="pre">whole</span> <span class="pre">available</span> <span class="pre">region</span></code> option then the longitudes in the Xarray Dataset would be on a [0, 360] grid instead of [-180, 180] and we should correct this performing some extra steps.</p>
<p>If your longitudes are on a [0, 360] grid you could do the following to bring the longitude coordinates to a [-180, 180] grid:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_180</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There is also an <code class="docutils literal notranslate"><span class="pre">expver</span></code> coordinate. More on this later.</p>
<p>Select the icons to the right of the table above to expand the attributes of the coordinates and data variables. What are the units of the temperature data?</p>
<p>While an Xarray dataset may contain multiple variables, an Xarray data array holds a single multi-dimensional variable and its coordinates. To make the processing of the <code class="docutils literal notranslate"><span class="pre">t2m</span></code> data easier, we convert it into an Xarray data array. We will call it <code class="docutils literal notranslate"><span class="pre">da_tmp</span></code> (a temporary data array) because we will transform the data in some ways.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_tmp</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;t2m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s view this data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_tmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (time: 84, latitude: 721, longitude: 1440)&gt;
[87212160 values with dtype=float32]
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 1940-07-01 1941-07-01 ... 2023-07-01
Attributes:
    units:      K
    long_name:  2 metre temperature</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 84</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-65c605ff-0589-40dd-a7d9-137b0a9bc049' class='xr-array-in' type='checkbox' checked><label for='section-65c605ff-0589-40dd-a7d9-137b0a9bc049' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[87212160 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-7db36326-5cc6-465a-b40e-aece40666b5a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7db36326-5cc6-465a-b40e-aece40666b5a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-bfff2da7-9bbc-4031-b135-4e09ae25a224' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bfff2da7-9bbc-4031-b135-4e09ae25a224' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-267b95f5-0a87-4d15-b293-495ee68edce6' class='xr-var-data-in' type='checkbox'><label for='data-267b95f5-0a87-4d15-b293-495ee68edce6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-4f6e808c-95b7-444d-b99f-499ee2da671b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f6e808c-95b7-444d-b99f-499ee2da671b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61a0e53c-6ff4-4c11-8395-06084c13b8f2' class='xr-var-data-in' type='checkbox'><label for='data-61a0e53c-6ff4-4c11-8395-06084c13b8f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-771a77f1-9276-4792-a608-b4a3a5b490e6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-771a77f1-9276-4792-a608-b4a3a5b490e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c068ce56-e46c-4638-aee6-ce3af2c3c3fd' class='xr-var-data-in' type='checkbox'><label for='data-c068ce56-e46c-4638-aee6-ce3af2c3c3fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-02b699d5-f487-4166-b8c0-c8990a85e39b' class='xr-section-summary-in' type='checkbox'  ><label for='section-02b699d5-f487-4166-b8c0-c8990a85e39b' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d74161ce-3e91-4081-b823-bbd24cb1c1ec' class='xr-index-data-in' type='checkbox'/><label for='index-d74161ce-3e91-4081-b823-bbd24cb1c1ec' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bfee0306-0350-4a19-a3ff-906a75a1f460' class='xr-index-data-in' type='checkbox'/><label for='index-bfee0306-0350-4a19-a3ff-906a75a1f460' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4b7854dd-d456-4e23-9eb8-8691b22e7f94' class='xr-index-data-in' type='checkbox'/><label for='index-4b7854dd-d456-4e23-9eb8-8691b22e7f94' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-655170b0-374a-4591-a37f-d1f5f5cdf64c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-655170b0-374a-4591-a37f-d1f5f5cdf64c' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>From the result of the cell above you can see that now we have a <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>.</p>
</section>
<section id="merge-the-two-era5-experiments-1-and-5-expver-1-5">
<h3>Merge the two ERA5 experiments (1 and 5, <code class="docutils literal notranslate"><span class="pre">expver</span> <span class="pre">=</span> <span class="pre">[1,5]</span></code>)<a class="headerlink" href="#merge-the-two-era5-experiments-1-and-5-expver-1-5" title="Permalink to this heading">#</a></h3>
<p>The hourly data from ERA5 are made available in the Climate Data Store with a delay of about 5 days behind real-time. These data are only preliminary, also called initial release. If a serious problem is detected by the ERA5 team, ERA5 may be rerun. This happens extremely rarely. This preliminary dataset is called ERA5T (‘T’ for temporary) and the corresponding ERA5 experiment version (or expver) is expver=5. The final ERA5 data are released in the CDS with a 3-month delay. They correspond to the ERA5 experiment version expver=1 and overwrite the data from expver=5. The same distinction also applies to the monthly means. See <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation#ERA5:datadocumentation-Dataupdatefrequency">ERA5 documentation</a> and the <a class="reference external" href="https://confluence.ecmwf.int/display/CUSF/Release+of+ERA5T">announcement of release of ERA5T</a> for more information.</p>
<p>When we use near real time ERA5 data from the CDS the requests may return a mix of ERA5 and ERA5T data. In order to differentiate between the two, a new coordinate, <code class="docutils literal notranslate"><span class="pre">expver</span></code>, is added to the netcdf file. If we work only with ERA5 or ERA5T, not a mix of both, then the <code class="docutils literal notranslate"><span class="pre">expver</span></code> coordinate will not be present. To take this into account we may create code that checks for this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;expver&#39;</span> <span class="ow">in</span> <span class="n">da_tmp</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
    <span class="n">da_tmp</span> <span class="o">=</span> <span class="n">da_tmp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;expver&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s check again the <code class="docutils literal notranslate"><span class="pre">da_tmp</span></code> data array. If there was an <code class="docutils literal notranslate"><span class="pre">expver</span></code> coordinate we <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.reduce.html">reduce this dimension</a> by performing a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.nansum.html"><code class="docutils literal notranslate"><span class="pre">nansum</span></code></a> operation, i.e. a sum of the array elements over this axis, treating Not a Numbers (NaNs) as zero. The result is a new <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> merging the data along the <code class="docutils literal notranslate"><span class="pre">expver</span></code> dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_tmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (time: 84, latitude: 721, longitude: 1440)&gt;
[87212160 values with dtype=float32]
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 1940-07-01 1941-07-01 ... 2023-07-01
Attributes:
    units:      K
    long_name:  2 metre temperature</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 84</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3bd9a0ea-b8e9-475c-945f-93d2abe6a0fd' class='xr-array-in' type='checkbox' checked><label for='section-3bd9a0ea-b8e9-475c-945f-93d2abe6a0fd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[87212160 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-91381280-8616-4893-a706-68ad22c36266' class='xr-section-summary-in' type='checkbox'  checked><label for='section-91381280-8616-4893-a706-68ad22c36266' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-28677b66-5a7f-46c0-9ae0-4edc0055279e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-28677b66-5a7f-46c0-9ae0-4edc0055279e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bfc3a40a-8904-4da7-b8e9-17fdce6af530' class='xr-var-data-in' type='checkbox'><label for='data-bfc3a40a-8904-4da7-b8e9-17fdce6af530' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-b1d7d0fa-7b66-4be1-b862-f6149ec06831' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b1d7d0fa-7b66-4be1-b862-f6149ec06831' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0458afd-b9b9-48fd-b4e4-a37c4aaaa8f7' class='xr-var-data-in' type='checkbox'><label for='data-b0458afd-b9b9-48fd-b4e4-a37c4aaaa8f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-5f5c780b-26f5-4276-adf0-64185dcc108c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f5c780b-26f5-4276-adf0-64185dcc108c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54c0f051-0bd5-4427-9761-e43c2263c6c9' class='xr-var-data-in' type='checkbox'><label for='data-54c0f051-0bd5-4427-9761-e43c2263c6c9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6c0d6f0f-2d02-42f7-8146-821aa40679b1' class='xr-section-summary-in' type='checkbox'  ><label for='section-6c0d6f0f-2d02-42f7-8146-821aa40679b1' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b1f7d3e5-ae30-4702-aae3-55dd94a5d641' class='xr-index-data-in' type='checkbox'/><label for='index-b1f7d3e5-ae30-4702-aae3-55dd94a5d641' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-47f0ab1a-5f5f-413c-915c-bbb692503174' class='xr-index-data-in' type='checkbox'/><label for='index-47f0ab1a-5f5f-413c-915c-bbb692503174' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2f7c14fd-d8cf-4c86-86b7-84728d3e4939' class='xr-index-data-in' type='checkbox'/><label for='index-2f7c14fd-d8cf-4c86-86b7-84728d3e4939' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-65b3572e-5042-4001-919a-463cf257ef2e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-65b3572e-5042-4001-919a-463cf257ef2e' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Now the data array contains the three expected dimensions: <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code>.</p>
</section>
<section id="change-temperature-units-from-kelvin-to-celsius">
<h3>Change temperature units from Kelvin to Celsius<a class="headerlink" href="#change-temperature-units-from-kelvin-to-celsius" title="Permalink to this heading">#</a></h3>
<p>Notice that the ERA5 temperature data are in units of <em>Kelvin</em>, the base unit for temperature in the International System of Units (SI). If you want to convert the values from <em>Kelvin</em> to <em>degrees Celsius</em>, you have to subtract 273.15.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subtract 273.15 to convert to Celsius</span>
<span class="n">da_celsius</span> <span class="o">=</span> <span class="n">da_tmp</span> <span class="o">-</span> <span class="mf">273.15</span>
<span class="c1"># Update the attributes of the DataArray to add Celsius units</span>
<span class="n">da_celsius</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="n">da_tmp</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
<span class="n">da_celsius</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;°C&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-to-be-used">
<h3>Data to be used<a class="headerlink" href="#data-to-be-used" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">da_celsius</span></code> data array will be used in the rest of the surface temperature exercise. Let’s check what we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_celsius</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (time: 84, latitude: 721, longitude: 1440)&gt;
array([[[  0.85357666,   0.85357666,   0.85357666, ...,   0.85357666,
           0.85357666,   0.85357666],
        [  0.8590088 ,   0.8590088 ,   0.8590088 , ...,   0.8590088 ,
           0.8590088 ,   0.8590088 ],
        [  0.85357666,   0.85357666,   0.85357666, ...,   0.85357666,
           0.85357666,   0.85357666],
        ...,
        [-55.322693  , -55.320877  , -55.320877  , ..., -55.326324  ,
         -55.326324  , -55.324493  ],
        [-55.233887  , -55.233887  , -55.23207   , ..., -55.23752   ,
         -55.23752   , -55.233887  ],
        [-54.980164  , -54.980164  , -54.980164  , ..., -54.980164  ,
         -54.980164  , -54.980164  ]],

       [[  0.89889526,   0.89889526,   0.89889526, ...,   0.89889526,
           0.89889526,   0.89889526],
        [  0.8952637 ,   0.8952637 ,   0.8952637 , ...,   0.8952637 ,
           0.8952637 ,   0.8952637 ],
        [  0.8807678 ,   0.8807678 ,   0.8807678 , ...,   0.8825989 ,
           0.8807678 ,   0.8807678 ],
...
        [-56.488007  , -56.482574  , -56.478943  , ..., -56.498886  ,
         -56.495255  , -56.49164   ],
        [-56.727234  , -56.725418  , -56.723602  , ..., -56.732666  ,
         -56.730865  , -56.72905   ],
        [-56.506134  , -56.506134  , -56.506134  , ..., -56.506134  ,
         -56.506134  , -56.506134  ]],

       [[  0.73760986,   0.73760986,   0.73760986, ...,   0.73760986,
           0.73760986,   0.73760986],
        [  0.7321472 ,   0.7321472 ,   0.7321472 , ...,   0.7321472 ,
           0.7321472 ,   0.7321472 ],
        [  0.72128296,   0.72128296,   0.72128296, ...,   0.72128296,
           0.72128296,   0.72128296],
        ...,
        [-53.12979   , -53.12616   , -53.122543  , ..., -53.14067   ,
         -53.135223  , -53.131607  ],
        [-53.238525  , -53.236725  , -53.23491   , ..., -53.243973  ,
         -53.243973  , -53.242157  ],
        [-53.29471   , -53.29471   , -53.29471   , ..., -53.29471   ,
         -53.29471   , -53.29471   ]]], dtype=float32)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 1940-07-01 1941-07-01 ... 2023-07-01
Attributes:
    units:      °C
    long_name:  2 metre temperature</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 84</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7551f014-a9e0-4e28-82c5-b911222e4d6a' class='xr-array-in' type='checkbox' checked><label for='section-7551f014-a9e0-4e28-82c5-b911222e4d6a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.8536 0.8536 0.8536 0.8536 0.8536 ... -53.29 -53.29 -53.29 -53.29</span></div><div class='xr-array-data'><pre>array([[[  0.85357666,   0.85357666,   0.85357666, ...,   0.85357666,
           0.85357666,   0.85357666],
        [  0.8590088 ,   0.8590088 ,   0.8590088 , ...,   0.8590088 ,
           0.8590088 ,   0.8590088 ],
        [  0.85357666,   0.85357666,   0.85357666, ...,   0.85357666,
           0.85357666,   0.85357666],
        ...,
        [-55.322693  , -55.320877  , -55.320877  , ..., -55.326324  ,
         -55.326324  , -55.324493  ],
        [-55.233887  , -55.233887  , -55.23207   , ..., -55.23752   ,
         -55.23752   , -55.233887  ],
        [-54.980164  , -54.980164  , -54.980164  , ..., -54.980164  ,
         -54.980164  , -54.980164  ]],

       [[  0.89889526,   0.89889526,   0.89889526, ...,   0.89889526,
           0.89889526,   0.89889526],
        [  0.8952637 ,   0.8952637 ,   0.8952637 , ...,   0.8952637 ,
           0.8952637 ,   0.8952637 ],
        [  0.8807678 ,   0.8807678 ,   0.8807678 , ...,   0.8825989 ,
           0.8807678 ,   0.8807678 ],
...
        [-56.488007  , -56.482574  , -56.478943  , ..., -56.498886  ,
         -56.495255  , -56.49164   ],
        [-56.727234  , -56.725418  , -56.723602  , ..., -56.732666  ,
         -56.730865  , -56.72905   ],
        [-56.506134  , -56.506134  , -56.506134  , ..., -56.506134  ,
         -56.506134  , -56.506134  ]],

       [[  0.73760986,   0.73760986,   0.73760986, ...,   0.73760986,
           0.73760986,   0.73760986],
        [  0.7321472 ,   0.7321472 ,   0.7321472 , ...,   0.7321472 ,
           0.7321472 ,   0.7321472 ],
        [  0.72128296,   0.72128296,   0.72128296, ...,   0.72128296,
           0.72128296,   0.72128296],
        ...,
        [-53.12979   , -53.12616   , -53.122543  , ..., -53.14067   ,
         -53.135223  , -53.131607  ],
        [-53.238525  , -53.236725  , -53.23491   , ..., -53.243973  ,
         -53.243973  , -53.242157  ],
        [-53.29471   , -53.29471   , -53.29471   , ..., -53.29471   ,
         -53.29471   , -53.29471   ]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-c9366347-542e-4497-89bf-b47f5d68d388' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c9366347-542e-4497-89bf-b47f5d68d388' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-6f06be75-55b4-41ce-95ba-62d5e98eff04' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f06be75-55b4-41ce-95ba-62d5e98eff04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-66c8b7fa-8ee2-4de0-a764-05a8d8934e8d' class='xr-var-data-in' type='checkbox'><label for='data-66c8b7fa-8ee2-4de0-a764-05a8d8934e8d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-75ca3fb9-524c-4c0a-b349-8d0a93e058ed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-75ca3fb9-524c-4c0a-b349-8d0a93e058ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe57de95-6a0d-41b9-80ae-68f22f477cbd' class='xr-var-data-in' type='checkbox'><label for='data-fe57de95-6a0d-41b9-80ae-68f22f477cbd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-dda57278-607e-4e35-9f04-915156f66619' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dda57278-607e-4e35-9f04-915156f66619' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2650920d-ce3a-4120-937d-ec134e64eb2c' class='xr-var-data-in' type='checkbox'><label for='data-2650920d-ce3a-4120-937d-ec134e64eb2c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-51bfbbf9-70f9-4be7-948d-91cc9988fc44' class='xr-section-summary-in' type='checkbox'  ><label for='section-51bfbbf9-70f9-4be7-948d-91cc9988fc44' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4f996cd8-e6cd-491e-90c2-b033bb8123d3' class='xr-index-data-in' type='checkbox'/><label for='index-4f996cd8-e6cd-491e-90c2-b033bb8123d3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b5c34d63-d4ba-40e3-8275-510d19a5ba51' class='xr-index-data-in' type='checkbox'/><label for='index-b5c34d63-d4ba-40e3-8275-510d19a5ba51' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ea5210f3-7046-4ddc-96fd-bafc6b1ca27c' class='xr-index-data-in' type='checkbox'/><label for='index-ea5210f3-7046-4ddc-96fd-bafc6b1ca27c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-767b6f55-cb32-4ca9-94f6-23c84cd80b3a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-767b6f55-cb32-4ca9-94f6-23c84cd80b3a' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>°C</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Now we can see the updated values in <em>Celsius</em> and the <code class="docutils literal notranslate"><span class="pre">units</span></code> attribute updated accordingly.</p>
</section>
<section id="plotting-one-timestep">
<h3>Plotting one timestep<a class="headerlink" href="#plotting-one-timestep" title="Permalink to this heading">#</a></h3>
<p>Just to check what we have so far, let’s plot a map of 2m temperature for the first (July 1940) and the last (July 2023) timesteps. We will plot these maps using the convenience method <code class="docutils literal notranslate"><span class="pre">plot</span></code> available for <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>. This allows the creation of simple plots using one line of code. Also, with the xarray method <code class="docutils literal notranslate"><span class="pre">sel()</span></code>, you can select a data array based on coordinate labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1940&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2d3dfc4ffd0&gt;
</pre></div>
</div>
<img alt="_images/d2bd9a057937e4274b11f5b081a2fa4f0f58f24c703cadd631994e0fe2ef3737.png" src="_images/d2bd9a057937e4274b11f5b081a2fa4f0f58f24c703cadd631994e0fe2ef3737.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2d3972944c0&gt;
</pre></div>
</div>
<img alt="_images/9a90c02f856228c40b40655db736e38cebeda611d83d51c1b0b18ab7fe32e526.png" src="_images/9a90c02f856228c40b40655db736e38cebeda611d83d51c1b0b18ab7fe32e526.png" />
</div>
</div>
</section>
</section>
<section id="calculate-a-surface-temperature-climatology-reference-period-1991-2020">
<h2>2. Calculate a surface temperature climatology: reference period 1991-2020<a class="headerlink" href="#calculate-a-surface-temperature-climatology-reference-period-1991-2020" title="Permalink to this heading">#</a></h2>
<section id="standard-reference-periods-and-climatologies">
<h3>Standard reference periods and climatologies<a class="headerlink" href="#standard-reference-periods-and-climatologies" title="Permalink to this heading">#</a></h3>
<p>Anthropogenic activities and natural variations from years to decades shape the Earth’s climate. In order to evaluate anomalous conditions for a specific month or year, the World Meteorological Organization (WMO) defines <code class="docutils literal notranslate"><span class="pre">standard</span> <span class="pre">reference</span> <span class="pre">periods</span></code> used to create <code class="docutils literal notranslate"><span class="pre">climatologies</span></code>, also known as <code class="docutils literal notranslate"><span class="pre">climate</span> <span class="pre">normals</span></code>. <code class="docutils literal notranslate"><span class="pre">Climatologies</span></code> can be considered as the typical climate for the period they are based on.</p>
<p>Until 2020, the most current and widely used standard reference period was the 30-year range of 1981-2010. With the start of 2021, the WMO recommended updating the climate normal reference period to the range 1991-2020.</p>
<p>First, let us calculate the temperature climatology for July during the reference period 1991-2020. For this, we will select the reference period and then average along the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension. The resulting object contains the average July mean surface air temperature on each grid point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_ref_per</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we have a look at this data object we will see now we have only two coordinates, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_ref_per</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (latitude: 721, longitude: 1440)&gt;
array([[  0.74816996,   0.74816996,   0.74816996, ...,   0.74816996,
          0.74816996,   0.74816996],
       [  0.7403127 ,   0.74037373,   0.7404948 , ...,   0.73977053,
          0.74001056,   0.74019164],
       [  0.72756857,   0.7276896 ,   0.7279307 , ...,   0.726238  ,
          0.7267222 ,   0.7272064 ],
       ...,
       [-55.41742   , -55.414043  , -55.41071   , ..., -55.427814  ,
        -55.42436   , -55.420856  ],
       [-55.408604  , -55.40709   , -55.40564   , ..., -55.413795  ,
        -55.41198   , -55.410347  ],
       [-55.04577   , -55.04577   , -55.04577   , ..., -55.04577   ,
        -55.04577   , -55.04577   ]], dtype=float32)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-390c414b-d8ff-4602-935c-8a53e269889b' class='xr-array-in' type='checkbox' checked><label for='section-390c414b-d8ff-4602-935c-8a53e269889b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.7482 0.7482 0.7482 0.7482 0.7482 ... -55.05 -55.05 -55.05 -55.05</span></div><div class='xr-array-data'><pre>array([[  0.74816996,   0.74816996,   0.74816996, ...,   0.74816996,
          0.74816996,   0.74816996],
       [  0.7403127 ,   0.74037373,   0.7404948 , ...,   0.73977053,
          0.74001056,   0.74019164],
       [  0.72756857,   0.7276896 ,   0.7279307 , ...,   0.726238  ,
          0.7267222 ,   0.7272064 ],
       ...,
       [-55.41742   , -55.414043  , -55.41071   , ..., -55.427814  ,
        -55.42436   , -55.420856  ],
       [-55.408604  , -55.40709   , -55.40564   , ..., -55.413795  ,
        -55.41198   , -55.410347  ],
       [-55.04577   , -55.04577   , -55.04577   , ..., -55.04577   ,
        -55.04577   , -55.04577   ]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-2d6c63fd-ea6b-4e5c-a94c-8f4980e92f8f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2d6c63fd-ea6b-4e5c-a94c-8f4980e92f8f' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-e9b4d653-6657-4061-88b0-d9071c63918f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e9b4d653-6657-4061-88b0-d9071c63918f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0e4e8bd-c2d7-4149-9f3c-4e3a443855f6' class='xr-var-data-in' type='checkbox'><label for='data-a0e4e8bd-c2d7-4149-9f3c-4e3a443855f6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-1db81e11-17de-4e9a-a2dc-15146a35b4a0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1db81e11-17de-4e9a-a2dc-15146a35b4a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ea89947-1392-4782-af2e-630100081d24' class='xr-var-data-in' type='checkbox'><label for='data-7ea89947-1392-4782-af2e-630100081d24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c5f660e0-77f0-4b2e-8221-af4e62954f04' class='xr-section-summary-in' type='checkbox'  ><label for='section-c5f660e0-77f0-4b2e-8221-af4e62954f04' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0d581615-c2e6-46f2-b6e4-7aefd556e050' class='xr-index-data-in' type='checkbox'/><label for='index-0d581615-c2e6-46f2-b6e4-7aefd556e050' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9013d8d8-823e-4e47-bcb3-ab74d0f1b238' class='xr-index-data-in' type='checkbox'/><label for='index-9013d8d8-823e-4e47-bcb3-ab74d0f1b238' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-be059990-a81a-41de-832f-e2c9a1fefb8c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-be059990-a81a-41de-832f-e2c9a1fefb8c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>We can also make a quick plot to have an exploratory view of this new <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_ref_per</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2d394e6d000&gt;
</pre></div>
</div>
<img alt="_images/a8031cec61d31e66e485ff0ac1743db8332b1a6a550a058850f18814308a35ba.png" src="_images/a8031cec61d31e66e485ff0ac1743db8332b1a6a550a058850f18814308a35ba.png" />
</div>
</div>
</section>
</section>
<section id="visualise-surface-temperature-anomalies">
<h2>3. Visualise surface temperature anomalies<a class="headerlink" href="#visualise-surface-temperature-anomalies" title="Permalink to this heading">#</a></h2>
<p>The next step is now to calculate the anomaly for July 2023 with respect to the climatology (1991-2020). The term anomaly refers to the deviation of a value from the long-term average. Positive or negative anomalies indicate that the average temperatures of a particular month were respectively warmer or cooler than the reference value for the same month.</p>
<p>Let us calculate the temperature anomaly for the year 2023. In a first step, we select the average near-surface temperature values for the year 2023 from the <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> object <code class="docutils literal notranslate"><span class="pre">da_celsius</span></code>. As commented before, with the xarray method <code class="docutils literal notranslate"><span class="pre">sel()</span></code>, you can select a data array based on coordinate labels. The coordinate label of interest is <code class="docutils literal notranslate"><span class="pre">year='2023'</span></code>. As we are not doing, for instance, an aggregation operation like the mean over a dimension we will have the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension in the resulting data array. To remove the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension we can use the <code class="docutils literal notranslate"><span class="pre">squeeze</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (time: 1, latitude: 721, longitude: 1440)&gt;
array([[[  0.73760986,   0.73760986,   0.73760986, ...,   0.73760986,
           0.73760986,   0.73760986],
        [  0.7321472 ,   0.7321472 ,   0.7321472 , ...,   0.7321472 ,
           0.7321472 ,   0.7321472 ],
        [  0.72128296,   0.72128296,   0.72128296, ...,   0.72128296,
           0.72128296,   0.72128296],
        ...,
        [-53.12979   , -53.12616   , -53.122543  , ..., -53.14067   ,
         -53.135223  , -53.131607  ],
        [-53.238525  , -53.236725  , -53.23491   , ..., -53.243973  ,
         -53.243973  , -53.242157  ],
        [-53.29471   , -53.29471   , -53.29471   , ..., -53.29471   ,
         -53.29471   , -53.29471   ]]], dtype=float32)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 2023-07-01
Attributes:
    units:      °C
    long_name:  2 metre temperature</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-869382c7-2e7f-428e-983b-f4940eab5ff5' class='xr-array-in' type='checkbox' checked><label for='section-869382c7-2e7f-428e-983b-f4940eab5ff5' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.7376 0.7376 0.7376 0.7376 0.7376 ... -53.29 -53.29 -53.29 -53.29</span></div><div class='xr-array-data'><pre>array([[[  0.73760986,   0.73760986,   0.73760986, ...,   0.73760986,
           0.73760986,   0.73760986],
        [  0.7321472 ,   0.7321472 ,   0.7321472 , ...,   0.7321472 ,
           0.7321472 ,   0.7321472 ],
        [  0.72128296,   0.72128296,   0.72128296, ...,   0.72128296,
           0.72128296,   0.72128296],
        ...,
        [-53.12979   , -53.12616   , -53.122543  , ..., -53.14067   ,
         -53.135223  , -53.131607  ],
        [-53.238525  , -53.236725  , -53.23491   , ..., -53.243973  ,
         -53.243973  , -53.242157  ],
        [-53.29471   , -53.29471   , -53.29471   , ..., -53.29471   ,
         -53.29471   , -53.29471   ]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-81954005-85d5-4205-8168-051169cd3874' class='xr-section-summary-in' type='checkbox'  checked><label for='section-81954005-85d5-4205-8168-051169cd3874' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-46149ceb-4fef-431a-94c9-7a473b3a7aa6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46149ceb-4fef-431a-94c9-7a473b3a7aa6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5292fb40-ff2c-4cdf-9b10-5d66bc5fb6f7' class='xr-var-data-in' type='checkbox'><label for='data-5292fb40-ff2c-4cdf-9b10-5d66bc5fb6f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-dc39387b-fce6-4d31-96f5-b06cbe887424' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dc39387b-fce6-4d31-96f5-b06cbe887424' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27239971-566e-49d4-ae8b-3ffd82e054a8' class='xr-var-data-in' type='checkbox'><label for='data-27239971-566e-49d4-ae8b-3ffd82e054a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-07-01</div><input id='attrs-e5780f4b-58f3-4462-8914-25e53db08ac7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e5780f4b-58f3-4462-8914-25e53db08ac7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c577b52e-631f-4033-9495-ba55f8da17bb' class='xr-var-data-in' type='checkbox'><label for='data-c577b52e-631f-4033-9495-ba55f8da17bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-07-01T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bcd32d02-c451-4f95-8576-553242874d3e' class='xr-section-summary-in' type='checkbox'  ><label for='section-bcd32d02-c451-4f95-8576-553242874d3e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5e49ab8a-a177-4931-87a5-cf585281ddb8' class='xr-index-data-in' type='checkbox'/><label for='index-5e49ab8a-a177-4931-87a5-cf585281ddb8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3a19ab57-882b-464d-a650-0f89fdaa5097' class='xr-index-data-in' type='checkbox'/><label for='index-3a19ab57-882b-464d-a650-0f89fdaa5097' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-474b23d0-126f-4cc4-8478-7142e7428224' class='xr-index-data-in' type='checkbox'/><label for='index-474b23d0-126f-4cc4-8478-7142e7428224' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-07-01&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f71d3ca0-3da8-486f-894d-ede9f10a4d48' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f71d3ca0-3da8-486f-894d-ede9f10a4d48' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>°C</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span> <span class="o">=</span> <span class="n">t2m_july2023</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_july2023</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (latitude: 721, longitude: 1440)&gt;
array([[  0.73760986,   0.73760986,   0.73760986, ...,   0.73760986,
          0.73760986,   0.73760986],
       [  0.7321472 ,   0.7321472 ,   0.7321472 , ...,   0.7321472 ,
          0.7321472 ,   0.7321472 ],
       [  0.72128296,   0.72128296,   0.72128296, ...,   0.72128296,
          0.72128296,   0.72128296],
       ...,
       [-53.12979   , -53.12616   , -53.122543  , ..., -53.14067   ,
        -53.135223  , -53.131607  ],
       [-53.238525  , -53.236725  , -53.23491   , ..., -53.243973  ,
        -53.243973  , -53.242157  ],
       [-53.29471   , -53.29471   , -53.29471   , ..., -53.29471   ,
        -53.29471   , -53.29471   ]], dtype=float32)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    time       datetime64[ns] 2023-07-01
Attributes:
    units:      °C
    long_name:  2 metre temperature</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 721</li><li><span class='xr-has-index'>longitude</span>: 1440</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-11a7c1d8-d27a-40e0-972e-b06839c17469' class='xr-array-in' type='checkbox' checked><label for='section-11a7c1d8-d27a-40e0-972e-b06839c17469' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.7376 0.7376 0.7376 0.7376 0.7376 ... -53.29 -53.29 -53.29 -53.29</span></div><div class='xr-array-data'><pre>array([[  0.73760986,   0.73760986,   0.73760986, ...,   0.73760986,
          0.73760986,   0.73760986],
       [  0.7321472 ,   0.7321472 ,   0.7321472 , ...,   0.7321472 ,
          0.7321472 ,   0.7321472 ],
       [  0.72128296,   0.72128296,   0.72128296, ...,   0.72128296,
          0.72128296,   0.72128296],
       ...,
       [-53.12979   , -53.12616   , -53.122543  , ..., -53.14067   ,
        -53.135223  , -53.131607  ],
       [-53.238525  , -53.236725  , -53.23491   , ..., -53.243973  ,
        -53.243973  , -53.242157  ],
       [-53.29471   , -53.29471   , -53.29471   , ..., -53.29471   ,
        -53.29471   , -53.29471   ]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-c0b9eb8c-08c9-418f-871d-f20ac7b589be' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c0b9eb8c-08c9-418f-871d-f20ac7b589be' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-78966c9e-9021-43b7-9d84-327c5adbe189' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-78966c9e-9021-43b7-9d84-327c5adbe189' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b260965-55aa-4943-89c5-36e9dd32f4a3' class='xr-var-data-in' type='checkbox'><label for='data-8b260965-55aa-4943-89c5-36e9dd32f4a3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-67d33301-ce52-486f-b6ca-057a508a3b93' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-67d33301-ce52-486f-b6ca-057a508a3b93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3745fe5-6e8a-4e73-9d09-a04218371183' class='xr-var-data-in' type='checkbox'><label for='data-b3745fe5-6e8a-4e73-9d09-a04218371183' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-07-01</div><input id='attrs-1ef89c1e-6251-448a-b720-62c1e53f40f7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1ef89c1e-6251-448a-b720-62c1e53f40f7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d441268a-d577-4d42-b0ce-7fc88aa4ee64' class='xr-var-data-in' type='checkbox'><label for='data-d441268a-d577-4d42-b0ce-7fc88aa4ee64' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2023-07-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-54817dc1-724d-4dd6-a12e-47977d9a15ad' class='xr-section-summary-in' type='checkbox'  ><label for='section-54817dc1-724d-4dd6-a12e-47977d9a15ad' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-df4f4fe0-bf87-4c82-8fb7-a6f40175876e' class='xr-index-data-in' type='checkbox'/><label for='index-df4f4fe0-bf87-4c82-8fb7-a6f40175876e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5,
              -178.25,  -178.0, -177.75,
              ...
                177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,
               179.25,   179.5,  179.75],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d78f86c9-03bd-4fce-bd49-c3eea25771b3' class='xr-index-data-in' type='checkbox'/><label for='index-d78f86c9-03bd-4fce-bd49-c3eea25771b3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,
                88.0,  87.75,
              ...
              -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5,
              -89.75,  -90.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=721))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c805fd10-0ddb-4d0d-b1d4-57ca4eb0b75e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c805fd10-0ddb-4d0d-b1d4-57ca4eb0b75e' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>°C</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The anomaly will be the difference between <code class="docutils literal notranslate"><span class="pre">t2m_july2023</span></code> and <code class="docutils literal notranslate"><span class="pre">t2m_ref_per</span></code>. A positive value means July 2023 is above the expected mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">anom</span> <span class="o">=</span> <span class="n">t2m_july2023</span> <span class="o">-</span> <span class="n">t2m_ref_per</span>
</pre></div>
</div>
</div>
</div>
<p>The previous operation results in the anomaly on each longitude and latitude location stored in the <code class="docutils literal notranslate"><span class="pre">anom</span></code> data array. We can plot this in a map to check where the anomaly was positive (July 2023 warmer than the climatology) or negative (July 2023 colder than the climatology). This time we will create the plot using the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> libraries.</p>
<p>The code below is briefly commented in the code cell. The key part is <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.pcolormesh.html"><code class="docutils literal notranslate"><span class="pre">plt.pcolormesh</span></code></a>, which is used to plot the 2D data array on each (longitude, latitude) grid cell. The colours are defined using the <code class="docutils literal notranslate"><span class="pre">RdBr_r</span></code> colormap in a range between -12 and 12 (ºC). This is a <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html#diverging">diverging colormap</a> that goes from red to blue but in reverse order, this is why it has the <code class="docutils literal notranslate"><span class="pre">_r</span></code> suffix. So, in this specific case, -12 degrees is shown in dark blue, 12 in dark red and 0, equal to the climate normal, in white.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure panel and the map using the Cartopy PlateCarree projection</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
    <span class="n">anom</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> 
    <span class="n">anom</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> 
    <span class="n">anom</span><span class="p">,</span> 
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span> 
    <span class="n">vmax</span><span class="o">=</span><span class="mi">12</span>
<span class="p">)</span> 

<span class="c1"># Set the figure title, add lat/lon grid and coastlines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature anomaly for July 2023 (with respect to 1991-2020 July mean)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span>
    <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span>
<span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Specify the colorbar and set a label for the colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Temperature anomaly&#39;</span><span class="p">)</span> 

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;near_sfc_t2m_anomaly_july2023.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\cxcs\AppData\Local\anaconda3\lib\site-packages\cartopy\io\__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_physical/ne_110m_coastline.zip
  warnings.warn(f&#39;Downloading: {url}&#39;, DownloadWarning)
</pre></div>
</div>
<img alt="_images/37561381c9dd00894399a4b78c2d7162ff5c0d389e3271ba515dcb01210e9272.png" src="_images/37561381c9dd00894399a4b78c2d7162ff5c0d389e3271ba515dcb01210e9272.png" />
</div>
</div>
</section>
<section id="view-time-series-and-analyse-surface-temperature-trends">
<h2>4. View time series and analyse surface temperature trends<a class="headerlink" href="#view-time-series-and-analyse-surface-temperature-trends" title="Permalink to this heading">#</a></h2>
<p>Now let us view the time series from 1940 to 2023 averaged over the entire region. To do this we need to average <code class="docutils literal notranslate"><span class="pre">da_celsius</span></code> over the latitude and longitude dimensions. A very important consideration however is that the gridded data cells do not all correspond to the same areas. The size covered by each data point on the model grid varies as a function of latitude. We need to take this into account when calculating spatial averages.</p>
<p>One way to do this is to use the cosine of the latitude as a proxy for the varying sizes.</p>
<p>Another way would be to use <a class="reference external" href="https://stackoverflow.com/a/65353505"><strong>cdo</strong> that would take into account the varying cell area</a>. The command to do this is <code class="docutils literal notranslate"><span class="pre">cdo</span> <span class="pre">fldmean</span> <span class="pre">in.nc</span> <span class="pre">out.nc</span></code>.</p>
<p>In order to keep things simple we will stick to the solution using <code class="docutils literal notranslate"><span class="pre">xarray</span></code>.</p>
<p>First we calculate the weights by using the cosine of the latitude (in radians), then we apply these weights to the data array with the xarray method <code class="docutils literal notranslate"><span class="pre">weighted()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da_celsius</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">da_celsius_weighted</span> <span class="o">=</span> <span class="n">da_celsius</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we calculate the weighted mean so we will have a time series with the spatially averaged July <code class="docutils literal notranslate"><span class="pre">t2m</span></code> from 1940 to 2023.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global</span> <span class="o">=</span> <span class="n">da_celsius_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s look at the new data array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (time: 84)&gt;
array([15.77934  , 15.686103 , 15.504397 , 15.487048 , 15.6968975,
       15.581223 , 15.651366 , 15.686947 , 15.634245 , 15.671638 ,
       15.516496 , 15.5618305, 15.688131 , 15.727703 , 15.497699 ,
       15.466434 , 15.449099 , 15.652505 , 15.743765 , 15.700156 ,
       15.6520195, 15.736965 , 15.687653 , 15.801527 , 15.725807 ,
       15.596119 , 15.820597 , 15.70142  , 15.635535 , 15.702868 ,
       15.712927 , 15.525745 , 15.812478 , 15.777739 , 15.529215 ,
       15.500252 , 15.572601 , 15.78937  , 15.741149 , 15.731902 ,
       16.02006  , 15.987883 , 15.89143  , 15.912935 , 15.697611 ,
       15.693814 , 15.780967 , 16.140322 , 16.032246 , 15.991822 ,
       16.151453 , 16.181696 , 15.76771  , 15.878968 , 15.954252 ,
       16.124987 , 16.022484 , 16.056824 , 16.35066  , 16.026937 ,
       15.991144 , 16.208387 , 16.262844 , 16.181667 , 15.953027 ,
       16.3142   , 16.23219  , 16.235216 , 16.20543  , 16.36655  ,
       16.280819 , 16.371893 , 16.269135 , 16.203815 , 16.294592 ,
       16.38251  , 16.589348 , 16.494429 , 16.50715  , 16.625692 ,
       16.554085 , 16.559622 , 16.606188 , 16.953045 ], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1940-07-01 1941-07-01 ... 2023-07-01</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 84</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3af552d2-d322-4e8b-b813-b90f9a19360a' class='xr-array-in' type='checkbox' checked><label for='section-3af552d2-d322-4e8b-b813-b90f9a19360a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>15.78 15.69 15.5 15.49 15.7 15.58 ... 16.63 16.55 16.56 16.61 16.95</span></div><div class='xr-array-data'><pre>array([15.77934  , 15.686103 , 15.504397 , 15.487048 , 15.6968975,
       15.581223 , 15.651366 , 15.686947 , 15.634245 , 15.671638 ,
       15.516496 , 15.5618305, 15.688131 , 15.727703 , 15.497699 ,
       15.466434 , 15.449099 , 15.652505 , 15.743765 , 15.700156 ,
       15.6520195, 15.736965 , 15.687653 , 15.801527 , 15.725807 ,
       15.596119 , 15.820597 , 15.70142  , 15.635535 , 15.702868 ,
       15.712927 , 15.525745 , 15.812478 , 15.777739 , 15.529215 ,
       15.500252 , 15.572601 , 15.78937  , 15.741149 , 15.731902 ,
       16.02006  , 15.987883 , 15.89143  , 15.912935 , 15.697611 ,
       15.693814 , 15.780967 , 16.140322 , 16.032246 , 15.991822 ,
       16.151453 , 16.181696 , 15.76771  , 15.878968 , 15.954252 ,
       16.124987 , 16.022484 , 16.056824 , 16.35066  , 16.026937 ,
       15.991144 , 16.208387 , 16.262844 , 16.181667 , 15.953027 ,
       16.3142   , 16.23219  , 16.235216 , 16.20543  , 16.36655  ,
       16.280819 , 16.371893 , 16.269135 , 16.203815 , 16.294592 ,
       16.38251  , 16.589348 , 16.494429 , 16.50715  , 16.625692 ,
       16.554085 , 16.559622 , 16.606188 , 16.953045 ], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-12c324f8-e44e-4eff-8504-b0b4300d655b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12c324f8-e44e-4eff-8504-b0b4300d655b' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-07-01 ... 2023-07-01</div><input id='attrs-5624afc1-3269-4e28-823a-61edc17a50fa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5624afc1-3269-4e28-823a-61edc17a50fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a6cd28e-d1f3-4c91-8b14-51b86c9fe221' class='xr-var-data-in' type='checkbox'><label for='data-2a6cd28e-d1f3-4c91-8b14-51b86c9fe221' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1942-07-01T00:00:00.000000000&#x27;, &#x27;1943-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1946-07-01T00:00:00.000000000&#x27;, &#x27;1947-07-01T00:00:00.000000000&#x27;,
       &#x27;1948-07-01T00:00:00.000000000&#x27;, &#x27;1949-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1954-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1958-07-01T00:00:00.000000000&#x27;, &#x27;1959-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1962-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1965-07-01T00:00:00.000000000&#x27;,
       &#x27;1966-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1969-07-01T00:00:00.000000000&#x27;,
       &#x27;1970-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1975-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1977-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1979-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;1982-07-01T00:00:00.000000000&#x27;, &#x27;1983-07-01T00:00:00.000000000&#x27;,
       &#x27;1984-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1986-07-01T00:00:00.000000000&#x27;, &#x27;1987-07-01T00:00:00.000000000&#x27;,
       &#x27;1988-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1990-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1993-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1996-07-01T00:00:00.000000000&#x27;, &#x27;1997-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;1999-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;2001-07-01T00:00:00.000000000&#x27;,
       &#x27;2002-07-01T00:00:00.000000000&#x27;, &#x27;2003-07-01T00:00:00.000000000&#x27;,
       &#x27;2004-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;2006-07-01T00:00:00.000000000&#x27;, &#x27;2007-07-01T00:00:00.000000000&#x27;,
       &#x27;2008-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2010-07-01T00:00:00.000000000&#x27;, &#x27;2011-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2013-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2017-07-01T00:00:00.000000000&#x27;,
       &#x27;2018-07-01T00:00:00.000000000&#x27;, &#x27;2019-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2022-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c07a5c5a-920d-424e-b83a-020c6fdeac05' class='xr-section-summary-in' type='checkbox'  ><label for='section-c07a5c5a-920d-424e-b83a-020c6fdeac05' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-16c9f636-e356-481d-87fe-91f56e1883b3' class='xr-index-data-in' type='checkbox'/><label for='index-16c9f636-e356-481d-87fe-91f56e1883b3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-07-01&#x27;, &#x27;1941-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1943-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1945-07-01&#x27;, &#x27;1946-07-01&#x27;, &#x27;1947-07-01&#x27;,
               &#x27;1948-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1951-07-01&#x27;,
               &#x27;1952-07-01&#x27;, &#x27;1953-07-01&#x27;, &#x27;1954-07-01&#x27;, &#x27;1955-07-01&#x27;,
               &#x27;1956-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1958-07-01&#x27;, &#x27;1959-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1963-07-01&#x27;,
               &#x27;1964-07-01&#x27;, &#x27;1965-07-01&#x27;, &#x27;1966-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1968-07-01&#x27;, &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1972-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1974-07-01&#x27;, &#x27;1975-07-01&#x27;,
               &#x27;1976-07-01&#x27;, &#x27;1977-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1979-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;,
               &#x27;1984-07-01&#x27;, &#x27;1985-07-01&#x27;, &#x27;1986-07-01&#x27;, &#x27;1987-07-01&#x27;,
               &#x27;1988-07-01&#x27;, &#x27;1989-07-01&#x27;, &#x27;1990-07-01&#x27;, &#x27;1991-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1993-07-01&#x27;, &#x27;1994-07-01&#x27;, &#x27;1995-07-01&#x27;,
               &#x27;1996-07-01&#x27;, &#x27;1997-07-01&#x27;, &#x27;1998-07-01&#x27;, &#x27;1999-07-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2002-07-01&#x27;, &#x27;2003-07-01&#x27;,
               &#x27;2004-07-01&#x27;, &#x27;2005-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;,
               &#x27;2008-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2011-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2019-07-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a23628a2-a8a8-492a-a300-ecd19ca87a26' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a23628a2-a8a8-492a-a300-ecd19ca87a26' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>We will calculate the climatology for this global spatially averaged July <code class="docutils literal notranslate"><span class="pre">t2m</span></code>. This value will be used later to check which years have global average 2m temperature above or below the climatology.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global_ref_per</span> <span class="o">=</span> <span class="n">t2m_global</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">t2m_global_ref_per</span><span class="o">.</span><span class="n">values</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> </span><span class="se">\N{DEGREE SIGN}</span><span class="s1">C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.23 °C
</pre></div>
</div>
</div>
</div>
<p>We will create a constant array with the climatology value that has the same length as the time series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_clim</span> <span class="o">=</span> <span class="n">t2m_global_ref_per</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s plot the mean value since 1940. The values below the climatology will be highlighted in light blue while the values above the climatology will be highlighted in red. Code is commented in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure panel and the axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># we use the xarray plot method passing the axes we want to use</span>
<span class="c1"># to plot the global time series from 1940 to 2023</span>
<span class="n">t2m_global</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># we use the t2m_clim variable to plot a horizontal line</span>
<span class="c1"># with the global climate normal value (1991-2020)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">t2m_clim</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># In order to highlight years above or below the global climate value</span>
<span class="c1"># we use two times the fill_between method that fills the area between two lines</span>
<span class="c1"># The first one is for values below the global climate normal in &#39;mediumslateblue&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">t2m_global</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> 
    <span class="n">t2m_global</span><span class="p">,</span> 
    <span class="n">t2m_clim</span><span class="p">,</span> 
    <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">t2m_global</span> <span class="o">&lt;</span> <span class="n">t2m_clim</span><span class="p">),</span> 
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumslateblue&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># The second one is for values above the global climate normal in &#39;tomato&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">t2m_global</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> 
    <span class="n">t2m_global</span><span class="p">,</span> 
    <span class="n">t2m_clim</span><span class="p">,</span> 
    <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">t2m_global</span> <span class="o">&gt;</span> <span class="n">t2m_clim</span><span class="p">),</span> 
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tomato&#39;</span><span class="p">,</span> 
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;near_sfc_t2m_global_avg_july.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PolyCollection at 0x2d39849f8b0&gt;
</pre></div>
</div>
<img alt="_images/c0e1ab7ed6954fb6ff359eb452c1c5ed4d393e47963b05660546675a18097c44.png" src="_images/c0e1ab7ed6954fb6ff359eb452c1c5ed4d393e47963b05660546675a18097c44.png" />
</div>
</div>
<p>Could you try a similar figure but using the anomalies (<em>“monthly value” - “1991-2020 climatological value”</em>) instead of the spatially aggregated average monthly values?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s order the months from colder to warmer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global_sorted</span> <span class="o">=</span> <span class="n">t2m_global</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">t2m_global</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s have a look to the result and check if it is sorted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2m_global_sorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;t2m&#x27; (time: 84)&gt;
array([15.449099 , 15.466434 , 15.487048 , 15.497699 , 15.500252 ,
       15.504397 , 15.516496 , 15.525745 , 15.529215 , 15.5618305,
       15.572601 , 15.581223 , 15.596119 , 15.634245 , 15.635535 ,
       15.651366 , 15.6520195, 15.652505 , 15.671638 , 15.686103 ,
       15.686947 , 15.687653 , 15.688131 , 15.693814 , 15.6968975,
       15.697611 , 15.700156 , 15.70142  , 15.702868 , 15.712927 ,
       15.725807 , 15.727703 , 15.731902 , 15.736965 , 15.741149 ,
       15.743765 , 15.76771  , 15.777739 , 15.77934  , 15.780967 ,
       15.78937  , 15.801527 , 15.812478 , 15.820597 , 15.878968 ,
       15.89143  , 15.912935 , 15.953027 , 15.954252 , 15.987883 ,
       15.991144 , 15.991822 , 16.02006  , 16.022484 , 16.026937 ,
       16.032246 , 16.056824 , 16.124987 , 16.140322 , 16.151453 ,
       16.181667 , 16.181696 , 16.203815 , 16.20543  , 16.208387 ,
       16.23219  , 16.235216 , 16.262844 , 16.269135 , 16.280819 ,
       16.294592 , 16.3142   , 16.35066  , 16.36655  , 16.371893 ,
       16.38251  , 16.494429 , 16.50715  , 16.554085 , 16.559622 ,
       16.589348 , 16.606188 , 16.625692 , 16.953045 ], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 1956-07-01 1955-07-01 ... 2023-07-01</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'t2m'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 84</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f8fc2332-bdab-476d-8500-285111301186' class='xr-array-in' type='checkbox' checked><label for='section-f8fc2332-bdab-476d-8500-285111301186' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>15.45 15.47 15.49 15.5 15.5 15.5 ... 16.56 16.59 16.61 16.63 16.95</span></div><div class='xr-array-data'><pre>array([15.449099 , 15.466434 , 15.487048 , 15.497699 , 15.500252 ,
       15.504397 , 15.516496 , 15.525745 , 15.529215 , 15.5618305,
       15.572601 , 15.581223 , 15.596119 , 15.634245 , 15.635535 ,
       15.651366 , 15.6520195, 15.652505 , 15.671638 , 15.686103 ,
       15.686947 , 15.687653 , 15.688131 , 15.693814 , 15.6968975,
       15.697611 , 15.700156 , 15.70142  , 15.702868 , 15.712927 ,
       15.725807 , 15.727703 , 15.731902 , 15.736965 , 15.741149 ,
       15.743765 , 15.76771  , 15.777739 , 15.77934  , 15.780967 ,
       15.78937  , 15.801527 , 15.812478 , 15.820597 , 15.878968 ,
       15.89143  , 15.912935 , 15.953027 , 15.954252 , 15.987883 ,
       15.991144 , 15.991822 , 16.02006  , 16.022484 , 16.026937 ,
       16.032246 , 16.056824 , 16.124987 , 16.140322 , 16.151453 ,
       16.181667 , 16.181696 , 16.203815 , 16.20543  , 16.208387 ,
       16.23219  , 16.235216 , 16.262844 , 16.269135 , 16.280819 ,
       16.294592 , 16.3142   , 16.35066  , 16.36655  , 16.371893 ,
       16.38251  , 16.494429 , 16.50715  , 16.554085 , 16.559622 ,
       16.589348 , 16.606188 , 16.625692 , 16.953045 ], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-d20c40d3-0a8f-4b58-873b-ddbadbceea6e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d20c40d3-0a8f-4b58-873b-ddbadbceea6e' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1956-07-01 ... 2023-07-01</div><input id='attrs-70170345-9c4c-49d7-ab59-c7c29a051840' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70170345-9c4c-49d7-ab59-c7c29a051840' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a04858d0-1270-4f0d-80fc-15a17b90be18' class='xr-var-data-in' type='checkbox'><label for='data-a04858d0-1270-4f0d-80fc-15a17b90be18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1956-07-01T00:00:00.000000000&#x27;, &#x27;1955-07-01T00:00:00.000000000&#x27;,
       &#x27;1943-07-01T00:00:00.000000000&#x27;, &#x27;1954-07-01T00:00:00.000000000&#x27;,
       &#x27;1975-07-01T00:00:00.000000000&#x27;, &#x27;1942-07-01T00:00:00.000000000&#x27;,
       &#x27;1950-07-01T00:00:00.000000000&#x27;, &#x27;1971-07-01T00:00:00.000000000&#x27;,
       &#x27;1974-07-01T00:00:00.000000000&#x27;, &#x27;1951-07-01T00:00:00.000000000&#x27;,
       &#x27;1976-07-01T00:00:00.000000000&#x27;, &#x27;1945-07-01T00:00:00.000000000&#x27;,
       &#x27;1965-07-01T00:00:00.000000000&#x27;, &#x27;1948-07-01T00:00:00.000000000&#x27;,
       &#x27;1968-07-01T00:00:00.000000000&#x27;, &#x27;1946-07-01T00:00:00.000000000&#x27;,
       &#x27;1960-07-01T00:00:00.000000000&#x27;, &#x27;1957-07-01T00:00:00.000000000&#x27;,
       &#x27;1949-07-01T00:00:00.000000000&#x27;, &#x27;1941-07-01T00:00:00.000000000&#x27;,
       &#x27;1947-07-01T00:00:00.000000000&#x27;, &#x27;1962-07-01T00:00:00.000000000&#x27;,
       &#x27;1952-07-01T00:00:00.000000000&#x27;, &#x27;1985-07-01T00:00:00.000000000&#x27;,
       &#x27;1944-07-01T00:00:00.000000000&#x27;, &#x27;1984-07-01T00:00:00.000000000&#x27;,
       &#x27;1959-07-01T00:00:00.000000000&#x27;, &#x27;1967-07-01T00:00:00.000000000&#x27;,
       &#x27;1969-07-01T00:00:00.000000000&#x27;, &#x27;1970-07-01T00:00:00.000000000&#x27;,
       &#x27;1964-07-01T00:00:00.000000000&#x27;, &#x27;1953-07-01T00:00:00.000000000&#x27;,
       &#x27;1979-07-01T00:00:00.000000000&#x27;, &#x27;1961-07-01T00:00:00.000000000&#x27;,
       &#x27;1978-07-01T00:00:00.000000000&#x27;, &#x27;1958-07-01T00:00:00.000000000&#x27;,
       &#x27;1992-07-01T00:00:00.000000000&#x27;, &#x27;1973-07-01T00:00:00.000000000&#x27;,
       &#x27;1940-07-01T00:00:00.000000000&#x27;, &#x27;1986-07-01T00:00:00.000000000&#x27;,
       &#x27;1977-07-01T00:00:00.000000000&#x27;, &#x27;1963-07-01T00:00:00.000000000&#x27;,
       &#x27;1972-07-01T00:00:00.000000000&#x27;, &#x27;1966-07-01T00:00:00.000000000&#x27;,
       &#x27;1993-07-01T00:00:00.000000000&#x27;, &#x27;1982-07-01T00:00:00.000000000&#x27;,
       &#x27;1983-07-01T00:00:00.000000000&#x27;, &#x27;2004-07-01T00:00:00.000000000&#x27;,
       &#x27;1994-07-01T00:00:00.000000000&#x27;, &#x27;1981-07-01T00:00:00.000000000&#x27;,
       &#x27;2000-07-01T00:00:00.000000000&#x27;, &#x27;1989-07-01T00:00:00.000000000&#x27;,
       &#x27;1980-07-01T00:00:00.000000000&#x27;, &#x27;1996-07-01T00:00:00.000000000&#x27;,
       &#x27;1999-07-01T00:00:00.000000000&#x27;, &#x27;1988-07-01T00:00:00.000000000&#x27;,
       &#x27;1997-07-01T00:00:00.000000000&#x27;, &#x27;1995-07-01T00:00:00.000000000&#x27;,
       &#x27;1987-07-01T00:00:00.000000000&#x27;, &#x27;1990-07-01T00:00:00.000000000&#x27;,
       &#x27;2003-07-01T00:00:00.000000000&#x27;, &#x27;1991-07-01T00:00:00.000000000&#x27;,
       &#x27;2013-07-01T00:00:00.000000000&#x27;, &#x27;2008-07-01T00:00:00.000000000&#x27;,
       &#x27;2001-07-01T00:00:00.000000000&#x27;, &#x27;2006-07-01T00:00:00.000000000&#x27;,
       &#x27;2007-07-01T00:00:00.000000000&#x27;, &#x27;2002-07-01T00:00:00.000000000&#x27;,
       &#x27;2012-07-01T00:00:00.000000000&#x27;, &#x27;2010-07-01T00:00:00.000000000&#x27;,
       &#x27;2014-07-01T00:00:00.000000000&#x27;, &#x27;2005-07-01T00:00:00.000000000&#x27;,
       &#x27;1998-07-01T00:00:00.000000000&#x27;, &#x27;2009-07-01T00:00:00.000000000&#x27;,
       &#x27;2011-07-01T00:00:00.000000000&#x27;, &#x27;2015-07-01T00:00:00.000000000&#x27;,
       &#x27;2017-07-01T00:00:00.000000000&#x27;, &#x27;2018-07-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2016-07-01T00:00:00.000000000&#x27;, &#x27;2022-07-01T00:00:00.000000000&#x27;,
       &#x27;2019-07-01T00:00:00.000000000&#x27;, &#x27;2023-07-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1a846710-3664-48e5-9595-08207f5abe53' class='xr-section-summary-in' type='checkbox'  ><label for='section-1a846710-3664-48e5-9595-08207f5abe53' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1fe1b65a-35d4-47f6-8238-f8da5bcc9c07' class='xr-index-data-in' type='checkbox'/><label for='index-1fe1b65a-35d4-47f6-8238-f8da5bcc9c07' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1956-07-01&#x27;, &#x27;1955-07-01&#x27;, &#x27;1943-07-01&#x27;, &#x27;1954-07-01&#x27;,
               &#x27;1975-07-01&#x27;, &#x27;1942-07-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1971-07-01&#x27;,
               &#x27;1974-07-01&#x27;, &#x27;1951-07-01&#x27;, &#x27;1976-07-01&#x27;, &#x27;1945-07-01&#x27;,
               &#x27;1965-07-01&#x27;, &#x27;1948-07-01&#x27;, &#x27;1968-07-01&#x27;, &#x27;1946-07-01&#x27;,
               &#x27;1960-07-01&#x27;, &#x27;1957-07-01&#x27;, &#x27;1949-07-01&#x27;, &#x27;1941-07-01&#x27;,
               &#x27;1947-07-01&#x27;, &#x27;1962-07-01&#x27;, &#x27;1952-07-01&#x27;, &#x27;1985-07-01&#x27;,
               &#x27;1944-07-01&#x27;, &#x27;1984-07-01&#x27;, &#x27;1959-07-01&#x27;, &#x27;1967-07-01&#x27;,
               &#x27;1969-07-01&#x27;, &#x27;1970-07-01&#x27;, &#x27;1964-07-01&#x27;, &#x27;1953-07-01&#x27;,
               &#x27;1979-07-01&#x27;, &#x27;1961-07-01&#x27;, &#x27;1978-07-01&#x27;, &#x27;1958-07-01&#x27;,
               &#x27;1992-07-01&#x27;, &#x27;1973-07-01&#x27;, &#x27;1940-07-01&#x27;, &#x27;1986-07-01&#x27;,
               &#x27;1977-07-01&#x27;, &#x27;1963-07-01&#x27;, &#x27;1972-07-01&#x27;, &#x27;1966-07-01&#x27;,
               &#x27;1993-07-01&#x27;, &#x27;1982-07-01&#x27;, &#x27;1983-07-01&#x27;, &#x27;2004-07-01&#x27;,
               &#x27;1994-07-01&#x27;, &#x27;1981-07-01&#x27;, &#x27;2000-07-01&#x27;, &#x27;1989-07-01&#x27;,
               &#x27;1980-07-01&#x27;, &#x27;1996-07-01&#x27;, &#x27;1999-07-01&#x27;, &#x27;1988-07-01&#x27;,
               &#x27;1997-07-01&#x27;, &#x27;1995-07-01&#x27;, &#x27;1987-07-01&#x27;, &#x27;1990-07-01&#x27;,
               &#x27;2003-07-01&#x27;, &#x27;1991-07-01&#x27;, &#x27;2013-07-01&#x27;, &#x27;2008-07-01&#x27;,
               &#x27;2001-07-01&#x27;, &#x27;2006-07-01&#x27;, &#x27;2007-07-01&#x27;, &#x27;2002-07-01&#x27;,
               &#x27;2012-07-01&#x27;, &#x27;2010-07-01&#x27;, &#x27;2014-07-01&#x27;, &#x27;2005-07-01&#x27;,
               &#x27;1998-07-01&#x27;, &#x27;2009-07-01&#x27;, &#x27;2011-07-01&#x27;, &#x27;2015-07-01&#x27;,
               &#x27;2017-07-01&#x27;, &#x27;2018-07-01&#x27;, &#x27;2020-07-01&#x27;, &#x27;2021-07-01&#x27;,
               &#x27;2016-07-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2019-07-01&#x27;, &#x27;2023-07-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-07c6ee2a-a21d-4a7c-ae2f-9342966c21d3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-07c6ee2a-a21d-4a7c-ae2f-9342966c21d3' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>If we plot the ranking from colder to warmer including also the climate normal we’ll see the following. As before, code is commented in the code cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure panel and the axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># We create a label for the &#39;x&#39; axis using each year</span>
<span class="n">xlabel</span> <span class="o">=</span> <span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[Y]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1970</span> <span class="c1"># years</span>

<span class="c1"># We create also the location for each of the labels in the &#39;x&#39; axis</span>
<span class="n">xpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xlabel</span><span class="p">))</span>

<span class="c1"># We extract the sorted values to be used as the &#39;y&#39; values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># We create a bar plot of all the bars using &#39;tomato&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tomato&#39;</span><span class="p">)</span>

<span class="c1"># We place all the labels for the &#39;x&#39; axis rotated 90º</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># Now we create a mask with the values below the climate normal</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">t2m_clim</span>

<span class="c1"># and plot again those values below the climate normal but now using the &#39;mediumslateblue&#39; color</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xpos</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mediumslateblue&#39;</span><span class="p">)</span>

<span class="c1"># We limit the range of the &#39;y&#39; axis to the (minimum - 0.25) and the (maximum + 0.25)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">t2m_global_sorted</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># we add a horizontal line to plot the climate normal.</span>
<span class="c1">#ax.plot(range(len(clim_repeated)), clim_repeated, &#39;-.&#39;, linewidth=0.5, color=&#39;black&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">t2m_clim</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># This function is very interesting as it does magic to prettify the final result :-)</span>
<span class="c1"># https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.tight_layout.html</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;near_sfc_t2m_global_avg_july_sorted_barplot.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c190778b99a6a0bc08ff9e6364694a8b1ff86e67608b8ca4f52c8446ad794ec1.png" src="_images/c190778b99a6a0bc08ff9e6364694a8b1ff86e67608b8ca4f52c8446ad794ec1.png" />
</div>
</div>
</section>
<section id="view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends">
<h2>5. View time series and analyse North Atlantic sea surface temperature trends<a class="headerlink" href="#view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends" title="Permalink to this heading">#</a></h2>
<section id="this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data">
<h3>This is a new exercise. In this part of the tutorial we will be working with monthly sea surface temperature (SST) data.<a class="headerlink" href="#this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data" title="Permalink to this heading">#</a></h3>
<p>First we need to download a new dataset. As before, we need to specify what product type, variables, temporal and geographic coverage we are interested in. These can all be selected in the <strong>“Download data”</strong> tab in the CDS (<a class="reference external" href="https://cds-beta.climate.copernicus.eu">https://cds-beta.climate.copernicus.eu</a>). In this tab a form appears in which we select the following parameters to download:</p>
<ul class="simple">
<li><p>Product type: <code class="docutils literal notranslate"><span class="pre">Monthly</span> <span class="pre">averaged</span> <span class="pre">reanalysis</span></code></p></li>
<li><p>Variable: <code class="docutils literal notranslate"><span class="pre">sea_surface_temperature</span></code></p></li>
<li><p>Year: <code class="docutils literal notranslate"><span class="pre">1991</span> <span class="pre">to</span> <span class="pre">2023</span></code></p></li>
<li><p>Month: <code class="docutils literal notranslate"><span class="pre">all</span></code></p></li>
<li><p>Time: <code class="docutils literal notranslate"><span class="pre">00:00</span></code> (default)</p></li>
<li><p>Geographical area: <code class="docutils literal notranslate"><span class="pre">60,</span> <span class="pre">-40,</span> <span class="pre">0,</span> <span class="pre">0</span></code></p></li>
<li><p>Format: <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code></p></li>
</ul>
<p>Below you can see the API request:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;reanalysis-era5-single-levels-monthly-means&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;data_format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf_legacy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;sea_surface_temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_averaged_reanalysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;1991&#39;</span><span class="p">,</span> <span class="s1">&#39;1992&#39;</span><span class="p">,</span> <span class="s1">&#39;1993&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1994&#39;</span><span class="p">,</span> <span class="s1">&#39;1995&#39;</span><span class="p">,</span> <span class="s1">&#39;1996&#39;</span><span class="p">,</span>
            <span class="s1">&#39;1997&#39;</span><span class="p">,</span> <span class="s1">&#39;1998&#39;</span><span class="p">,</span> <span class="s1">&#39;1999&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2001&#39;</span><span class="p">,</span> <span class="s1">&#39;2002&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2003&#39;</span><span class="p">,</span> <span class="s1">&#39;2004&#39;</span><span class="p">,</span> <span class="s1">&#39;2005&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2009&#39;</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2011&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span>
            <span class="s1">&#39;2021&#39;</span><span class="p">,</span> <span class="s1">&#39;2022&#39;</span><span class="p">,</span> <span class="s1">&#39;2023&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;01&#39;</span><span class="p">,</span> <span class="s1">&#39;02&#39;</span><span class="p">,</span> <span class="s1">&#39;03&#39;</span><span class="p">,</span>
            <span class="s1">&#39;04&#39;</span><span class="p">,</span> <span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;06&#39;</span><span class="p">,</span>
            <span class="s1">&#39;07&#39;</span><span class="p">,</span> <span class="s1">&#39;08&#39;</span><span class="p">,</span> <span class="s1">&#39;09&#39;</span><span class="p">,</span>
            <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">sst_(NAtl)_monthly_1991-2023.nc&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-16 21:49:25,957 INFO Welcome to the CDS
2024-06-16 21:49:25,972 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels-monthly-means
2024-06-16 21:49:26,095 INFO Request is queued
2024-06-16 21:49:27,162 INFO Request is running
2024-06-16 21:51:20,057 INFO Request is completed
2024-06-16 21:51:20,057 INFO Downloading https://download-0017.copernicus-climate.eu/cache-compute-0017/cache/data0/adaptor.mars.internal-1718567441.1459908-14651-8-cf3f88ba-9a09-4dac-a81f-1e02017d839d.nc to ./DATA-2024-06-16/sst_(NAtl)_monthly_1991-2023.nc (29.3M)
2024-06-16 21:51:33,978 INFO Download rate 2.1M/s                                                                      
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result(content_length=30734656,content_type=application/x-netcdf,location=https://download-0017.copernicus-climate.eu/cache-compute-0017/cache/data0/adaptor.mars.internal-1718567441.1459908-14651-8-cf3f88ba-9a09-4dac-a81f-1e02017d839d.nc)
</pre></div>
</div>
</div>
</div>
<p>Let’s do some work with this new dataset. First of all, let’s read it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">sst_(NAtl)_monthly_1991-2023.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can have a look at the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (longitude: 161, latitude: 241, time: 396)
Coordinates:
  * longitude  (longitude) float32 -40.0 -39.75 -39.5 -39.25 ... -0.5 -0.25 0.0
  * latitude   (latitude) float32 60.0 59.75 59.5 59.25 ... 0.75 0.5 0.25 0.0
  * time       (time) datetime64[ns] 1991-01-01 1991-02-01 ... 2023-12-01
Data variables:
    sst        (time, latitude, longitude) float32 ...
Attributes:
    Conventions:  CF-1.6
    history:      2024-06-16 19:50:42 GMT by grib_to_netcdf-2.28.1: /opt/ecmw...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-9f08d2d7-e248-410e-a652-26a69f87ae80' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9f08d2d7-e248-410e-a652-26a69f87ae80' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>longitude</span>: 161</li><li><span class='xr-has-index'>latitude</span>: 241</li><li><span class='xr-has-index'>time</span>: 396</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-358dec94-224d-4d7e-9c05-ddf7b544d68c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-358dec94-224d-4d7e-9c05-ddf7b544d68c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-40.0 -39.75 -39.5 ... -0.25 0.0</div><input id='attrs-bb1036b8-1a04-4991-bc98-f1468baf844d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb1036b8-1a04-4991-bc98-f1468baf844d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae38c256-950b-496c-a00b-7a2cb0cc516f' class='xr-var-data-in' type='checkbox'><label for='data-ae38c256-950b-496c-a00b-7a2cb0cc516f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-40.  , -39.75, -39.5 , -39.25, -39.  , -38.75, -38.5 , -38.25, -38.  ,
       -37.75, -37.5 , -37.25, -37.  , -36.75, -36.5 , -36.25, -36.  , -35.75,
       -35.5 , -35.25, -35.  , -34.75, -34.5 , -34.25, -34.  , -33.75, -33.5 ,
       -33.25, -33.  , -32.75, -32.5 , -32.25, -32.  , -31.75, -31.5 , -31.25,
       -31.  , -30.75, -30.5 , -30.25, -30.  , -29.75, -29.5 , -29.25, -29.  ,
       -28.75, -28.5 , -28.25, -28.  , -27.75, -27.5 , -27.25, -27.  , -26.75,
       -26.5 , -26.25, -26.  , -25.75, -25.5 , -25.25, -25.  , -24.75, -24.5 ,
       -24.25, -24.  , -23.75, -23.5 , -23.25, -23.  , -22.75, -22.5 , -22.25,
       -22.  , -21.75, -21.5 , -21.25, -21.  , -20.75, -20.5 , -20.25, -20.  ,
       -19.75, -19.5 , -19.25, -19.  , -18.75, -18.5 , -18.25, -18.  , -17.75,
       -17.5 , -17.25, -17.  , -16.75, -16.5 , -16.25, -16.  , -15.75, -15.5 ,
       -15.25, -15.  , -14.75, -14.5 , -14.25, -14.  , -13.75, -13.5 , -13.25,
       -13.  , -12.75, -12.5 , -12.25, -12.  , -11.75, -11.5 , -11.25, -11.  ,
       -10.75, -10.5 , -10.25, -10.  ,  -9.75,  -9.5 ,  -9.25,  -9.  ,  -8.75,
        -8.5 ,  -8.25,  -8.  ,  -7.75,  -7.5 ,  -7.25,  -7.  ,  -6.75,  -6.5 ,
        -6.25,  -6.  ,  -5.75,  -5.5 ,  -5.25,  -5.  ,  -4.75,  -4.5 ,  -4.25,
        -4.  ,  -3.75,  -3.5 ,  -3.25,  -3.  ,  -2.75,  -2.5 ,  -2.25,  -2.  ,
        -1.75,  -1.5 ,  -1.25,  -1.  ,  -0.75,  -0.5 ,  -0.25,   0.  ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>60.0 59.75 59.5 ... 0.5 0.25 0.0</div><input id='attrs-10e69701-3ce4-429e-aab0-3be8322579d5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-10e69701-3ce4-429e-aab0-3be8322579d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7e56c25-0b85-469f-80e2-c0e0e2a04e50' class='xr-var-data-in' type='checkbox'><label for='data-e7e56c25-0b85-469f-80e2-c0e0e2a04e50' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([60.  , 59.75, 59.5 , ...,  0.5 ,  0.25,  0.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1991-01-01 ... 2023-12-01</div><input id='attrs-6cf2c2ce-ac72-4dbd-9aa1-b31d791b968a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6cf2c2ce-ac72-4dbd-9aa1-b31d791b968a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8210af4a-d2f7-4274-a322-84a551e02691' class='xr-var-data-in' type='checkbox'><label for='data-8210af4a-d2f7-4274-a322-84a551e02691' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1991-01-01T00:00:00.000000000&#x27;, &#x27;1991-02-01T00:00:00.000000000&#x27;,
       &#x27;1991-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-10-01T00:00:00.000000000&#x27;,
       &#x27;2023-11-01T00:00:00.000000000&#x27;, &#x27;2023-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bfee08f6-c745-4366-bafc-f6cab7ab289f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bfee08f6-c745-4366-bafc-f6cab7ab289f' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sst</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f56d8ea5-dca4-45ad-976e-9c289096d5e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f56d8ea5-dca4-45ad-976e-9c289096d5e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7b5498d-2ab6-45fe-8208-15fb6d41aa17' class='xr-var-data-in' type='checkbox'><label for='data-b7b5498d-2ab6-45fe-8208-15fb6d41aa17' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Sea surface temperature</dd></dl></div><div class='xr-var-data'><pre>[15365196 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-10c7b5f0-f9fb-40ae-9b0e-84a5287e6eab' class='xr-section-summary-in' type='checkbox'  ><label for='section-10c7b5f0-f9fb-40ae-9b0e-84a5287e6eab' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7a242eee-53b2-41f4-a8bb-6d05a41fbab0' class='xr-index-data-in' type='checkbox'/><label for='index-7a242eee-53b2-41f4-a8bb-6d05a41fbab0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ -40.0, -39.75,  -39.5, -39.25,  -39.0, -38.75,  -38.5, -38.25,
               -38.0, -37.75,
              ...
               -2.25,   -2.0,  -1.75,   -1.5,  -1.25,   -1.0,  -0.75,   -0.5,
               -0.25,    0.0],
             dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=161))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cf5ac635-733e-4314-88fa-80ca9afa5d29' class='xr-index-data-in' type='checkbox'/><label for='index-cf5ac635-733e-4314-88fa-80ca9afa5d29' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 60.0, 59.75,  59.5, 59.25,  59.0, 58.75,  58.5, 58.25,  58.0,
              57.75,
              ...
               2.25,   2.0,  1.75,   1.5,  1.25,   1.0,  0.75,   0.5,  0.25,
                0.0],
             dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=241))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-80e9cc1e-edeb-4a2c-9967-77564f34d668' class='xr-index-data-in' type='checkbox'/><label for='index-80e9cc1e-edeb-4a2c-9967-77564f34d668' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1991-01-01&#x27;, &#x27;1991-02-01&#x27;, &#x27;1991-03-01&#x27;, &#x27;1991-04-01&#x27;,
               &#x27;1991-05-01&#x27;, &#x27;1991-06-01&#x27;, &#x27;1991-07-01&#x27;, &#x27;1991-08-01&#x27;,
               &#x27;1991-09-01&#x27;, &#x27;1991-10-01&#x27;,
               ...
               &#x27;2023-03-01&#x27;, &#x27;2023-04-01&#x27;, &#x27;2023-05-01&#x27;, &#x27;2023-06-01&#x27;,
               &#x27;2023-07-01&#x27;, &#x27;2023-08-01&#x27;, &#x27;2023-09-01&#x27;, &#x27;2023-10-01&#x27;,
               &#x27;2023-11-01&#x27;, &#x27;2023-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=396, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ba2aef0-1752-48cb-9ad0-7517677014ba' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8ba2aef0-1752-48cb-9ad0-7517677014ba' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>2024-06-16 19:50:42 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1718567441.1459908-14651-8-cf3f88ba-9a09-4dac-a81f-1e02017d839d.nc /cache/tmp/cf3f88ba-9a09-4dac-a81f-1e02017d839d-adaptor.mars.internal-1718567366.2505205-14651-7-tmp.grib</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>As before, we see there are four dimensions and units are in <em>Kelvin</em>. We will work with data in <em>degrees Celsius</em> and we will reduce the <code class="docutils literal notranslate"><span class="pre">expver</span></code> dimension as before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove expver and convert to ºC (no update of attrs...)</span>
<span class="k">if</span> <span class="s1">&#39;expver&#39;</span> <span class="ow">in</span> <span class="n">sst_ds</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
    <span class="n">sst_expver</span> <span class="o">=</span> <span class="n">sst_ds</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">,</span> <span class="s1">&#39;expver&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mf">273.15</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">sst_expver</span> <span class="o">=</span> <span class="n">sst_ds</span><span class="p">[</span><span class="s1">&#39;sst&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>
</pre></div>
</div>
</div>
</div>
<p>We can have a quick look at the data using the convenient <code class="docutils literal notranslate"><span class="pre">plot</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_expver</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1991/01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2d39e806200&gt;
</pre></div>
</div>
<img alt="_images/628cfb1a8628e07b129734b647a38fea19758b644065ff0c9ee89f780441a854.png" src="_images/628cfb1a8628e07b129734b647a38fea19758b644065ff0c9ee89f780441a854.png" />
</div>
</div>
<p>In the plot above we can see many values are below 0, those located on land. Actually, in the original <code class="docutils literal notranslate"><span class="pre">sst_ds</span></code> <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> the land positions had a value of <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>. Now, for <code class="docutils literal notranslate"><span class="pre">sst_expver</span></code> this is not true. This is a result of the previous operation using <code class="docutils literal notranslate"><span class="pre">numpy.nansum</span></code> and subtracting <code class="docutils literal notranslate"><span class="pre">273.15</span></code>. After this operation the land locations have a value of <code class="docutils literal notranslate"><span class="pre">-273.15</span></code> which is not valid. Let’s amend this using a mask:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a mask for LAND</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">sst_expver</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">273.15</span>
<span class="n">sst_masked</span> <span class="o">=</span> <span class="n">sst_expver</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Again, as before, we weight the dataset by the area:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add weights for area</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sst_masked</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">sst_weights</span> <span class="o">=</span> <span class="n">sst_masked</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And, also, we calculate the spatially averaged value for each month to get a monthly time series of the average temperature of the sst over the main area of the North Atlantic from January 1991 to July 2023:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aggregate on Lon/Lat to get a time series of the area</span>
<span class="n">sst_ts</span> <span class="o">=</span> <span class="n">sst_weights</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
<span class="n">sst_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x2d39e919480&gt;]
</pre></div>
</div>
<img alt="_images/a1fdeed0740d96135c8031cee692e7cd89d1deeeaabdd838c3ed5d07f26cff81.png" src="_images/a1fdeed0740d96135c8031cee692e7cd89d1deeeaabdd838c3ed5d07f26cff81.png" />
</div>
</div>
<p>In the plot above we can see the monthly evolution since 1991.</p>
<p>We calculate the minimum, the maximum and the average value for each of the 12 months of the year during the climatological reference (1991-2020):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Min value on each month during the climatology period</span>
<span class="n">min_per_month_clim</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="c1"># Max value on each month during the climatology period</span>
<span class="n">max_per_month_clim</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># avg value on each month during the climatology period</span>
<span class="n">avg_per_month_clim</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;1991-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-12-31&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And once we have this we can compare how recent SST values compare with those of previous years and to the climatology.</p>
<p>In the figure below we will plot the monthly time series for the following:</p>
<ul class="simple">
<li><p>Each year for the period from 1991 to 2020 (light gray).</p></li>
<li><p>The 1991-2020 average (thick gray line).</p></li>
<li><p>2022 (thick orange line).</p></li>
<li><p>2023 (January to July, thick black line).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span> <span class="c1"># For this plot we want a white axes background </span>

<span class="c1"># Thin line for each year from 1991 to 2020</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">2021</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Climatological average</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">avg_per_month_clim</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Clim&#39;</span><span class="p">)</span>

<span class="c1"># Monthly average for 2022</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2022&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2022&#39;</span><span class="p">)</span>

<span class="c1"># Monthly average for 2023</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">sst_ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2023&#39;</span><span class="p">)</span>

<span class="c1"># Customise the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SST ($\degree$C)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Show or save the figure, uncomment the line/s in case of need</span>
<span class="c1">#fig.show() # not needed in a notebook inline context</span>
<span class="c1">#fig.savefig(&#39;SST_NorthAtlantic_avg.png&#39;) # not needed in a notebook inline context</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f66f6489fe134d6b8fc2c109b80c6078a079f2c170dcdf4f5bb330b63f08fb59.png" src="_images/f66f6489fe134d6b8fc2c109b80c6078a079f2c170dcdf4f5bb330b63f08fb59.png" />
</div>
</div>
<p>Notice the dramatic increase in SST over the North Atlantic in 2023 compared to previous years!</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis-climatology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial on Climatologies using Climate Data from C3S</p>
      </div>
    </a>
    <a class="right-next"
       href="reanalysis-heatwave.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analysis of September 2020 European Heatwave using ERA5 Climate Reanalysis Data from C3S</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about">About</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-download-and-view-data">1. Search, download and view data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure-introduction-installing-api-of-the-cds">Infrastructure introduction (installing API of the CDS)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-on-your-computer">Installation on your computer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-on-colab-or-kaggle">Running on Colab or Kaggle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-your-cds-api-key">Enter your CDS API key</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-for-data">Search for data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-data">Inspect data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-the-two-era5-experiments-1-and-5-expver-1-5">Merge the two ERA5 experiments (1 and 5, <code class="docutils literal notranslate"><span class="pre">expver</span> <span class="pre">=</span> <span class="pre">[1,5]</span></code>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-temperature-units-from-kelvin-to-celsius">Change temperature units from Kelvin to Celsius</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-to-be-used">Data to be used</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-one-timestep">Plotting one timestep</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-a-surface-temperature-climatology-reference-period-1991-2020">2. Calculate a surface temperature climatology: reference period 1991-2020</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-reference-periods-and-climatologies">Standard reference periods and climatologies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualise-surface-temperature-anomalies">3. Visualise surface temperature anomalies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-surface-temperature-trends">4. View time series and analyse surface temperature trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-time-series-and-analyse-north-atlantic-sea-surface-temperature-trends">5. View time series and analyse North Atlantic sea surface temperature trends</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#this-is-a-new-exercise-in-this-part-of-the-tutorial-we-will-be-working-with-monthly-sea-surface-temperature-sst-data">This is a new exercise. In this part of the tutorial we will be working with monthly sea surface temperature (SST) data.</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>