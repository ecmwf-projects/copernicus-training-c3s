
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plot an Ensemble of CMIP6 Climate Projections &#8212; C3S Training</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analysis of Projected versus Historical Climatology with CORDEX Data" href="05_Climate_Projections_CORDEX.html" />
    <link rel="prev" title="Analysis of September 2020 European Heatwave using ERA5 Climate Reanalysis Data from C3S" href="03_Heatwave_Analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/C3S–POS–LINE.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">C3S Training</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Copernicus Climate Change Service (C3S) Data Tutorials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Climate Data Store (CDS)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_Climate_Data_Store.html">
   CDS tutorial
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reanalysis Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Climatology.html">
   Climatology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Climate_Indices.html">
   Climate Indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_Heatwave_Analysis.html">
   Heatwave Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials on Climate Projections
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Climate Projections (CMIP6)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_Climate_Projections_CORDEX.html">
   Climate Projections (CORDEX)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials on Seasonal Forecasts
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="06_Seasonal_Forecast_Anomalies.html">
   Seasonal Forecast Anomalies
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Atmosphere Monitoring Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-cams/">
   Tutorials from the Copernicus Atmosphere Monitoring Service (CAMS)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/04_Climate_Projections_CMIP6.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ecmwf-projects/copernicus-training-c3s"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ecmwf-projects/copernicus-training-c3s/issues/new?title=Issue%20on%20page%20%2F04_Climate_Projections_CMIP6.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?urlpath=tree/04_Climate_Projections_CMIP6.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about">
   About
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-cds-api-via-pip">
   Install CDS API via pip
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries">
   Load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#request-data-from-the-cds-programmatically-with-the-cds-api">
   Request data from the CDS programmatically with the CDS API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unzip-the-downloaded-data-files">
   Unzip the downloaded data files
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-list-of-the-extracted-files">
     Create a list of the extracted files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-one-model-and-one-experiment">
   Load and prepare CMIP6 data for one model and one experiment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-inspect-data">
     Load and inspect data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-aggregation">
     Spatial aggregation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporal-aggregation">
     Temporal aggregation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conversion-from-kelvin-to-celsius">
     Conversion from Kelvin to Celsius
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-additional-data-dimensions-to-later-combine-data-from-multiple-models-experiments">
     Create additional data dimensions (to later combine data from multiple models &amp; experiments)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-all-models-and-experiments">
   Load and prepare CMIP6 data for all models and experiments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100">
   Visualize the CMIP6 annual global average temperature between 1850 to 2100
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-quantiles-for-model-ensemble">
     Calculate quantiles for model ensemble
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#view-time-series">
     View time-series
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Plot an Ensemble of CMIP6 Climate Projections</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about">
   About
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-cds-api-via-pip">
   Install CDS API via pip
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries">
   Load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#request-data-from-the-cds-programmatically-with-the-cds-api">
   Request data from the CDS programmatically with the CDS API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unzip-the-downloaded-data-files">
   Unzip the downloaded data files
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-list-of-the-extracted-files">
     Create a list of the extracted files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-one-model-and-one-experiment">
   Load and prepare CMIP6 data for one model and one experiment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-inspect-data">
     Load and inspect data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-aggregation">
     Spatial aggregation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temporal-aggregation">
     Temporal aggregation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conversion-from-kelvin-to-celsius">
     Conversion from Kelvin to Celsius
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-additional-data-dimensions-to-later-combine-data-from-multiple-models-experiments">
     Create additional data dimensions (to later combine data from multiple models &amp; experiments)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-and-prepare-cmip6-data-for-all-models-and-experiments">
   Load and prepare CMIP6 data for all models and experiments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100">
   Visualize the CMIP6 annual global average temperature between 1850 to 2100
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-quantiles-for-model-ensemble">
     Calculate quantiles for model ensemble
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#view-time-series">
     View time-series
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><img alt="logo" src="_images/LogoLine_horizon_C3S.png" /></p>
<br><div class="tex2jax_ignore mathjax_ignore section" id="plot-an-ensemble-of-cmip6-climate-projections">
<h1>Plot an Ensemble of CMIP6 Climate Projections<a class="headerlink" href="#plot-an-ensemble-of-cmip6-climate-projections" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h2>
<p>This notebook provides a practical introduction on how to access and process <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#%21/dataset/projections-cmip6?tab=overview">CMIP6 global climate projections</a> data available in the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S). The workflow shows how to compute and visualize the output of an ensemble of models for the annual global average temperature between 1850 to 2100. You will use the <code class="docutils literal notranslate"><span class="pre">historical</span></code> experiment for the temporal period 1850 to 2014 and the three scenarios <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP2-4.5</span></code> and <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> for the period from 2015 to 2100.</p>
<p>For the sake of simplicity, and to facilitate data download, the tutorial will make use of some of the coarser resolution models that have a smaller data size. It is nevertheless only a choice for this exercise and not a recommendation (since ideally all models, including those with highest resolution, should be used). Many more models are available on the CDS, and when calculating an ensemble of models, it is best practice to use as many as possible for a more reliable output. See <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/CMIP6%3A+Global+climate+projections#CMIP6:Globalclimateprojections-Models,gridsandpressurelevels">here</a> a full list of models included in the CDS-CMIP6 dataset.</p>
<p>Learn <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/CMIP6%3A+Global+climate+projections#CMIP6:Globalclimateprojections">here</a> more about CMIP6 global climate projections and the CMIP6 experiments in the CDS.</p>
<p>The notebook has the following outline:</p>
<ol class="simple">
<li><p>Request data from the CDS programmatically with the CDS API</p></li>
<li><p>Unzip the downloaded data files</p></li>
<li><p>Load and prepare CMIP6 data for one model and one experiment</p></li>
<li><p>Load and prepare CMIP6 data for all models and experiments</p></li>
<li><p>Visualize CMIP6 annual global average temperature between 1850 to 2100</p></li>
</ol>
</div>
<div class="section" id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces you to <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#%21/dataset/projections-cmip6?tab=overview">CMIP6 Global climate projections</a>. The datasets used in the notebook have the following specifications:</p>
<blockquote>
<div><p><strong>Data</strong>: CMIP6 global climate projections of near-surface air temperature <br>
<strong>Experiments</strong>: Historical, SSP1-2.6, SSP2-4.5, SSP5-8.5 <br>
<strong>Models</strong>: 7 models from Germany, France, UK, Japan and Russia <br>
<strong>Temporal range</strong>: Historical: 1850 - 2014. Scenarios: 2015 - 2100 <br>
<strong>Spatial coverage</strong>: Global <br>
<strong>Format</strong>: NetCDF, compressed into zip files</p>
</div></blockquote>
<style>
td, th {
   border: 1px solid white;
   border-collapse: collapse;
}
</style>
<table align="left">
  <tr>
    <th>Run the tutorial via free cloud platforms: </th>
    <th><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?labpath=04_Climate_Projections_CMIP6.ipynb">
        <img src = "https://mybinder.org/badge.svg" alt = "Binder"></th>
    <th><a href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-projects/copernicus-training-c3s/blob/main/04_Climate_Projections_CMIP6.ipynb">
        <img src = "https://kaggle.com/static/images/open-in-kaggle.svg" alt = "Kaggle"></th>
    <th><a href="https://colab.research.google.com/github/ecmwf-projects/copernicus-training-c3s/blob/main/04_Climate_Projections_CMIP6.ipynb">
        <img src = "https://colab.research.google.com/assets/colab-badge.svg" alt = "Colab"></th>
  </tr>
</table><hr></div>
<div class="section" id="install-cds-api-via-pip">
<h2>Install CDS API via pip<a class="headerlink" href="#install-cds-api-via-pip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install cdsapi
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-libraries">
<h2>Load libraries<a class="headerlink" href="#load-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General libs for file paths, data extraction, etc</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span>
<span class="kn">import</span> <span class="nn">zipfile</span> <span class="c1"># To extract zipfiles</span>
<span class="kn">import</span> <span class="nn">urllib3</span> 
<span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span> <span class="c1"># Disable warnings for data download via API</span>

<span class="c1"># CDS API</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="c1"># Libraries for working with multi-dimensional arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Libraries for plotting and visualising data</span>
<span class="kn">import</span> <span class="nn">matplotlib.path</span> <span class="k">as</span> <span class="nn">mpath</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
</pre></div>
</div>
</div>
</div>
<hr></div>
<div class="section" id="request-data-from-the-cds-programmatically-with-the-cds-api">
<h2>Request data from the CDS programmatically with the CDS API<a class="headerlink" href="#request-data-from-the-cds-programmatically-with-the-cds-api" title="Permalink to this headline">¶</a></h2>
<p>We will request data from the Climate Data Store (CDS) programmatically with the help of the CDS API. Let us make use of the option to manually set the CDS API credentials. First, you have to define two variables: <code class="docutils literal notranslate"><span class="pre">URL</span></code> and <code class="docutils literal notranslate"><span class="pre">KEY</span></code> which build together your CDS API key. The string of characters that make up your KEY include your personal User ID and CDS API key. To obtain these, first register or login to the CDS (<a class="reference external" href="http://cds.climate.copernicus.eu">http://cds.climate.copernicus.eu</a>), then visit <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a> and copy the string of characters listed after “key:”. Replace the <code class="docutils literal notranslate"><span class="pre">#########</span></code> below with this string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://cds.climate.copernicus.eu/api/v2&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;##################################&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Here we specify a data directory in which we will download our data and all output files that we will generate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>The next step is then to request the data with the help of the CDS API. Below, we loop through multiple data requests. These include data for different models and scenarios. It is not possible to specify multiple models in one data request as their spatial resolution varies.</p>
<p>We will download monthly aggregated data. These are disseminated as netcdf files within a zip archive.</p>
<p>In order to loop through the various experiments and models in our data requests, we will specify them as Python ‘lists’ here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">experiments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;historical&#39;</span><span class="p">,</span> <span class="s1">&#39;ssp126&#39;</span><span class="p">,</span> <span class="s1">&#39;ssp245&#39;</span><span class="p">,</span> <span class="s1">&#39;ssp585&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hadgem3_gc31_ll&#39;</span><span class="p">,</span> <span class="s1">&#39;inm_cm5_0&#39;</span><span class="p">,</span> <span class="s1">&#39;inm_cm4_8&#39;</span><span class="p">,</span> <span class="s1">&#39;ipsl_cm6a_lr&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;miroc_es2l&#39;</span><span class="p">,</span> <span class="s1">&#39;mpi_esm1_2_lr&#39;</span><span class="p">,</span> <span class="s1">&#39;ukesm1_0_ll&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> Note that these are a selection of the lightest models (in terms of data volume), to facilitate download for the sake of this exercise. There are many <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#%21/dataset/projections-cmip6?tab=overview">more models available on the CDS</a>.</p>
</div></blockquote>
<p>Now we can download the data for each model and experiment sequentially. We will do this separately for the historical experiments and for the various future scenarios, given that they refer to two different time periods.</p>
<p>Before you run the cells below, the terms and conditions on the use of the data need to have been accepted in the CDS. You can view and accept these conditions by logging into the <a class="reference external" href="http://cds.climate.copernicus.eu">CDS</a>, searching for the dataset, then scrolling to the end of the <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">data</span></code> section.</p>
<blockquote>
<div><p><strong>Note:</strong> For more information about data access through the Climate Data Store, please see the dedicated tutorial <span class="xref myst">here</span>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DOWNLOAD DATA FOR HISTORICAL PERIOD</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
        <span class="s1">&#39;projections-cmip6&#39;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;temporal_resolution&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
            <span class="s1">&#39;experiment&#39;</span><span class="p">:</span> <span class="s1">&#39;historical&#39;</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;single_levels&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;near_surface_air_temperature&#39;</span><span class="p">,</span>
            <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;1850-01-01/2014-12-31&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_monthly_1850-2014_historical_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DOWNLOAD DATA FOR FUTURE SCENARIOS</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
            <span class="s1">&#39;projections-cmip6&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span>
                <span class="s1">&#39;temporal_resolution&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                <span class="s1">&#39;experiment&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;single_levels&#39;</span><span class="p">,</span>
                <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;near_surface_air_temperature&#39;</span><span class="p">,</span>
                <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;2015-01-01/2100-12-31&#39;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_monthly_2015-2100_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unzip-the-downloaded-data-files">
<h2>Unzip the downloaded data files<a class="headerlink" href="#unzip-the-downloaded-data-files" title="Permalink to this headline">¶</a></h2>
<p>From the CDS, CMIP6 data are available as <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> files compressed into <code class="docutils literal notranslate"><span class="pre">zip</span></code> archives. For this reason, before we can load any data, we have to extract the files. Having downloaded the four experiments <code class="docutils literal notranslate"><span class="pre">historical</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code>, <code class="docutils literal notranslate"><span class="pre">SSP2-4.5</span></code> and <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> as seperate zip files, we can use the functions from the <code class="docutils literal notranslate"><span class="pre">zipfile</span></code> Python package to extract their contents. For each zip file we first construct a <code class="docutils literal notranslate"><span class="pre">ZipFile()</span></code> object, then we apply the function <code class="docutils literal notranslate"><span class="pre">extractall()</span></code> to extract its content.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip6_zip_paths</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">*.zip&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">cmip6_zip_paths</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-a-list-of-the-extracted-files">
<h3>Create a list of the extracted files<a class="headerlink" href="#create-a-list-of-the-extracted-files" title="Permalink to this headline">¶</a></h3>
<p>To facilitate batch processing later in the tutorial, here we create a list of the extracted NetCDF files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip6_nc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">cmip6_nc_rel</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">tas*.nc&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cmip6_nc_rel</span><span class="p">:</span>
    <span class="n">cmip6_nc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We will briefly inspect this list by printing the first five elements, corresponding to the filenames of a sample of the extracted NetCDF files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip6_nc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;tas_Amon_HadGEM3-GC31-LL_historical_r1i1p1f3_gn_18500216-20141216_v20190624.nc&#39;,
 &#39;tas_Amon_HadGEM3-GC31-LL_ssp126_r1i1p1f3_gn_201501-204912_v20200114.nc&#39;,
 &#39;tas_Amon_HadGEM3-GC31-LL_ssp126_r1i1p1f3_gn_205001-210012_v20200114.nc&#39;,
 &#39;tas_Amon_HadGEM3-GC31-LL_ssp245_r1i1p1f3_gn_201501-204912_v20190908.nc&#39;,
 &#39;tas_Amon_HadGEM3-GC31-LL_ssp245_r1i1p1f3_gn_205001-210012_v20190908.nc&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="load-and-prepare-cmip6-data-for-one-model-and-one-experiment">
<h2>Load and prepare CMIP6 data for one model and one experiment<a class="headerlink" href="#load-and-prepare-cmip6-data-for-one-model-and-one-experiment" title="Permalink to this headline">¶</a></h2>
<p>Now that we have downloaded and extracted the data, we can prepare it in order to view a time series of the spread of annual global temperature for the model ensemble. These preparation steps include the following:</p>
<ol class="simple">
<li><p><strong>Spatial aggregation</strong>: to have a single global temperature value for each model/experiment dataset, and for each time step</p></li>
<li><p><strong>Temporal aggregation</strong>: from monthly to yearly</p></li>
<li><p><strong>Conversion of temperature units</strong> from degrees Kelvin to Celsius</p></li>
<li><p><strong>Addition of data dimensions</strong> in preparation for the merging of datasets from different models and experiments</p></li>
</ol>
<p>In this section we apply these steps to a single dataset from one model and one experiment. In the next section we merge data from all models/experiments in preparation for the final processing and plotting of the temperature time series.</p>
<div class="section" id="load-and-inspect-data">
<h3>Load and inspect data<a class="headerlink" href="#load-and-inspect-data" title="Permalink to this headline">¶</a></h3>
<p>We begin by loading the first of the NetCDF files in our list. We will use the Python library <a class="reference external" href="http://xarray.pydata.org/en/stable/">xarray</a> and its function <code class="docutils literal notranslate"><span class="pre">open_dataset</span></code> to read NetCDF files.</p>
<p>The result is a <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> object with four dimensions: <code class="docutils literal notranslate"><span class="pre">bnds</span></code>, <code class="docutils literal notranslate"><span class="pre">lat</span></code>, <code class="docutils literal notranslate"><span class="pre">lon</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>, of which the dimension <code class="docutils literal notranslate"><span class="pre">bnds</span></code> is not callable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}{</span><span class="n">cmip6_nc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (time: 1979, bnds: 2, lat: 144, lon: 192)
Coordinates:
  * time       (time) object 1850-02-16 00:00:00 ... 2014-12-16 00:00:00
  * lat        (lat) float64 -89.38 -88.12 -86.88 -85.62 ... 86.88 88.12 89.38
  * lon        (lon) float64 0.9375 2.812 4.688 6.562 ... 355.3 357.2 359.1
    height     float64 1.5
Dimensions without coordinates: bnds
Data variables:
    time_bnds  (time, bnds) object 1850-02-01 00:00:00 ... 2015-01-01 00:00:00
    lat_bnds   (time, lat, bnds) float64 ...
    lon_bnds   (time, lon, bnds) float64 ...
    tas        (time, lat, lon) float32 ...
Attributes: (12/46)
    Conventions:            CF-1.7 CMIP-6.2
    activity_id:            CMIP
    branch_method:          standard
    branch_time_in_child:   0.0
    branch_time_in_parent:  0.0
    creation_date:          2019-06-19T11:21:17Z
    ...                     ...
    title:                  HadGEM3-GC31-LL output prepared for CMIP6
    variable_id:            tas
    variant_label:          r1i1p1f3
    license:                CMIP6 model data produced by the Met Office Hadle...
    cmor_version:           3.4.0
    tracking_id:            hdl:21.14100/b6959414-d5ed-4cd9-a627-59238e52132d</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5681388b-94ef-4c6c-be68-98adaff1cb75' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5681388b-94ef-4c6c-be68-98adaff1cb75' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1979</li><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 144</li><li><span class='xr-has-index'>lon</span>: 192</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-39dd8668-2684-4987-98b9-4f10095a77a4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-39dd8668-2684-4987-98b9-4f10095a77a4' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1850-02-16 00:00:00 ... 2014-12-...</div><input id='attrs-c76133e6-226e-46cb-bae2-896cee42c07b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c76133e6-226e-46cb-bae2-896cee42c07b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da6d06da-c426-48eb-94d9-c5b7c23e4225' class='xr-var-data-in' type='checkbox'><label for='data-da6d06da-c426-48eb-94d9-c5b7c23e4225' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.Datetime360Day(1850, 2, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(1850, 3, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(1850, 4, 16, 0, 0, 0, 0, has_year_zero=True), ...,
       cftime.Datetime360Day(2014, 10, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2014, 11, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2014, 12, 16, 0, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.38 -88.12 ... 88.12 89.38</div><input id='attrs-cc8cb79f-ecef-4d58-a0a0-f5359ef5ca22' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc8cb79f-ecef-4d58-a0a0-f5359ef5ca22' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-350d789a-fc2c-4527-b2c6-9a33ee5e309f' class='xr-var-data-in' type='checkbox'><label for='data-350d789a-fc2c-4527-b2c6-9a33ee5e309f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-89.375, -88.125, -86.875, -85.625, -84.375, -83.125, -81.875, -80.625,
       -79.375, -78.125, -76.875, -75.625, -74.375, -73.125, -71.875, -70.625,
       -69.375, -68.125, -66.875, -65.625, -64.375, -63.125, -61.875, -60.625,
       -59.375, -58.125, -56.875, -55.625, -54.375, -53.125, -51.875, -50.625,
       -49.375, -48.125, -46.875, -45.625, -44.375, -43.125, -41.875, -40.625,
       -39.375, -38.125, -36.875, -35.625, -34.375, -33.125, -31.875, -30.625,
       -29.375, -28.125, -26.875, -25.625, -24.375, -23.125, -21.875, -20.625,
       -19.375, -18.125, -16.875, -15.625, -14.375, -13.125, -11.875, -10.625,
        -9.375,  -8.125,  -6.875,  -5.625,  -4.375,  -3.125,  -1.875,  -0.625,
         0.625,   1.875,   3.125,   4.375,   5.625,   6.875,   8.125,   9.375,
        10.625,  11.875,  13.125,  14.375,  15.625,  16.875,  18.125,  19.375,
        20.625,  21.875,  23.125,  24.375,  25.625,  26.875,  28.125,  29.375,
        30.625,  31.875,  33.125,  34.375,  35.625,  36.875,  38.125,  39.375,
        40.625,  41.875,  43.125,  44.375,  45.625,  46.875,  48.125,  49.375,
        50.625,  51.875,  53.125,  54.375,  55.625,  56.875,  58.125,  59.375,
        60.625,  61.875,  63.125,  64.375,  65.625,  66.875,  68.125,  69.375,
        70.625,  71.875,  73.125,  74.375,  75.625,  76.875,  78.125,  79.375,
        80.625,  81.875,  83.125,  84.375,  85.625,  86.875,  88.125,  89.375])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.9375 2.812 4.688 ... 357.2 359.1</div><input id='attrs-b528edbe-4daa-4d25-824a-2e8488a4c447' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b528edbe-4daa-4d25-824a-2e8488a4c447' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1dfaa9d2-2a46-436c-aec9-d4e310b1a985' class='xr-var-data-in' type='checkbox'><label for='data-1dfaa9d2-2a46-436c-aec9-d4e310b1a985' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([  0.9375,   2.8125,   4.6875,   6.5625,   8.4375,  10.3125,  12.1875,
        14.0625,  15.9375,  17.8125,  19.6875,  21.5625,  23.4375,  25.3125,
        27.1875,  29.0625,  30.9375,  32.8125,  34.6875,  36.5625,  38.4375,
        40.3125,  42.1875,  44.0625,  45.9375,  47.8125,  49.6875,  51.5625,
        53.4375,  55.3125,  57.1875,  59.0625,  60.9375,  62.8125,  64.6875,
        66.5625,  68.4375,  70.3125,  72.1875,  74.0625,  75.9375,  77.8125,
        79.6875,  81.5625,  83.4375,  85.3125,  87.1875,  89.0625,  90.9375,
        92.8125,  94.6875,  96.5625,  98.4375, 100.3125, 102.1875, 104.0625,
       105.9375, 107.8125, 109.6875, 111.5625, 113.4375, 115.3125, 117.1875,
       119.0625, 120.9375, 122.8125, 124.6875, 126.5625, 128.4375, 130.3125,
       132.1875, 134.0625, 135.9375, 137.8125, 139.6875, 141.5625, 143.4375,
       145.3125, 147.1875, 149.0625, 150.9375, 152.8125, 154.6875, 156.5625,
       158.4375, 160.3125, 162.1875, 164.0625, 165.9375, 167.8125, 169.6875,
       171.5625, 173.4375, 175.3125, 177.1875, 179.0625, 180.9375, 182.8125,
       184.6875, 186.5625, 188.4375, 190.3125, 192.1875, 194.0625, 195.9375,
       197.8125, 199.6875, 201.5625, 203.4375, 205.3125, 207.1875, 209.0625,
       210.9375, 212.8125, 214.6875, 216.5625, 218.4375, 220.3125, 222.1875,
       224.0625, 225.9375, 227.8125, 229.6875, 231.5625, 233.4375, 235.3125,
       237.1875, 239.0625, 240.9375, 242.8125, 244.6875, 246.5625, 248.4375,
       250.3125, 252.1875, 254.0625, 255.9375, 257.8125, 259.6875, 261.5625,
       263.4375, 265.3125, 267.1875, 269.0625, 270.9375, 272.8125, 274.6875,
       276.5625, 278.4375, 280.3125, 282.1875, 284.0625, 285.9375, 287.8125,
       289.6875, 291.5625, 293.4375, 295.3125, 297.1875, 299.0625, 300.9375,
       302.8125, 304.6875, 306.5625, 308.4375, 310.3125, 312.1875, 314.0625,
       315.9375, 317.8125, 319.6875, 321.5625, 323.4375, 325.3125, 327.1875,
       329.0625, 330.9375, 332.8125, 334.6875, 336.5625, 338.4375, 340.3125,
       342.1875, 344.0625, 345.9375, 347.8125, 349.6875, 351.5625, 353.4375,
       355.3125, 357.1875, 359.0625])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-79720cd7-5de5-41e2-b0f1-ac0e1ead9091' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-79720cd7-5de5-41e2-b0f1-ac0e1ead9091' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3d8fc4c-4ef4-43f2-8e12-e5ecd79daba8' class='xr-var-data-in' type='checkbox'><label for='data-e3d8fc4c-4ef4-43f2-8e12-e5ecd79daba8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>long_name :</span></dt><dd>height</dd><dt><span>standard_name :</span></dt><dd>height</dd></dl></div><div class='xr-var-data'><pre>array(1.5)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-82b1784d-1492-44f8-8cb4-0cbf81108681' class='xr-section-summary-in' type='checkbox'  checked><label for='section-82b1784d-1492-44f8-8cb4-0cbf81108681' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f0380d82-1de6-42f8-8577-7572147a5b20' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f0380d82-1de6-42f8-8577-7572147a5b20' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-831480e9-462a-46af-a1c5-a54e170fa247' class='xr-var-data-in' type='checkbox'><label for='data-831480e9-462a-46af-a1c5-a54e170fa247' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[cftime.Datetime360Day(1850, 2, 1, 0, 0, 0, 0, has_year_zero=True),
        cftime.Datetime360Day(1850, 3, 1, 0, 0, 0, 0, has_year_zero=True)],
       [cftime.Datetime360Day(1850, 3, 1, 0, 0, 0, 0, has_year_zero=True),
        cftime.Datetime360Day(1850, 4, 1, 0, 0, 0, 0, has_year_zero=True)],
       [cftime.Datetime360Day(1850, 4, 1, 0, 0, 0, 0, has_year_zero=True),
        cftime.Datetime360Day(1850, 5, 1, 0, 0, 0, 0, has_year_zero=True)],
       ...,
       [cftime.Datetime360Day(2014, 10, 1, 0, 0, 0, 0, has_year_zero=True),
        cftime.Datetime360Day(2014, 11, 1, 0, 0, 0, 0, has_year_zero=True)],
       [cftime.Datetime360Day(2014, 11, 1, 0, 0, 0, 0, has_year_zero=True),
        cftime.Datetime360Day(2014, 12, 1, 0, 0, 0, 0, has_year_zero=True)],
       [cftime.Datetime360Day(2014, 12, 1, 0, 0, 0, 0, has_year_zero=True),
        cftime.Datetime360Day(2015, 1, 1, 0, 0, 0, 0, has_year_zero=True)]],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_bnds</span></div><div class='xr-var-dims'>(time, lat, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-eca48b47-dcbc-47d7-86bd-dab7f68dca29' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eca48b47-dcbc-47d7-86bd-dab7f68dca29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb356ef7-1a02-4a29-be63-3c7610f86f6a' class='xr-var-data-in' type='checkbox'><label for='data-fb356ef7-1a02-4a29-be63-3c7610f86f6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[569952 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bnds</span></div><div class='xr-var-dims'>(time, lon, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4f894d3f-d91d-430b-917d-3afa0fe9a2eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4f894d3f-d91d-430b-917d-3afa0fe9a2eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25f1fe65-5c26-4d4e-a414-a53d28357153' class='xr-var-data-in' type='checkbox'><label for='data-25f1fe65-5c26-4d4e-a414-a53d28357153' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[759936 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f239ec91-d88a-46f7-b6a8-ee3a6dacb479' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f239ec91-d88a-46f7-b6a8-ee3a6dacb479' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3dce1f1e-df81-4ddd-878d-1c2698f094c8' class='xr-var-data-in' type='checkbox'><label for='data-3dce1f1e-df81-4ddd-878d-1c2698f094c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>original_name :</span></dt><dd>mo: (stash: m01s03i236, lbproc: 128)</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>history :</span></dt><dd>2019-06-19T11:21:17Z altered by CMOR: Treated scalar dimension: &#x27;height&#x27;. 2019-06-19T11:21:17Z altered by CMOR: replaced missing value flag (-1.07374e+09) with standard missing value (1e+20).</dd></dl></div><div class='xr-var-data'><pre>[54715392 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fa099ab3-8b89-4967-b9ad-b3caa1e2a23b' class='xr-section-summary-in' type='checkbox'  ><label for='section-fa099ab3-8b89-4967-b9ad-b3caa1e2a23b' class='xr-section-summary' >Attributes: <span>(46)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7 CMIP-6.2</dd><dt><span>activity_id :</span></dt><dd>CMIP</dd><dt><span>branch_method :</span></dt><dd>standard</dd><dt><span>branch_time_in_child :</span></dt><dd>0.0</dd><dt><span>branch_time_in_parent :</span></dt><dd>0.0</dd><dt><span>creation_date :</span></dt><dd>2019-06-19T11:21:17Z</dd><dt><span>cv_version :</span></dt><dd>6.2.20.1</dd><dt><span>data_specs_version :</span></dt><dd>01.00.29</dd><dt><span>experiment :</span></dt><dd>all-forcing simulation of the recent past</dd><dt><span>experiment_id :</span></dt><dd>historical</dd><dt><span>external_variables :</span></dt><dd>areacella</dd><dt><span>forcing_index :</span></dt><dd>3</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>further_info_url :</span></dt><dd>https://furtherinfo.es-doc.org/CMIP6.MOHC.HadGEM3-GC31-LL.historical.none.r1i1p1f3</dd><dt><span>grid :</span></dt><dd>Native N96 grid; 192 x 144 longitude/latitude</dd><dt><span>grid_label :</span></dt><dd>gn</dd><dt><span>history :</span></dt><dd>2019-06-19T11:11:07Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.;
2019-06-19T11:10:54Z MIP Convert v1.1.0, Python v2.7.12, Iris v1.13.0, Numpy v1.13.3, netcdftime v1.4.1.</dd><dt><span>initialization_index :</span></dt><dd>1</dd><dt><span>institution :</span></dt><dd>Met Office Hadley Centre, Fitzroy Road, Exeter, Devon, EX1 3PB, UK</dd><dt><span>institution_id :</span></dt><dd>MOHC</dd><dt><span>mip_era :</span></dt><dd>CMIP6</dd><dt><span>mo_runid :</span></dt><dd>u-bg466</dd><dt><span>nominal_resolution :</span></dt><dd>250 km</dd><dt><span>parent_activity_id :</span></dt><dd>CMIP</dd><dt><span>parent_experiment_id :</span></dt><dd>piControl</dd><dt><span>parent_mip_era :</span></dt><dd>CMIP6</dd><dt><span>parent_source_id :</span></dt><dd>HadGEM3-GC31-LL</dd><dt><span>parent_time_units :</span></dt><dd>days since 1850-01-01-00-00-00</dd><dt><span>parent_variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>physics_index :</span></dt><dd>1</dd><dt><span>product :</span></dt><dd>model-output</dd><dt><span>realization_index :</span></dt><dd>1</dd><dt><span>realm :</span></dt><dd>atmos</dd><dt><span>source :</span></dt><dd>HadGEM3-GC31-LL (2016): 
aerosol: UKCA-GLOMAP-mode
atmos: MetUM-HadGEM3-GA7.1 (N96; 192 x 144 longitude/latitude; 85 levels; top level 85 km)
atmosChem: none
land: JULES-HadGEM3-GL7.1
landIce: none
ocean: NEMO-HadGEM3-GO6.0 (eORCA1 tripolar primarily 1 deg with meridional refinement down to 1/3 degree in the tropics; 360 x 330 longitude/latitude; 75 levels; top grid cell 0-1 m)
ocnBgchem: none
seaIce: CICE-HadGEM3-GSI8 (eORCA1 tripolar primarily 1 deg; 360 x 330 longitude/latitude)</dd><dt><span>source_id :</span></dt><dd>HadGEM3-GC31-LL</dd><dt><span>source_type :</span></dt><dd>AOGCM AER</dd><dt><span>sub_experiment :</span></dt><dd>none</dd><dt><span>sub_experiment_id :</span></dt><dd>none</dd><dt><span>table_id :</span></dt><dd>Amon</dd><dt><span>table_info :</span></dt><dd>Creation Date:(13 December 2018) MD5:2b12b5db6db112aa8b8b0d6c1645b121</dd><dt><span>title :</span></dt><dd>HadGEM3-GC31-LL output prepared for CMIP6</dd><dt><span>variable_id :</span></dt><dd>tas</dd><dt><span>variant_label :</span></dt><dd>r1i1p1f3</dd><dt><span>license :</span></dt><dd>CMIP6 model data produced by the Met Office Hadley Centre is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License (https://creativecommons.org/licenses). Consult https://pcmdi.llnl.gov/CMIP6/TermsOfUse for terms of use governing CMIP6 output, including citation requirements and proper acknowledgment. Further information about this data, including some limitations, can be found via the further_info_url (recorded as a global attribute in this file) and at https://ukesm.ac.uk/cmip6. The data producers and data providers make no warranty, either express or implied, including, but not limited to, warranties of merchantability and fitness for a particular purpose. All liabilities arising from the supply of the information (including any liability arising in negligence) are excluded to the fullest extent permitted by law.</dd><dt><span>cmor_version :</span></dt><dd>3.4.0</dd><dt><span>tracking_id :</span></dt><dd>hdl:21.14100/b6959414-d5ed-4cd9-a627-59238e52132d</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>By examining the data above, we can see from the temporal range (1850 to 2014) that it is from the <code class="docutils literal notranslate"><span class="pre">historical</span></code> experiment.</p>
<p>We see that the data dimensions have been given labelled coordinates of time, latitude and longitude. We can find more about the dataset from the <code class="docutils literal notranslate"><span class="pre">Attributes</span></code>, such information includes the model name, description of the variable (<code class="docutils literal notranslate"><span class="pre">long_name</span></code>), units, etc.</p>
<p>Some of this information we will need later, this includes the experiment and model IDs. We will save these into variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;source_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">xarray.Dataset()</span></code> may contain arrays of multiple variables. We only have one variable in the dataset, which is near-surface air temperature, <code class="docutils literal notranslate"><span class="pre">tas</span></code>. Below we create an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray()</span></code> object, which takes only one variable, but gives us more flexibility in processing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="spatial-aggregation">
<h3>Spatial aggregation<a class="headerlink" href="#spatial-aggregation" title="Permalink to this headline">¶</a></h3>
<p>The next step is to aggregate the temperature values spatially (i.e. average over the latitude and longitude dimensions) and compute the global monthly near-surface temperature.</p>
<p>A very important consideration however is that the gridded data cells do not all correspond to the same areas. The size covered by each data point varies as a function of latitude. We need to take this into account when averaging. One way to do this is to use the cosine of the latitude as a proxy for the varying sizes.</p>
<p>This can be implemented by first calculating weights as a function of the cosine of the latitude, then applying these weights to the data array with the xarray function <code class="docutils literal notranslate"><span class="pre">weighted()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">da_weighted</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The next step is then to compute the mean across the latitude and longitude dimensions of the weighted data array with the function <code class="docutils literal notranslate"><span class="pre">mean()</span></code>. The result is a DataArray with one dimension (<code class="docutils literal notranslate"><span class="pre">time</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_agg</span> <span class="o">=</span> <span class="n">da_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="temporal-aggregation">
<h3>Temporal aggregation<a class="headerlink" href="#temporal-aggregation" title="Permalink to this headline">¶</a></h3>
<p>We now aggregate the monthly global near-surface air temperature values to annual global near-surface air temperature values. This operation can be done in two steps: first, all the values for one specific year have to be grouped with the function <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> and second, we can create the average of each group with the function <code class="docutils literal notranslate"><span class="pre">mean()</span></code>.</p>
<p>The result is a one-dimensional DataArray. Please note that this operation changes the name of the dimension from <code class="docutils literal notranslate"><span class="pre">time</span></code> to <code class="docutils literal notranslate"><span class="pre">year</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_agg</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="conversion-from-kelvin-to-celsius">
<h3>Conversion from Kelvin to Celsius<a class="headerlink" href="#conversion-from-kelvin-to-celsius" title="Permalink to this headline">¶</a></h3>
<p>The metadata of the original data (before it was stripped during the subsequent processing steps) tells us that the near-surface air temperature data values are in units of Kelvin. We will convert them to degrees Celsius by subtracting 273.15 from the data values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span> <span class="o">-</span> <span class="mf">273.15</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-additional-data-dimensions-to-later-combine-data-from-multiple-models-experiments">
<h3>Create additional data dimensions (to later combine data from multiple models &amp; experiments)<a class="headerlink" href="#create-additional-data-dimensions-to-later-combine-data-from-multiple-models-experiments" title="Permalink to this headline">¶</a></h3>
<p>Finally, we will create additional dimensions for the model and for the experiment. These we will label with the model and experiment name as taken from the metadata of the original data (see above). These will be useful when we repeat the processes above for all models and experiments, and combine them into one array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>
<span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
<span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;experiment&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="load-and-prepare-cmip6-data-for-all-models-and-experiments">
<h2>Load and prepare CMIP6 data for all models and experiments<a class="headerlink" href="#load-and-prepare-cmip6-data-for-all-models-and-experiments" title="Permalink to this headline">¶</a></h2>
<p>To repeat the steps above for all models and all experiments, we will collect all of the commands we have used so far into a function, which we can then apply to a batch of files corresponding to the data from all models and experiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to aggregate in geographical lat lon dimensions</span>

<span class="k">def</span> <span class="nf">geog_agg</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}{</span><span class="n">fn</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;source_id&#39;</span><span class="p">]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
    <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
    <span class="n">da_weighted</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">da_agg</span> <span class="o">=</span> <span class="n">da_weighted</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_agg</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span> <span class="o">-</span> <span class="mf">273.15</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
    <span class="n">da_yr</span> <span class="o">=</span> <span class="n">da_yr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;experiment&#39;</span><span class="p">)</span>
    <span class="n">da_yr</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_agg_</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">da_yr</span><span class="o">.</span><span class="n">year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can apply this function to all the extracted NetCDF files. The <code class="docutils literal notranslate"><span class="pre">try</span></code> and <code class="docutils literal notranslate"><span class="pre">except</span></code> clauses ensure that all NetCDF files are attempted, even if some fail to be processed. One reason why some may fail is if the data are labelled differently, e.g. the model <em>MCM-UA-1-0</em> has coordinates labelled as “<em>latitude</em>” and <em>longitude</em>”. This differs from the suggested standard, and more commonly applied labels of “<em>lat</em>” and “<em>lon</em>”. Any that fail will be recorded in a print statement, and these can be processed separately. See <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/CMIP6%3A+Global+climate+projections#CMIP6:Globalclimateprojections-QualitycontroloftheCDS-CMIP6subset">here</a> more details on the quality control of the CMIP6 datasets on the CDS.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cmip6_nc</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">geog_agg</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> failed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the absence of any print statements, we see that all files were successfully processed.</p>
<p>We will now combine these processed files into one dataset for the final steps to create a visualisation of near-surface air temperature from the model ensemble.</p>
<p>If all files have the same coordinates, the function <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset</span></code> will merge the data according to the same coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">cmip6_agg*.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The dataset created by <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset</span></code> is by default in the form of “lazy Dask arrays”.</p>
<p>Dask divides arrays into many small pieces, called chunks, each of which is presumed to be small enough to fit into memory. As opposed to eager evaluation, operations on Dask arrays are lazy, i.e. operations queue up a series of tasks mapped over blocks, and no computation is performed until you request values to be computed. For more details, see <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/dask.html">https://xarray.pydata.org/en/stable/user-guide/dask.html</a>.</p>
<p>To facilitate further processing we would need to convert these Dask arrays into in-memory “eager” arrays, which we can do by using the <code class="docutils literal notranslate"><span class="pre">load()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ds</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (year: 251, model: 7, experiment: 4)
Coordinates:
  * year        (year) int64 1850 1851 1852 1853 1854 ... 2097 2098 2099 2100
    height      (model) float64 1.5 2.0 2.0 2.0 2.0 2.0 1.5
  * model       (model) object &#x27;HadGEM3-GC31-LL&#x27; &#x27;INM-CM4-8&#x27; ... &#x27;UKESM1-0-LL&#x27;
  * experiment  (experiment) object &#x27;historical&#x27; &#x27;ssp126&#x27; &#x27;ssp245&#x27; &#x27;ssp585&#x27;
Data variables:
    tas         (experiment, model, year) float64 13.75 13.62 ... 20.48 20.63</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7210d041-fb0d-460e-b406-93e78f944f6c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7210d041-fb0d-460e-b406-93e78f944f6c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 251</li><li><span class='xr-has-index'>model</span>: 7</li><li><span class='xr-has-index'>experiment</span>: 4</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fff99b50-a135-4107-a7df-4fc18dea6bf4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fff99b50-a135-4107-a7df-4fc18dea6bf4' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1850 1851 1852 ... 2098 2099 2100</div><input id='attrs-ee15cfa2-53c1-4c0c-8475-c90088d35cbe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ee15cfa2-53c1-4c0c-8475-c90088d35cbe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b3b0815-4c1b-4107-b154-412ef50263a8' class='xr-var-data-in' type='checkbox'><label for='data-1b3b0815-4c1b-4107-b154-412ef50263a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1850, 1851, 1852, ..., 2098, 2099, 2100], dtype=int64)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.5 2.0 2.0 2.0 2.0 2.0 1.5</div><input id='attrs-928aadec-2b79-435c-8607-4611800f13da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-928aadec-2b79-435c-8607-4611800f13da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d33ae3c6-7096-4700-82cb-3d53a6288e96' class='xr-var-data-in' type='checkbox'><label for='data-d33ae3c6-7096-4700-82cb-3d53a6288e96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.5, 2. , 2. , 2. , 2. , 2. , 1.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>model</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;HadGEM3-GC31-LL&#x27; ... &#x27;UKESM1-0-LL&#x27;</div><input id='attrs-16d77baf-03be-45ed-9bbc-ec71951a9a3f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-16d77baf-03be-45ed-9bbc-ec71951a9a3f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6448dee-636f-4f3e-a66b-1257690066b5' class='xr-var-data-in' type='checkbox'><label for='data-e6448dee-636f-4f3e-a66b-1257690066b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;HadGEM3-GC31-LL&#x27;, &#x27;INM-CM4-8&#x27;, &#x27;INM-CM5-0&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC-ES2L&#x27;, &#x27;MPI-ESM1-2-LR&#x27;, &#x27;UKESM1-0-LL&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>experiment</span></div><div class='xr-var-dims'>(experiment)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;historical&#x27; &#x27;ssp126&#x27; ... &#x27;ssp585&#x27;</div><input id='attrs-dd51790c-3656-4a48-8636-3c36d521fb1d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dd51790c-3656-4a48-8636-3c36d521fb1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6857c78-b83a-40d6-b42a-fae79b92fbef' class='xr-var-data-in' type='checkbox'><label for='data-d6857c78-b83a-40d6-b42a-fae79b92fbef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;historical&#x27;, &#x27;ssp126&#x27;, &#x27;ssp245&#x27;, &#x27;ssp585&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6fa65b73-5a2e-419f-a7ed-ed2e22bba1e5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6fa65b73-5a2e-419f-a7ed-ed2e22bba1e5' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(experiment, model, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>13.75 13.62 13.7 ... 20.48 20.63</div><input id='attrs-801b61d2-cefc-4b7a-8beb-f979f63f087e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-801b61d2-cefc-4b7a-8beb-f979f63f087e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1eb5b28-4e01-4e40-913a-e508e349b762' class='xr-var-data-in' type='checkbox'><label for='data-a1eb5b28-4e01-4e40-913a-e508e349b762' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[13.75399058, 13.61972281, 13.69983418, ...,         nan,
                 nan,         nan],
        [13.58175664, 13.36504047, 13.38635866, ...,         nan,
                 nan,         nan],
        [13.42228756, 13.19990532, 13.16567923, ...,         nan,
                 nan,         nan],
        ...,
        [15.15067915, 15.10892567, 15.03257159, ...,         nan,
                 nan,         nan],
        [13.65744156, 13.45913109, 13.46609431, ...,         nan,
                 nan,         nan],
        [13.54177956, 13.33535187, 13.43955638, ...,         nan,
                 nan,         nan]],

       [[        nan,         nan,         nan, ..., 16.29245683,
         16.36082827, 16.33036985],
        [        nan,         nan,         nan, ..., 14.76511278,
         14.71776501, 14.78597346],
        [        nan,         nan,         nan, ..., 14.57112824,
         14.57076709, 14.51991082],
...
        [        nan,         nan,         nan, ..., 17.47279885,
         17.79239638, 17.58084508],
        [        nan,         nan,         nan, ..., 16.0461109 ,
         16.01744213, 16.02138782],
        [        nan,         nan,         nan, ..., 17.62745672,
         17.5299521 , 17.59425743]],

       [[        nan,         nan,         nan, ..., 20.39295861,
         20.52182487, 20.57955248],
        [        nan,         nan,         nan, ..., 17.39707069,
         17.3183903 , 17.38916422],
        [        nan,         nan,         nan, ..., 17.16603799,
         17.24878839, 17.27704339],
        ...,
        [        nan,         nan,         nan, ..., 19.3107107 ,
         19.39395087, 19.69432393],
        [        nan,         nan,         nan, ..., 18.06633781,
         17.98003727, 17.73531158],
        [        nan,         nan,         nan, ..., 20.65340704,
         20.48425935, 20.63318635]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-82084eef-2c61-4462-b7a4-affd3165e974' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-82084eef-2c61-4462-b7a4-affd3165e974' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Finally, we create an Xarray DataArray object for the near-surface air temperature variable, ‘tas’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data_ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100">
<h2>Visualize the CMIP6 annual global average temperature between 1850 to 2100<a class="headerlink" href="#visualize-the-cmip6-annual-global-average-temperature-between-1850-to-2100" title="Permalink to this headline">¶</a></h2>
<p>We will now create a plot of the model ensemble of near-surface air temperature for the historical and future periods, according to the three selected scenarios.</p>
<div class="section" id="calculate-quantiles-for-model-ensemble">
<h3>Calculate quantiles for model ensemble<a class="headerlink" href="#calculate-quantiles-for-model-ensemble" title="Permalink to this headline">¶</a></h3>
<p>Rather than plotting the data from all models, we will instead view the range of values as given by quantiles, including the 10th (near to lower limit), the 50th (mid-range) and the 90th (near to upper limit) quantiles:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_90</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">data_10</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">data_50</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> The warning message is due to the presence of NaN (Not a Number) data given that the historical and scenario datasets represent only parts (historical and future respectively) of the entire time series. As these two datasets have been merged, NaN values will exist (e.g. there will be no data for the historical experiment for the future period).</p>
</div></blockquote>
</div>
<div class="section" id="view-time-series">
<h3>View time-series<a class="headerlink" href="#view-time-series" title="Permalink to this headline">¶</a></h3>
<p>Finally we will visualise this data in one time-series plot. We will use the matplotlib function <code class="docutils literal notranslate"><span class="pre">plot()</span></code>. The dimension <code class="docutils literal notranslate"><span class="pre">year</span></code> will be the x-axis and the near-surface air temperature values in degrees Celsius will be the y-axis.</p>
<p>The plotting function below has four main parts:</p>
<ul class="simple">
<li><p><strong>Initiate the plot</strong>: initiate a matplotlib plot with <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code></p></li>
<li><p><strong>Plot the time-series</strong>: plot the data for each experiment, including the historical experiment and three scenarios with the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function</p></li>
<li><p><strong>Set axes limits, labels, title and legend</strong>: Define title and axes labels, and add additional items to the plot, such as legend or gridlines</p></li>
<li><p><strong>Save the figure</strong>: Save the figure as a PNG file with the <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.savefig()</span></code> function</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">experiments</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_50</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">data_50</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">colours</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_50</span><span class="o">.</span><span class="n">experiment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s1"> 50th quantile&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data_50</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">data_90</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">data_10</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">colours</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_50</span><span class="o">.</span><span class="n">experiment</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s1"> 10th and 90th quantile range&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;CMIP6 annual global average temperature (1850 to 2100)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;tam (Celsius)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">CMIP6_annual_global_tas.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04_Climate_Projections_CMIP6_78_0.png" src="_images/04_Climate_Projections_CMIP6_78_0.png" />
</div>
</div>
<p>The visualization of the <code class="docutils literal notranslate"><span class="pre">CMIP6</span> <span class="pre">annual</span> <span class="pre">global</span> <span class="pre">average</span> <span class="pre">temperature</span> <span class="pre">(1850</span> <span class="pre">to</span> <span class="pre">2100)</span></code> above shows that the global average temperature was more or less stable in the pre-industrial phase, but steadily increases since the 1990s. It shows further that, depending on the SSP scenario, the course and increase of the global annual temperature differs. While for the best case <code class="docutils literal notranslate"><span class="pre">SSP1-2.6</span></code> scenario, the global annual temperature could stabilize around 15 degC, in the worst case <code class="docutils literal notranslate"><span class="pre">SSP5-8.5</span></code> scenario, the global annual temperature could increase to above 20 degC.</p>
<hr><p></p>
<span style='float:right'><p style=\"text-align:right;\">This project is licensed under <a href="./LICENSE">APACHE License 2.0</a>. | <a href=\"https://github.com/ecmwf-projects/copernicus-training">View on GitHub</a></span></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_Heatwave_Analysis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Analysis of September 2020 European Heatwave using ERA5 Climate Reanalysis Data from C3S</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="05_Climate_Projections_CORDEX.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analysis of Projected versus Historical Climatology with CORDEX Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>